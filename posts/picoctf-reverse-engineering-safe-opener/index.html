<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>picoCTF - Reverse Engineering - Safe Opener - Pascal&#39;s Blog</title><meta name="description" content="Welcome to my personal blog!"><meta property="og:title" content="picoCTF - Reverse Engineering - Safe Opener" />
<meta property="og:description" content="Reverse Engineering - Safe Opener - writeup description Can you open this safe?
I forgot the key to my safe but this programis supposed to help me with retrieving the lost key.
Can you help me unlock my safe?
Put the password you recover into the picoCTF flag format like: picoCTF{password}
writeup The &ldquo;safe&rdquo; is a .java file.
Since .java is used for java source code this should be fairly easy to reverse engineer." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.ppeinecke.de/posts/picoctf-reverse-engineering-safe-opener/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-06T15:27:09+02:00" />
<meta property="article:modified_time" content="2022-04-06T15:27:09+02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="picoCTF - Reverse Engineering - Safe Opener"/>
<meta name="twitter:description" content="Reverse Engineering - Safe Opener - writeup description Can you open this safe?
I forgot the key to my safe but this programis supposed to help me with retrieving the lost key.
Can you help me unlock my safe?
Put the password you recover into the picoCTF flag format like: picoCTF{password}
writeup The &ldquo;safe&rdquo; is a .java file.
Since .java is used for java source code this should be fairly easy to reverse engineer."/>
<meta name="application-name" content="Pascal&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Pascal&#39;s Blog"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.ppeinecke.de/posts/picoctf-reverse-engineering-safe-opener/" /><link rel="prev" href="https://blog.ppeinecke.de/posts/picoctf-reverse-engineering-patchme.py/" /><link rel="next" href="https://blog.ppeinecke.de/posts/picoctf-reverse-engineering-unpackme.py/" /><link rel="stylesheet" href="/css/page.min.css"><link rel="stylesheet" href="/css/home.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "picoCTF - Reverse Engineering - Safe Opener",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.ppeinecke.de\/posts\/picoctf-reverse-engineering-safe-opener\/"
        },"genre": "posts","keywords": "reverse engineering, picoctf\u0022","wordcount":  179 ,
        "url": "https:\/\/blog.ppeinecke.de\/posts\/picoctf-reverse-engineering-safe-opener\/","datePublished": "2022-04-06T15:27:09+02:00","dateModified": "2022-04-06T15:27:09+02:00","publisher": {
            "@type": "Organization",
            "name": "Author"},"author": {
                "@type": "Person",
                "name": "Author"
            },"description": ""
    }
    </script></head><body data-header-desktop="" data-header-mobile=""><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Pascal&#39;s Blog">Pascal&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="/contact"> Contact Me </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Pascal&#39;s Blog">Pascal&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="/contact" title="">Contact Me</a><div class="menu-item"><a href="javascript:void(0);" class="theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="disable"><div class="single-card" ><h2 class="single-title animated flipInX">picoCTF - Reverse Engineering - Safe Opener</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Author</a></span>&nbsp;<span class="post-category">published in <a href="/categories/reverse-engineering/"><i class="far fa-folder fa-fw"></i>reverse engineering</a></span></div>
                <div class="post-meta-line"><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-04-06">2022-04-06</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;179 words</span>&nbsp;
                    <span><i class="far fa-clock fa-fw"></i>&nbsp;One minute</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>Contents</span>
                        <span><i class="details-icon fas fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#description">description</a></li>
    <li><a href="#writeup">writeup</a></li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><h1 id="reverse-engineering---safe-opener---writeup">Reverse Engineering - Safe Opener - writeup</h1>
<h2 id="description">description</h2>
<p>Can you open this safe?</p>
<p>I forgot the key to my safe but this <!-- raw HTML omitted -->program<!-- raw HTML omitted --> is supposed to help me with retrieving the lost key.</p>
<p>Can you help me unlock my safe?</p>
<p>Put the password you recover into the picoCTF flag format like: picoCTF{password}</p>
<h2 id="writeup">writeup</h2>
<p>The &ldquo;safe&rdquo; is a .java file.</p>
<p>Since .java is used for java source code this should be
fairly easy to reverse engineer.</p>
<p>In the main method of the class &lsquo;SafeOpener&rsquo;,
directly at the top I see this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Base64</span><span class="o">.</span><span class="na">Encoder</span> <span class="n">encoder</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">String</span> <span class="n">encodedkey</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="o">;</span>
</span></span></code></pre></div><p>So the key is simply encoded in base64.</p>
<p>Inside the method &lsquo;boolean openSafe(String password)&rsquo;
I found this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">String</span> <span class="n">encodedkey</span> <span class="o">=</span> <span class="s">&#34;cGwzYXMzX2wzdF9tM18xbnQwX3RoM19zYWYz&#34;</span><span class="o">;</span>
</span></span></code></pre></div><p>So that is the encoded key.</p>
<p>All I have to do here is to decode the aforementioned key using base64 decoding.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> -n <span class="s2">&#34;cGwzYXMzX2wzdF9tM18xbnQwX3RoM19zYWYz&#34;</span> <span class="p">|</span> base64 -d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pl3as3_l3t_m3_1nt0_th3_saf3
</span></span></code></pre></div><p>That should be the correct password.</p>
<p>Let&rsquo;s compile and run that java code&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">javac SafeOpener.java
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">java SafeOpener
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Enter password <span class="k">for</span> the safe: pl3as3_l3t_m3_1nt0_th3_saf3
</span></span><span class="line"><span class="cl">cGwzYXMzX2wzdF9tM18xbnQwX3RoM19zYWYz
</span></span><span class="line"><span class="cl">Sesame open
</span></span></code></pre></div><p>And here we have our flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{pl3as3_l3t_m3_1nt0_th3_saf3}
</span></span></code></pre></div></div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="/tags/reverse-engineering/">reverse engineering</a>
                </span><span><a href="/tags/picoctf/">picoctf</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>Updated on 2022-04-06</span>
            </div><div class="post-info-mod"></div>
        </div></div><div class="post-nav"><a href="/posts/picoctf-reverse-engineering-patchme.py/" class="prev" rel="prev" title="picoCTF - Reverse Engineering - patchme.py"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a>
            <a href="/posts/picoctf-reverse-engineering-unpackme.py/" class="next" rel="next" title="picoCTF - Reverse Engineering - unpackme.py">Next Post<i class="fas fa-angle-right fa-fw"></i></a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.95.0">Hugo</a> | Theme - <a href="https://github.com/khusika/FeelIt" target="_blank" rel="noopener noreffer" title="FeelIt 1.0.1"><i class="fas fa-hand-holding-heart fa-fw"></i> FeelIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/"></a></span></div>
</div>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{}};</script><script src="/js/theme.min.js"></script></body></html>
