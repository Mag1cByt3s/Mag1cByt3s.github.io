<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>picoCTF - Cryptography - credstuff - Pascal&#39;s Blog</title><meta name="description" content="Welcome to my personal blog!"><meta property="og:title" content="picoCTF - Cryptography - credstuff" />
<meta property="og:description" content="Cryptography - credstuff - writeup description We found a leak of a blackmarket website&rsquo;s login credentials. Can you find the password of the user cultiris and successfully decrypt it? Download the leak here. The first user in usernames.txt corresponds to the first password in passwords.txt. The second user corresponds to the second password, and so on.
writeup let&rsquo;s write a python program that finds the corresponding password for the user &lsquo;cultiris&rsquo;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.ppeinecke.de/posts/picoctf-cryptography-credstuff/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-06T14:02:03+02:00" />
<meta property="article:modified_time" content="2022-04-06T14:02:03+02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="picoCTF - Cryptography - credstuff"/>
<meta name="twitter:description" content="Cryptography - credstuff - writeup description We found a leak of a blackmarket website&rsquo;s login credentials. Can you find the password of the user cultiris and successfully decrypt it? Download the leak here. The first user in usernames.txt corresponds to the first password in passwords.txt. The second user corresponds to the second password, and so on.
writeup let&rsquo;s write a python program that finds the corresponding password for the user &lsquo;cultiris&rsquo;"/>
<meta name="application-name" content="Pascal&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Pascal&#39;s Blog"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.ppeinecke.de/posts/picoctf-cryptography-credstuff/" /><link rel="prev" href="https://blog.ppeinecke.de/posts/picoctf-cryptography-basic-mod1/" /><link rel="next" href="https://blog.ppeinecke.de/posts/picoctf-cryptography-morse-code/" /><link rel="stylesheet" href="/css/page.min.css"><link rel="stylesheet" href="/css/home.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "picoCTF - Cryptography - credstuff",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.ppeinecke.de\/posts\/picoctf-cryptography-credstuff\/"
        },"genre": "posts","keywords": "crypto, cryptography, picoctf","wordcount":  434 ,
        "url": "https:\/\/blog.ppeinecke.de\/posts\/picoctf-cryptography-credstuff\/","datePublished": "2022-04-06T14:02:03+02:00","dateModified": "2022-04-06T14:02:03+02:00","publisher": {
            "@type": "Organization",
            "name": "Author"},"author": {
                "@type": "Person",
                "name": "Author"
            },"description": ""
    }
    </script></head><body data-header-desktop="" data-header-mobile=""><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Pascal&#39;s Blog">Pascal&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="/contact"> Contact Me </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Pascal&#39;s Blog">Pascal&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="/contact" title="">Contact Me</a><div class="menu-item"><a href="javascript:void(0);" class="theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="disable"><div class="single-card" ><h2 class="single-title animated flipInX">picoCTF - Cryptography - credstuff</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Author</a></span>&nbsp;<span class="post-category">published in <a href="/categories/cryptography/"><i class="far fa-folder fa-fw"></i>cryptography</a></span></div>
                <div class="post-meta-line"><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-04-06">2022-04-06</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;434 words</span>&nbsp;
                    <span><i class="far fa-clock fa-fw"></i>&nbsp;3 minutes</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>Contents</span>
                        <span><i class="details-icon fas fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#description">description</a></li>
    <li><a href="#writeup">writeup</a></li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><h1 id="cryptography---credstuff---writeup">Cryptography - credstuff - writeup</h1>
<h2 id="description">description</h2>
<p>We found a leak of a blackmarket website&rsquo;s login credentials.
Can you find the password of the user cultiris and successfully decrypt it?
Download the leak here. The first user in usernames.txt corresponds to the first password in passwords.txt. The second user corresponds to the second password, and so on.</p>
<h2 id="writeup">writeup</h2>
<p>let&rsquo;s write a python program that finds the corresponding password
for the user &lsquo;cultiris&rsquo;</p>
<p>According to the task description the n-th user corresponds to the n-th
password.</p>
<p>So my task here is to find the position of the user &lsquo;cultiris&rsquo;
in the file &lsquo;usernames.txt&rsquo; and find the password with the same
position in the file &lsquo;passwords.txt&rsquo;</p>
<p>Here is the program I came up with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">username</span><span class="o">=</span><span class="s2">&#34;cultiris&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">username_file</span><span class="o">=</span><span class="s2">&#34;leak/usernames.txt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">password_file</span><span class="o">=</span><span class="s2">&#34;leak/passwords.txt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># find position of cultiris in file leak/usernames.txt</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">search_string_in_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">string_to_search</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Search for the given string in file and return lines containing that string,
</span></span></span><span class="line"><span class="cl"><span class="s2">    along with line numbers&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">line_number</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">list_of_results</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Open the file in read only mode</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">read_obj</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Read all lines in the file one by one</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">read_obj</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># For each line, check if line contains the string</span>
</span></span><span class="line"><span class="cl">            <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">string_to_search</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># If yes, then add the line number &amp; line as a tuple in the list</span>
</span></span><span class="line"><span class="cl">                <span class="n">list_of_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">line_number</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Return list of tuples containing line numbers and lines where string is found</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">list_of_results</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">search_string_in_file</span><span class="p">(</span><span class="n">username_file</span><span class="p">,</span> <span class="n">username</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># running this code so far we found the username &#39;cultiris&#39; on line 378</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># lets extract line 378 of the file leak/passwords.txt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>                             		 <span class="c1"># Declare an empty list named lines.</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s1">&#39;leak/passwords.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">psswd_file</span><span class="p">:</span> <span class="c1"># Open leak/passwords.txt for reading text data.</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">psswd_file</span><span class="p">:</span>                	 <span class="c1"># For each line, stored as line,</span>
</span></span><span class="line"><span class="cl">        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>           		 <span class="c1"># add its contents to lines.</span>
</span></span><span class="line"><span class="cl">                          		
</span></span><span class="line"><span class="cl"><span class="c1"># now just print out line 378 to find the correct password</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for the user cultiris</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the index is 377 because arrays start at 0</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">377</span><span class="p">])</span>
</span></span></code></pre></div><p>Using my python program I found the username &lsquo;cultiris&rsquo;
on line 378:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[(378, &#39;cultiris&#39;)]
</span></span></code></pre></div><p>So all I have to do now is to extract line 378
of the file &lsquo;passwords.txt&rsquo;.</p>
<p>I got this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cvpbPGS{P7e1S_54I35_71Z3}
</span></span></code></pre></div><p>This seems to be encrypted</p>
<p>We need a hint on how to solve this&hellip;</p>
<p>Let&rsquo;s take a look at the passwords.txt file:</p>
<p>If I search the file for the term &lsquo;pico&rsquo;, I found this line:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pICo7rYpiCoU51N6PicOr0t13
</span></span></code></pre></div><p>I think that could be a hint to use ROT13 to decrypt the flag!</p>
<p>So let&rsquo;s try to rotate each character by 13 position using ROT13:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{C7r1F_54V35_71M3}
</span></span></code></pre></div><p>That is our flag!</p>
<p>Awesome!</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="/tags/crypto/">crypto</a>
                </span><span><a href="/tags/cryptography/">cryptography</a>
                </span><span><a href="/tags/picoctf/">picoctf</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>Updated on 2022-04-06</span>
            </div><div class="post-info-mod"></div>
        </div></div><div class="post-nav"><a href="/posts/picoctf-cryptography-basic-mod1/" class="prev" rel="prev" title="picoCTF - Cryptography - basic-mod1"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a>
            <a href="/posts/picoctf-cryptography-morse-code/" class="next" rel="next" title="picoCTF - Cryptography - Morse Code">Next Post<i class="fas fa-angle-right fa-fw"></i></a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.95.0">Hugo</a> | Theme - <a href="https://github.com/khusika/FeelIt" target="_blank" rel="noopener noreffer" title="FeelIt 1.0.1"><i class="fas fa-hand-holding-heart fa-fw"></i> FeelIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/"></a></span></div>
</div>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{}};</script><script src="/js/theme.min.js"></script></body></html>
