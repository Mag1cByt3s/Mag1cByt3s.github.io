<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>forensics - Tag - Pascal's Blog</title><link>https://blog.ppeinecke.de/tags/forensics/</link><description>forensics - Tag - Pascal's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Wed, 06 Apr 2022 15:12:22 +0200</lastBuildDate><atom:link href="https://blog.ppeinecke.de/tags/forensics/" rel="self" type="application/rss+xml"/><item><title>picoCTF - Reverse Engineering - Bbbbloat</title><link>https://blog.ppeinecke.de/posts/picoctf-reverse-engineering-bbbbloat/</link><pubDate>Wed, 06 Apr 2022 15:12:22 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-reverse-engineering-bbbbloat/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---bbbbloat---writeup">Forensics - Bbbbloat - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag?</p>
<p>Reverse engineer this <!-- raw HTML omitted -->binary<!-- raw HTML omitted -->.</p>
<h2 id="writeup">writeup</h2>
<p>After loading the binary into Ghidra and browsing the decompiled
code I noticed this function:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">undefined8</span> <span class="nf">FUN_00101307</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="o">*</span><span class="n">__s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">local_48</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">undefined8</span> <span class="n">local_38</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">undefined8</span> <span class="n">local_30</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">undefined8</span> <span class="n">local_28</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">undefined8</span> <span class="n">local_20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">local_10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">local_10</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">local_38</span> <span class="o">=</span> <span class="mh">0x4c75257240343a41</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">local_30</span> <span class="o">=</span> <span class="mh">0x3062396630664634</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">local_28</span> <span class="o">=</span> <span class="mh">0x33343066635f3d33</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">local_20</span> <span class="o">=</span> <span class="mh">0x4e5f3463665f34</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;What</span><span class="se">\&#39;</span><span class="s">s my favorite number? &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">__isoc99_scanf</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">local_48</span> <span class="o">==</span> <span class="mh">0x86187</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">__s</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">FUN_00101249</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_38</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fputs</span><span class="p">(</span><span class="n">__s</span><span class="p">,</span><span class="n">stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">putchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">free</span><span class="p">(</span><span class="n">__s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Sorry, that</span><span class="se">\&#39;</span><span class="s">s not it!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">local_10</span> <span class="o">!=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="cm">/* WARNING: Subroutine does not return */</span>
</span></span><span class="line"><span class="cl">    <span class="n">__stack_chk_fail</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The interesting lines here are those:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">local_48</span> <span class="o">==</span> <span class="mh">0x86187</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">__s</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">FUN_00101249</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_38</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fputs</span><span class="p">(</span><span class="n">__s</span><span class="p">,</span><span class="n">stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">putchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">free</span><span class="p">(</span><span class="n">__s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Sorry, that</span><span class="se">\&#39;</span><span class="s">s not it!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here the program compares the user input with a string.</p>
<p>&rsquo;local_48&rsquo; is the user input.</p>
<p>&lsquo;0x86187&rsquo; is a hex string / number.</p>
<p>If we convert 86187 from hex to decimal we get 549255.</p>
<p>If I now try to supply 549255 as the input I get the following:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">What<span class="err">&#39;</span>s my favorite number? <span class="m">549255</span>
</span></span><span class="line"><span class="cl">picoCTF<span class="o">{</span>cu7_7h3_bl047_cbc074c0<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>That was the correct number.</p>
<p>The flag is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{cu7_7h3_bl047_cbc074c0}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Forensics - St3g0</title><link>https://blog.ppeinecke.de/posts/picoctf-forensics-st3g0/</link><pubDate>Wed, 06 Apr 2022 15:08:21 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-forensics-st3g0/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---st3g0---writeup">Forensics - St3g0 - writeup</h1>
<h2 id="description">description</h2>
<p>Download this featuredImage and find the flag.</p>
<p><!-- raw HTML omitted -->Download featuredImage<!-- raw HTML omitted --></p>
<h2 id="writeup">writeup</h2>
<p>Ok so let&rsquo;s download the file first &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget https://artifacts.picoctf.net/c/427/pico.flag.png
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s check the file type just to make sure we actually
have a .png file here &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file pico.flag.png
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pico.flag.png: PNG featuredImage data, <span class="m">585</span> x 172, 8-bit/color RGBA, non-interlaced
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ok so it is in fact a PNG file.</p>
<p>Let&rsquo;s check for any steganography using stegdetect</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">stegdetect ./pico.flag.png 
</span></span><span class="line"><span class="cl">./pico.flag.png : error: Not a JPEG file: starts with 0x89 0x50
</span></span></code></pre></td></tr></table>
</div>
</div><p>we get an error from stegdetect since steganography usually is only possible
using JPEG files.</p>
<p>If I take a look at the hex bytes I can see the .PNG magic bytes of</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hexdump -C -n <span class="m">8</span> ./pico.flag.png
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">00000000</span>  <span class="m">89</span> <span class="m">50</span> 4e <span class="m">47</span> 0d 0a 1a 0a    <span class="p">|</span>.PNG....<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="m">00000008</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So it is really a png file.</p>
<p>Looking at the hex dump I cannot seem to find anything
remotely interesting &hellip;</p>
<p>Using the strings command I also did not find anything &hellip;</p>
<p>Using stegsolve also did not lead to anything &hellip;</p>
<p>After checking with zsteg for any hidden strings I found the flag!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zsteg -a -v pico.flag.png <span class="p">|</span> grep picoCTF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">b1,rgb,lsb,xy       .. text: <span class="s2">&#34;picoCTF{7h3r3_15_n0_5p00n_4706df81}</span><span class="nv">$t3g0</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    00000000: <span class="m">70</span> <span class="m">69</span> <span class="m">63</span> 6f <span class="m">43</span> <span class="m">54</span> <span class="m">46</span> 7b  <span class="m">37</span> <span class="m">68</span> <span class="m">33</span> <span class="m">72</span> <span class="m">33</span> 5f <span class="m">31</span> <span class="m">35</span>  <span class="p">|</span>picoCTF<span class="o">{</span>7h3r3_15<span class="p">|</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So this is the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{7h3r3_15_n0_5p00n_4706df81}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Forensics - Sleuthkit Apprentice</title><link>https://blog.ppeinecke.de/posts/picoctf-forensics-sleuthkit-apprentice/</link><pubDate>Wed, 06 Apr 2022 15:05:06 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-forensics-sleuthkit-apprentice/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---sleuthkit-apprentice---writeup">Forensics - Sleuthkit Apprentice - writeup</h1>
<h2 id="description">description</h2>
<p>Download this disk featuredImage and find the flag.
Note: if you are using the webshell, download and
extract the disk featuredImage into /tmp not your home directory.</p>
<p><!-- raw HTML omitted -->Download compressed disk featuredImage<!-- raw HTML omitted --></p>
<h2 id="writeup">writeup</h2>
<p>So we a got a file &lsquo;disk.flag.img&rsquo;.</p>
<p>I will try to create a folder and mount the disk
featuredImage into that folder first.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir mnt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mount ./disk.flag.img mnt 
</span></span><span class="line"><span class="cl">mount: mnt: failed to setup loop device <span class="k">for</span> /home/pascal/Pentesting/picoCTF_2022/Forensics/Sleuthkit Apprentice/disk.flag.img.
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ok so that did not work.</p>
<p>If I check using the file command what that file actually is
I see that it is a &lsquo;DOS/MBR boot sector&rsquo;
So it is using a dos (MBR) partition table</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file disk.flag.img  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">disk.flag.img: DOS/MBR boot sector<span class="p">;</span> partition <span class="m">1</span> : <span class="nv">ID</span><span class="o">=</span>0x83, active, start-CHS <span class="o">(</span>0x0,32,33<span class="o">)</span>, end-CHS <span class="o">(</span>0xc,223,19<span class="o">)</span>, startsector 2048, <span class="m">204800</span> sectors<span class="p">;</span> partition <span class="m">2</span> : <span class="nv">ID</span><span class="o">=</span>0x82, start-CHS <span class="o">(</span>0xc,223,20<span class="o">)</span>, end-CHS <span class="o">(</span>0x16,111,25<span class="o">)</span>, startsector 206848, <span class="m">153600</span> sectors<span class="p">;</span> partition <span class="m">3</span> : <span class="nv">ID</span><span class="o">=</span>0x83, start-CHS <span class="o">(</span>0x16,111,26<span class="o">)</span>, end-CHS <span class="o">(</span>0x26,62,24<span class="o">)</span>, startsector 360448, <span class="m">253952</span> sectors
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s check with fdisk what partitions are there.
We already saw 3 partitions inside that partition table.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fdisk -l disk.flag.img      
</span></span><span class="line"><span class="cl">                                                                     
</span></span><span class="line"><span class="cl">Disk disk.flag.img: <span class="m">300</span> MiB, <span class="m">314572800</span> bytes, <span class="m">614400</span> sectors
</span></span><span class="line"><span class="cl">Units: sectors of <span class="m">1</span> * <span class="nv">512</span> <span class="o">=</span> <span class="m">512</span> bytes
</span></span><span class="line"><span class="cl">Sector size <span class="o">(</span>logical/physical<span class="o">)</span>: <span class="m">512</span> bytes / <span class="m">512</span> bytes
</span></span><span class="line"><span class="cl">I/O size <span class="o">(</span>minimum/optimal<span class="o">)</span>: <span class="m">512</span> bytes / <span class="m">512</span> bytes
</span></span><span class="line"><span class="cl">Disklabel type: dos
</span></span><span class="line"><span class="cl">Disk identifier: 0x7389e82d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Device         Boot  Start    End Sectors  Size Id Type
</span></span><span class="line"><span class="cl">disk.flag.img1 *      <span class="m">2048</span> <span class="m">206847</span>  <span class="m">204800</span>  100M <span class="m">83</span> Linux
</span></span><span class="line"><span class="cl">disk.flag.img2      <span class="m">206848</span> <span class="m">360447</span>  <span class="m">153600</span>   75M <span class="m">82</span> Linux swap / Solaris
</span></span><span class="line"><span class="cl">disk.flag.img3      <span class="m">360448</span> <span class="m">614399</span>  <span class="m">253952</span>  124M <span class="m">83</span> Linux
</span></span></code></pre></td></tr></table>
</div>
</div><p>The first partition &lsquo;disk.flag.img1&rsquo; is a boot partition.
We can see that because of the fact that the boot flag is
activated. Also the start of 2048 and the size of 100 Megabytes
indicates that this might be a boot partition.</p>
<p>The second partition &lsquo;disk.flag.img2&rsquo; is a swap partition.
That is indicated by the partition type &lsquo;Linux swap / Solaris&rsquo;.</p>
<p>The third partition &lsquo;disk.flag.img3&rsquo; is most probably
a root partition. With a size of 124 Megabytes this is the biggest
partition and the type is &lsquo;Linux&rsquo;. So it is probbaly EXT4.</p>
<p>After running parted I tried to find the start sector of the third partition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">parted disk.flag.img
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">WARNING: You are not superuser.  Watch out <span class="k">for</span> permissions.
</span></span><span class="line"><span class="cl">GNU Parted 3.4
</span></span><span class="line"><span class="cl">Using /home/pascal/Pentesting/picoCTF_2022/Forensics/Sleuthkit Apprentice/disk.flag.img
</span></span><span class="line"><span class="cl">Welcome to GNU Parted! Type <span class="s1">&#39;help&#39;</span> to view a list of commands.
</span></span><span class="line"><span class="cl"><span class="o">(</span>parted<span class="o">)</span> u                                                                
</span></span><span class="line"><span class="cl">Unit?  <span class="o">[</span>compact<span class="o">]</span>? B                                                       
</span></span><span class="line"><span class="cl"><span class="o">(</span>parted<span class="o">)</span> print                                                            
</span></span><span class="line"><span class="cl">Model:  <span class="o">(</span>file<span class="o">)</span>
</span></span><span class="line"><span class="cl">Disk /home/pascal/Pentesting/picoCTF_2022/Forensics/Sleuthkit Apprentice/disk.flag.img: 314572800B
</span></span><span class="line"><span class="cl">Sector size <span class="o">(</span>logical/physical<span class="o">)</span>: 512B/512B
</span></span><span class="line"><span class="cl">Partition Table: msdos
</span></span><span class="line"><span class="cl">Disk Flags: 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Number  Start       End         Size        Type     File system     Flags
</span></span><span class="line"><span class="cl"> <span class="m">1</span>      1048576B    105906175B  104857600B  primary  ext4            boot
</span></span><span class="line"><span class="cl"> <span class="m">2</span>      105906176B  184549375B  78643200B   primary  linux-swap<span class="o">(</span>v1<span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="m">3</span>      184549376B  314572799B  130023424B  primary  ext4
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then I tried to mount the third partition using an offset of 184549376</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mount -t ext4 -o loop,offset<span class="o">=</span><span class="m">184549376</span> disk.flag.img ./mnt
</span></span></code></pre></td></tr></table>
</div>
</div><p>But that fails</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mount: ./mnt: failed to setup loop device <span class="k">for</span> /home/pascal/Pentesting/picoCTF_2022/Forensics/Sleuthkit Apprentice/disk.flag.img
</span></span></code></pre></td></tr></table>
</div>
</div><p>I ended up with a simple bash script to mount the loop device:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nv">img</span><span class="o">=</span><span class="s2">&#34;disk.flag.img&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">dev</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span>sudo losetup --show -f -P <span class="s2">&#34;</span><span class="nv">$img</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$dev</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> part in <span class="s2">&#34;</span><span class="nv">$dev</span><span class="s2">&#34;</span>?*<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$part</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dev</span><span class="si">}</span><span class="s2">p*&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nv">part</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">dev</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">  <span class="nv">dst</span><span class="o">=</span><span class="s2">&#34;mnt/</span><span class="k">$(</span>basename <span class="s2">&#34;</span><span class="nv">$part</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$dst</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  mkdir -p <span class="s2">&#34;</span><span class="nv">$dst</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  sudo mount -o loop <span class="s2">&#34;</span><span class="nv">$part</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$dst</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Running that script I was able to mount the filesystems into my local &lsquo;mnt&rsquo;
folder.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">loop11p1  loop11p2  loop11p3
</span></span></code></pre></td></tr></table>
</div>
</div><p>loop11p3 is the root partition.</p>
<p>Let&rsquo;s see what we can find here&hellip;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> loop11p3
</span></span></code></pre></td></tr></table>
</div>
</div><p>Maybe there is something in the home directory of the root user &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls root
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">my_folder
</span></span></code></pre></td></tr></table>
</div>
</div><p>That folder seems interesting &hellip;.</p>
<p>Let&rsquo;s see what is in there&hellip;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls root/my_folder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag.uni.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>Could that be our flag?</p>
<p>Let&rsquo;s cat it out!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat root/my_folder/flag.uni.txt
</span></span><span class="line"><span class="cl">picoCTF<span class="o">{</span>by73_5urf3r_25b0d0c0<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Gotcha!</p>
<p>So the flag is</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{by73_5urf3r_25b0d0c0}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Forensics - Packets Primer</title><link>https://blog.ppeinecke.de/posts/picoctf-forensics-packets-primer/</link><pubDate>Wed, 06 Apr 2022 14:51:19 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-forensics-packets-primer/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---packets-primer---writeup">Forensics - Packets Primer - writeup</h1>
<h2 id="description">description</h2>
<p>Download the packet capture file and use packet analysis software to find the flag.</p>
<p><!-- raw HTML omitted -->Download packet capture<!-- raw HTML omitted --></p>
<h2 id="writeup">writeup</h2>
<p>Ok so we got a .pcap file as a download:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">network-dump.flag.pcap
</span></span></code></pre></td></tr></table>
</div>
</div><p>Lets look at the content using wireshark.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wireshark -r network-dump.flag.pcap
</span></span></code></pre></td></tr></table>
</div>
</div><p>I found some interesting traffic:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">4       0.001225        10.0.2.15       10.0.2.4        TCP     126     48750 → 9000 [PSH, ACK] Seq=1 Ack=1 Win=64256 Len=60 TSval=2379213157 TSecr=1760620995
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looking at the hex dump of that transaction I can see the following:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0000   08 00 27 93 ce 73 08 00 27 af 39 9f 08 00 45 00
</span></span><span class="line"><span class="cl">0010   00 70 50 c2 40 00 40 06 d1 b3 0a 00 02 0f 0a 00
</span></span><span class="line"><span class="cl">0020   02 04 be 6e 23 28 27 ec d4 b7 bd 26 99 bc 80 18
</span></span><span class="line"><span class="cl">0030   01 f6 18 75 00 00 01 01 08 0a 8d cf e9 65 68 f0
</span></span><span class="line"><span class="cl">0040   f1 c3 70 20 69 20 63 20 6f 20 43 20 54 20 46 20
</span></span><span class="line"><span class="cl">0050   7b 20 70 20 34 20 63 20 6b 20 33 20 37 20 5f 20
</span></span><span class="line"><span class="cl">0060   35 20 68 20 34 20 72 20 6b 20 5f 20 32 20 65 20
</span></span><span class="line"><span class="cl">0070   64 20 64 20 37 20 65 20 35 20 38 20 7d 0a
</span></span></code></pre></td></tr></table>
</div>
</div><p>That translates to the following:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;Îs&#39;¯9EpPÂ@@Ñ³
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">¾n#(&#39;ìÔ·½&amp;¼öu
</span></span><span class="line"><span class="cl">ÏéehðñÃp i c o C T F { p 4 c k 3 7 _ 5 h 4 r k _ 2 e d d 7 e 5 8 }
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is our flag!</p>
<p>flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">p i c o C T F { p 4 c k 3 7 _ 5 h 4 r k _ 2 e d d 7 e 5 8 }
</span></span></code></pre></td></tr></table>
</div>
</div><p>Lets put that string into cyberchef using the operation &lsquo;Remove whitespace&rsquo;</p>
<p>the result is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{p4ck37_5h4rk_2edd7e58}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Forensics - Redaction gone wrong</title><link>https://blog.ppeinecke.de/posts/picoctf-forensics-redaction-gone-wrong/</link><pubDate>Wed, 06 Apr 2022 14:51:19 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-forensics-redaction-gone-wrong/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---redaction-gone-wrong---writeup">Forensics - Redaction gone wrong - writeup</h1>
<h2 id="description">description</h2>
<p>Now you DON’T see me.
This report has some critical data in it, some of which
have been redacted correctly, while some were not.
Can you find an important key that was not redacted properly?</p>
<h2 id="writeup">writeup</h2>
<p>By simply opening the pdf file in LibreOffice Draw
I was able to move the black boxes to uncover the flag!</p>
<p>The flag is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{C4n_Y0u_S33_m3_fully} 
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Forensics - Operation Orchid</title><link>https://blog.ppeinecke.de/posts/picoctf-forensics-operation-orchid/</link><pubDate>Wed, 06 Apr 2022 14:49:28 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-forensics-operation-orchid/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---operation-orchid---writeup">Forensics - Operation Orchid - writeup</h1>
<h2 id="description">description</h2>
<p>Download this disk featuredImage and find the flag.</p>
<p>Note: if you are using the webshell, download and
extract the disk featuredImage into /tmp not your home directory.</p>
<p><!-- raw HTML omitted --><a href="https://artifacts.picoctf.net/c/242/disk.flag.img.gz" target="_blank" rel="noopener noreffer">https://artifacts.picoctf.net/c/242/disk.flag.img.gz</a><!-- raw HTML omitted --></p>
<h2 id="writeup">writeup</h2>
<p>Ok let&rsquo;s download the featuredImage first!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget https://artifacts.picoctf.net/c/242/disk.flag.img.gz
</span></span></code></pre></td></tr></table>
</div>
</div><p>Next I will extract it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gunzip disk.flag.img.gz
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file disk.flag.img    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">disk.flag.img: DOS/MBR boot sector<span class="p">;</span> partition <span class="m">1</span> : <span class="nv">ID</span><span class="o">=</span>0x83, active, start-CHS <span class="o">(</span>0x0,32,33<span class="o">)</span>, end-CHS <span class="o">(</span>0xc,223,19<span class="o">)</span>, startsector 2048, <span class="m">204800</span> sectors<span class="p">;</span> partition <span class="m">2</span> : <span class="nv">ID</span><span class="o">=</span>0x82, start-CHS <span class="o">(</span>0xc,223,20<span class="o">)</span>, end-CHS <span class="o">(</span>0x19,159,6<span class="o">)</span>, startsector 206848, <span class="m">204800</span> sectors<span class="p">;</span> partition <span class="m">3</span> : <span class="nv">ID</span><span class="o">=</span>0x83, start-CHS <span class="o">(</span>0x19,159,7<span class="o">)</span>, end-CHS <span class="o">(</span>0x32,253,11<span class="o">)</span>, startsector 411648, <span class="m">407552</span> sectors
</span></span></code></pre></td></tr></table>
</div>
</div><p>That is a dos / mbr boot partition</p>
<p>Let&rsquo;s look at the partitions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fdisk -l disk.flag.img
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Disk disk.flag.img: <span class="m">400</span> MiB, <span class="m">419430400</span> bytes, <span class="m">819200</span> sectors
</span></span><span class="line"><span class="cl">Units: sectors of <span class="m">1</span> * <span class="nv">512</span> <span class="o">=</span> <span class="m">512</span> bytes
</span></span><span class="line"><span class="cl">Sector size <span class="o">(</span>logical/physical<span class="o">)</span>: <span class="m">512</span> bytes / <span class="m">512</span> bytes
</span></span><span class="line"><span class="cl">I/O size <span class="o">(</span>minimum/optimal<span class="o">)</span>: <span class="m">512</span> bytes / <span class="m">512</span> bytes
</span></span><span class="line"><span class="cl">Disklabel type: dos
</span></span><span class="line"><span class="cl">Disk identifier: 0xb11a86e3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Device         Boot  Start    End Sectors  Size Id Type
</span></span><span class="line"><span class="cl">disk.flag.img1 *      <span class="m">2048</span> <span class="m">206847</span>  <span class="m">204800</span>  100M <span class="m">83</span> Linux
</span></span><span class="line"><span class="cl">disk.flag.img2      <span class="m">206848</span> <span class="m">411647</span>  <span class="m">204800</span>  100M <span class="m">82</span> Linux swap / Solaris
</span></span><span class="line"><span class="cl">disk.flag.img3      <span class="m">411648</span> <span class="m">819199</span>  <span class="m">407552</span>  199M <span class="m">83</span> Linux
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s try to mount the partitions using my bash script again:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nv">img</span><span class="o">=</span><span class="s2">&#34;disk.flag.img&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">dev</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span>sudo losetup --show -f -P <span class="s2">&#34;</span><span class="nv">$img</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$dev</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> part in <span class="s2">&#34;</span><span class="nv">$dev</span><span class="s2">&#34;</span>?*<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$part</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dev</span><span class="si">}</span><span class="s2">p*&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nv">part</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">dev</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">  <span class="nv">dst</span><span class="o">=</span><span class="s2">&#34;mnt/</span><span class="k">$(</span>basename <span class="s2">&#34;</span><span class="nv">$part</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$dst</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  mkdir -p <span class="s2">&#34;</span><span class="nv">$dst</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  sudo mount -o loop <span class="s2">&#34;</span><span class="nv">$part</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$dst</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./mount_loop.sh 
</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> Passwort für pascal: 
</span></span><span class="line"><span class="cl">/dev/loop11
</span></span><span class="line"><span class="cl">mnt/loop11p1
</span></span><span class="line"><span class="cl">mnt/loop11p2
</span></span><span class="line"><span class="cl">mount: /home/pascal/Pentesting/picoCTF_2022/Forensics/Operation Orchid/mnt/loop11p2: unknown filesystem <span class="nb">type</span> <span class="s1">&#39;swap&#39;</span>.
</span></span><span class="line"><span class="cl">mnt/loop11p3
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s look for the flag &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find . <span class="p">|</span> grep flag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./loop11p3/root/flag.txt.enc
</span></span><span class="line"><span class="cl">./loop11p3/root/flag.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>&rsquo;loop11p3&rsquo; is the root partition.</p>
<p>I found the file /root/flag.txt.enc</p>
<p>Let&rsquo;s see what this is&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag.txt.enc                                                                                                  
</span></span><span class="line"><span class="cl">flag.txt.enc: openssl enc<span class="err">&#39;</span>d data with salted password
</span></span></code></pre></td></tr></table>
</div>
</div><p>That&rsquo;s a salted openssl file</p>
<p>I found an ash shell history file!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat root/.ash_history  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">touch flag.txt
</span></span><span class="line"><span class="cl">nano flag.txt 
</span></span><span class="line"><span class="cl">apk get nano
</span></span><span class="line"><span class="cl">apk --help
</span></span><span class="line"><span class="cl">apk add nano
</span></span><span class="line"><span class="cl">nano flag.txt 
</span></span><span class="line"><span class="cl">openssl
</span></span><span class="line"><span class="cl">openssl aes256 -salt -in flag.txt -out flag.txt.enc -k unbreakablepassword1234567
</span></span><span class="line"><span class="cl">shred -u flag.txt
</span></span><span class="line"><span class="cl">ls -al
</span></span><span class="line"><span class="cl">halt
</span></span></code></pre></td></tr></table>
</div>
</div><p>The command used to encrypt the flag file was</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl aes256 -salt -in flag.txt -out flag.txt.enc -k unbreakablepassword1234567
</span></span></code></pre></td></tr></table>
</div>
</div><p>And we can see that the key is &lsquo;unbreakablepassword1234567&rsquo;</p>
<p>Let&rsquo;s decrypt it using openssl again!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl aes256 -d -in flag.txt.enc -out flag.txt -k unbreakablepassword1234567
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*** WARNING : deprecated key derivation used.
</span></span><span class="line"><span class="cl">Using -iter or -pbkdf2 would be better.
</span></span><span class="line"><span class="cl">bad decrypt
</span></span><span class="line"><span class="cl">140528353342848:error:06065064:digital envelope routines:EVP_DecryptFinal_ex:bad decrypt:../crypto/evp/evp_enc.c:610:
</span></span></code></pre></td></tr></table>
</div>
</div><p>We get a few warnings but the decryption worked!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat flag.txt                                                                                                         
</span></span><span class="line"><span class="cl">picoCTF<span class="o">{</span>h4un71ng_p457_cc87abb6<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the flag is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{h4un71ng_p457_cc87abb6}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Forensics - Operation Oni</title><link>https://blog.ppeinecke.de/posts/picoctf-forensics-operation-oni/</link><pubDate>Wed, 06 Apr 2022 14:47:15 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-forensics-operation-oni/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---operation-oni---writeup">Forensics - Operation Oni - writeup</h1>
<h2 id="description">description</h2>
<p>Download <!-- raw HTML omitted -->this<!-- raw HTML omitted -->
disk featuredImage, find the key and
log into the remote machine.</p>
<p>Note: if you are using the webshell,
download and extract the disk featuredImage
into /tmp not your home directory.</p>
<h2 id="writeup">writeup</h2>
<p>So I went ahead, fired up the remote machine
and downloaded the disk featuredImage.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget https://artifacts.picoctf.net/c/372/disk.img.gz
</span></span></code></pre></td></tr></table>
</div>
</div><p>It is gzip compressed so I first had to decompress it</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gunzip disk.img.gz
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now I have a &lsquo;disk.img&rsquo; file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file disk.img 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">disk.img: DOS/MBR boot sector<span class="p">;</span> partition <span class="m">1</span> : <span class="nv">ID</span><span class="o">=</span>0x83, active, start-CHS <span class="o">(</span>0x0,32,33<span class="o">)</span>, end-CHS <span class="o">(</span>0xc,223,19<span class="o">)</span>, startsector 2048, <span class="m">204800</span> sectors<span class="p">;</span> partition <span class="m">2</span> : <span class="nv">ID</span><span class="o">=</span>0x83, start-CHS <span class="o">(</span>0xc,223,20<span class="o">)</span>, end-CHS <span class="o">(</span>0x1d,81,52<span class="o">)</span>, startsector 206848, <span class="m">264192</span> sectors
</span></span></code></pre></td></tr></table>
</div>
</div><p>That is a dos (MBR) partiton table.</p>
<p>Let&rsquo;s look at the partitions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fdisk -l disk.img 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Disk disk.img: <span class="m">230</span> MiB, <span class="m">241172480</span> bytes, <span class="m">471040</span> sectors
</span></span><span class="line"><span class="cl">Units: sectors of <span class="m">1</span> * <span class="nv">512</span> <span class="o">=</span> <span class="m">512</span> bytes
</span></span><span class="line"><span class="cl">Sector size <span class="o">(</span>logical/physical<span class="o">)</span>: <span class="m">512</span> bytes / <span class="m">512</span> bytes
</span></span><span class="line"><span class="cl">I/O size <span class="o">(</span>minimum/optimal<span class="o">)</span>: <span class="m">512</span> bytes / <span class="m">512</span> bytes
</span></span><span class="line"><span class="cl">Disklabel type: dos
</span></span><span class="line"><span class="cl">Disk identifier: 0x0b0051d0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Device     Boot  Start    End Sectors  Size Id Type
</span></span><span class="line"><span class="cl">disk.img1  *      <span class="m">2048</span> <span class="m">206847</span>  <span class="m">204800</span>  100M <span class="m">83</span> Linux
</span></span><span class="line"><span class="cl">disk.img2       <span class="m">206848</span> <span class="m">471039</span>  <span class="m">264192</span>  129M <span class="m">83</span> Linux
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s try to mount the partitions using my bash script again:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nv">img</span><span class="o">=</span><span class="s2">&#34;disk.flag.img&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">dev</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span>sudo losetup --show -f -P <span class="s2">&#34;</span><span class="nv">$img</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$dev</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> part in <span class="s2">&#34;</span><span class="nv">$dev</span><span class="s2">&#34;</span>?*<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$part</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dev</span><span class="si">}</span><span class="s2">p*&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nv">part</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">dev</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">  <span class="nv">dst</span><span class="o">=</span><span class="s2">&#34;mnt/</span><span class="k">$(</span>basename <span class="s2">&#34;</span><span class="nv">$part</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$dst</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  mkdir -p <span class="s2">&#34;</span><span class="nv">$dst</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  sudo mount -o loop <span class="s2">&#34;</span><span class="nv">$part</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$dst</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>I was able to mount these two partitions:</p>
<p>disk/loop14p1
disk/loop14p2</p>
<p>The first partition is a boot partiton and does not
contain any interesting data.</p>
<p>The second partition is a root partition.</p>
<p>In the directory of the root user I found a public and
a private ssh key.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls loop14p2/root/.ssh 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">id_ed25519  id_ed25519.pub
</span></span></code></pre></td></tr></table>
</div>
</div><p>I can use these credentials to login to the ssh server
on the remote machine using the following command
that was mentioned in the description of this challenge:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ssh -i key_file -p 49764 ctf-player@saturn.picoctf.net
</span></span></code></pre></td></tr></table>
</div>
</div><p>So let&rsquo;s first copy the ssh prvivate key:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp disk/loop14p2/root/.ssh/id_ed25519 ./
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now let&rsquo;s try to connect to the aforementioned ssh server&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh -i id_ed25519 -p <span class="m">49764</span> ctf-player@saturn.picoctf.net
</span></span></code></pre></td></tr></table>
</div>
</div><p>That does not work because the permission of the ssh key are wrong.</p>
<p>I first have to change the owner to my own username and the permission
of ssh keys are usually 400.</p>
<p>So let&rsquo;s fix that.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo chown pascal:pascal id_ed25519
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo chmod <span class="m">400</span> id_ed25519
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now the connection works!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh -i id_ed25519 -p <span class="m">49764</span> ctf-player@saturn.picoctf.net
</span></span><span class="line"><span class="cl">Welcome to Ubuntu 20.04.3 LTS <span class="o">(</span>GNU/Linux 5.13.0-1017-aws x86_64<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Documentation:  https://help.ubuntu.com
</span></span><span class="line"><span class="cl"> * Management:     https://landscape.canonical.com
</span></span><span class="line"><span class="cl"> * Support:        https://ubuntu.com/advantage
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This system has been minimized by removing packages and content that are
</span></span><span class="line"><span class="cl">not required on a system that users <span class="k">do</span> not log into.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">To restore this content, you can run the <span class="s1">&#39;unminimize&#39;</span> command.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The programs included with the Ubuntu system are free software<span class="p">;</span>
</span></span><span class="line"><span class="cl">the exact distribution terms <span class="k">for</span> each program are described in the
</span></span><span class="line"><span class="cl">individual files in /usr/share/doc/*/copyright.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span></span><span class="line"><span class="cl">applicable law.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ctf-player@challenge:~$
</span></span></code></pre></td></tr></table>
</div>
</div><p>In the home directory of that user a a file flag.txt</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ctf-player@challenge:~$ <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/home/ctf-player
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ctf-player@challenge:~$ ls
</span></span><span class="line"><span class="cl">flag.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s cat it out!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ctf-player@challenge:~$ cat flag.txt 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">picoCTF<span class="o">{</span>k3y_5l3u7h_339601ed<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is our flag!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{k3y_5l3u7h_339601ed}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Forensics - Lookey Here</title><link>https://blog.ppeinecke.de/posts/picoctf-forensics-lookey-here/</link><pubDate>Wed, 06 Apr 2022 14:25:47 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-forensics-lookey-here/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---lookey-here---writeup">Forensics - Lookey here - writeup</h1>
<h2 id="description">description</h2>
<p>Attackers have hidden information in a very large mass of data in the past, maybe they are still doing it. Download the data <!-- raw HTML omitted -->here<!-- raw HTML omitted -->.</p>
<h2 id="writeup">writeup</h2>
<p>looking at the content of the txt file I can see
a lot of random text&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">head anthem.flag.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ANTHEM
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      by Ayn Rand
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        CONTENTS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         PART ONE
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         PART TWO
</span></span></code></pre></td></tr></table>
</div>
</div><p>By simply grepping out picoCTF I could find the flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat anthem.flag.txt<span class="p">|</span> grep picoCTF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">we think that the men of picoCTF<span class="o">{</span>gr3p_15_@w3s0m3_c91a291d<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the flag is</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{gr3p_15_@w3s0m3_c91a291d}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Forensics - File types</title><link>https://blog.ppeinecke.de/posts/picoctf-forensics-file-types/</link><pubDate>Wed, 06 Apr 2022 14:21:10 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-forensics-file-types/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---file-types---writeup">Forensics - File types - writeup</h1>
<h2 id="description">description</h2>
<p>This file was found among some files marked confidential
but my pdf reader cannot read it, maybe yours can.
You can download the file from <!-- raw HTML omitted -->here<!-- raw HTML omitted -->.</p>
<h2 id="writeup">writeup</h2>
<p>Let&rsquo;s download the file!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget https://artifacts.picoctf.net/c/329/Flag.pdf
</span></span></code></pre></td></tr></table>
</div>
</div><p>lets see what file we got here&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file Flag.pdf
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Flag.pdf: shell archive text
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looks like this is a shell archive file (.shar)</p>
<p>lets rename the file to a proper file extension first.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp Flag.pdf Flag.shar 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now I will try to simply execute it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sh ./Flag.shar 
</span></span></code></pre></td></tr></table>
</div>
</div><p>I get the following output:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">x - created lock directory _sh00046.
</span></span><span class="line"><span class="cl">x - extracting flag <span class="o">(</span>text<span class="o">)</span>
</span></span><span class="line"><span class="cl">./Flag.shar: 119: uudecode: not found
</span></span><span class="line"><span class="cl">restore of flag failed
</span></span><span class="line"><span class="cl">flag: MD5 check failed
</span></span><span class="line"><span class="cl">x - removed lock directory _sh00046.
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looks like I am missing uudecode</p>
<p>After a quick google search I found out that I need to install sharutils</p>
<p>So lets install it quick</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install sharutils
</span></span></code></pre></td></tr></table>
</div>
</div><p>After running the file Flag.shar again I get a new file called &lsquo;flag&rsquo;
with a lot of nonsense:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">!&lt;arch&gt;
</span></span><span class="line"><span class="cl">flag/           0           0     0     644     1024      `
</span></span><span class="line"><span class="cl">4�4i�ѵ��F�DѣCC �M4hɦ�Sd��Y�6��&#34;��������ש����5�h���{����������N��▒▒4���Ѡ2
</span></span><span class="line"><span class="cl">0!�a�                    �0�6�▒2F����&amp;���2&amp;�� �
</span></span><span class="line"><span class="cl">��y ڀ��
</span></span><span class="line"><span class="cl">�^��r�e�▒�L�ʿ��H&#34;72�\U#f�*������qCa}�s6��
</span></span><span class="line"><span class="cl">`�K�I�{Wx�#W5�+f�и-�#i���G�£vV�#��%
</span></span><span class="line"><span class="cl">�G&gt;.���Z8ѬL×��9�%)�`��1�CxyR��=��9nf�q�!��h����f우��T��6��      ��݆������F�&amp;�ؘbB��uu�!��&#34;`e9P�Q����K3F�Q�k�C���)8
</span></span><span class="line"><span class="cl">                  ���
</span></span><span class="line"><span class="cl">!��F5&#39;(5��3�L�@�     ��H���,�hQ&amp;▒�
</span></span><span class="line"><span class="cl"> k��.Th2�D����`�&gt;;&lt;���▒��&#34;�(HH�]���q
</span></span><span class="line"><span class="cl">                                    TRAILER!!!
</span></span></code></pre></td></tr></table>
</div>
</div><p>Cheking with the file command what that file actually is we can see that it is an &lsquo;ar archive&rsquo;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag     
</span></span><span class="line"><span class="cl">flag: current ar archive
</span></span></code></pre></td></tr></table>
</div>
</div><p>So lets rename the file to flag.ar</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp flag flag.ar
</span></span></code></pre></td></tr></table>
</div>
</div><p>check the file type again&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag.ar
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag.ar: cpio archive
</span></span></code></pre></td></tr></table>
</div>
</div><p>rename the file to .cpio</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp flag.ar flag.cpio
</span></span></code></pre></td></tr></table>
</div>
</div><p>lets extract that cpio archive</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cpio -idv &lt; flag.cpio
</span></span></code></pre></td></tr></table>
</div>
</div><p>We successfully extracted a new file called &lsquo;flag&rsquo;</p>
<p>lets see what that is now:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag: bzip2 compressed data, block <span class="nv">size</span> <span class="o">=</span> 900k
</span></span></code></pre></td></tr></table>
</div>
</div><p>Lets extract that with bunzip2 real quick</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bunzip2 flag
</span></span></code></pre></td></tr></table>
</div>
</div><p>We got a file &lsquo;flag.out&rsquo;</p>
<p>lets see what it is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag.out 
</span></span><span class="line"><span class="cl">flag.out: gzip compressed data, was <span class="s2">&#34;flag&#34;</span>, last modified: Tue Mar <span class="m">15</span> 06:50:51 2022, from Unix, original size modulo 2^32 <span class="m">327</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Lets rename it to a proper file extension again</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp flag.out flag.gz
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now I will try to extract that gzip file</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gunzip flag.gz
</span></span></code></pre></td></tr></table>
</div>
</div><p>We got a new file flag</p>
<p>lets see what it is this time:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag   
</span></span><span class="line"><span class="cl">flag: lzip compressed data, version: <span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>lets extract it using lunzip</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lunzip flag
</span></span></code></pre></td></tr></table>
</div>
</div><p>we get a new file flag.out</p>
<p>lets see what we have now&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag.out 
</span></span><span class="line"><span class="cl">flag.out: LZ4 compressed data <span class="o">(</span>v1.4+<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>lets rename it to a proper file extension first&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp flag.out flag.lz4
</span></span></code></pre></td></tr></table>
</div>
</div><p>now i will try to extract it&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lz4 -d flag.lz4 
</span></span><span class="line"><span class="cl">Decoding file flag 
</span></span><span class="line"><span class="cl">flag.lz4             : decoded <span class="m">264</span> bytes
</span></span></code></pre></td></tr></table>
</div>
</div><p>lets check again&hellip;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag    
</span></span><span class="line"><span class="cl">flag: LZMA compressed data, non-streamed, size <span class="m">253</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>lets rename it to a proper file extension first &hellip;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp flag flag.xz
</span></span></code></pre></td></tr></table>
</div>
</div><p>lets decompress it again&hellip;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lzma -d flag.xz
</span></span></code></pre></td></tr></table>
</div>
</div><p>lets check again&hellip;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag      
</span></span><span class="line"><span class="cl">flag: lzop compressed data - version 1.040, LZO1X-1, os: Unix
</span></span></code></pre></td></tr></table>
</div>
</div><p>lets extract it &hellip;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lzop -x flag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">lzop: flag: can<span class="err">&#39;</span>t decompress to same file
</span></span><span class="line"><span class="cl">skipping flag <span class="o">[</span>flag<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looks like I need to specify a different destination file</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lzop flag -d -oflag.new
</span></span></code></pre></td></tr></table>
</div>
</div><p>Checking with file again it is still an lzop archive</p>
<p>So I will try to extract it again&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lzop flag.new -d -oflag.new.new
</span></span></code></pre></td></tr></table>
</div>
</div><p>It is still an lzop file</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lzop flag.new.new -d -oflag.new.new.new
</span></span></code></pre></td></tr></table>
</div>
</div><p>If I now check the filetype</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag.new.new.new 
</span></span><span class="line"><span class="cl">flag.new.new.new: lzip compressed data, version: <span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It is an lzip archive this time&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lzip -d flag.new.new.new 
</span></span></code></pre></td></tr></table>
</div>
</div><p>By checking the filetype I get</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag.new.new.new.out
</span></span><span class="line"><span class="cl">flag.new.new.new.out: XZ compressed data, checksum CRC64
</span></span></code></pre></td></tr></table>
</div>
</div><p>let&rsquo;s rename it to a proper extension</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp flag.new.new.new.out flag.new.new.new.xz
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now extract it one more time&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">unxz flag.new.new.new.xz
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file flag.new.new.new                                                               
</span></span><span class="line"><span class="cl">flag.new.new.new: ASCII text
</span></span></code></pre></td></tr></table>
</div>
</div><p>cat&rsquo;ing out this file we finally get some text &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat flag.new.new.new
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">7069636f4354467b66316c656e406d335f6d406e3170756c407431306e5f
</span></span><span class="line"><span class="cl">6630725f3062326375723137795f32373866316131387d0a
</span></span></code></pre></td></tr></table>
</div>
</div><p>The first line is hex and translates to</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{f1len@m3_m@n1pul@t10n_
</span></span></code></pre></td></tr></table>
</div>
</div><p>The second line is also hex and translates to</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">f0r_0b2cur17y_278f1a18}
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the flag is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{f1len@m3_m@n1pul@t10n_f0r_0b2cur17y_278f1a18}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Forensics - Enhance!</title><link>https://blog.ppeinecke.de/posts/picoctf-forensics-enhance/</link><pubDate>Wed, 06 Apr 2022 14:18:09 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-forensics-enhance/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="forensics---enhance---writeup">Forensics - Enhance! - writeup</h1>
<h2 id="description">description</h2>
<p>Download this featuredImage file and find the flag.</p>
<p><!-- raw HTML omitted --> Download featuredImage file <!-- raw HTML omitted --></p>
<h2 id="writeup">writeup</h2>
<p>Ok so I downloaded the featuredImage file drawing.flag.svg</p>
<p>Checking with the file command what that actually is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file drawing.flag.svg 
</span></span><span class="line"><span class="cl">drawing.flag.svg: SVG Scalable Vector Graphics featuredImage
</span></span></code></pre></td></tr></table>
</div>
</div><p>looks like it is actually a svg file.</p>
<p>Lets try to open it using feh e.g.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">feh drawing.flag.svg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">feh WARNING: drawing.flag.svg - Does not look like an featuredImage <span class="o">(</span>magic bytes missing<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>feh tells me that the magic bytes are missing.</p>
<p>So the first thing to try here is simply adding the magic bytes header of svg
to the top of the file using a hex editor.</p>
<p>It turns out that the magic bytes are in fact present.</p>
<p>I can open the file using eog without any problem.</p>
<p>Looking at the hex code we can see that the featuredImage was made using inkscape:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">inkscape:version=&#34;1.1.2 (b8e25be833, 2022-02-05)&#34;
</span></span><span class="line"><span class="cl">   xmlns:inkscape=&#34;http://www.inkscape.org/namespaces/inkscape&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>After opening the file in firefox and looking at the source code I found the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;text</span>
</span></span><span class="line"><span class="cl">       <span class="na">xml:space=</span><span class="s">&#34;preserve&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">style=</span><span class="s">&#34;font-style:normal;font-weight:normal;font-size:0.00352781px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.26458332;&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">x=</span><span class="s">&#34;107.43014&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">y=</span><span class="s">&#34;132.08501&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">id=</span><span class="s">&#34;text3723&#34;</span><span class="nt">&gt;&lt;tspan</span>
</span></span><span class="line"><span class="cl">         <span class="na">sodipodi:role=</span><span class="s">&#34;line&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">x=</span><span class="s">&#34;107.43014&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">y=</span><span class="s">&#34;132.08501&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">style=</span><span class="s">&#34;font-size:0.00352781px;line-height:1.25;fill:#ffffff;stroke-width:0.26458332;&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">id=</span><span class="s">&#34;tspan3748&#34;</span><span class="nt">&gt;</span>p <span class="nt">&lt;/tspan&gt;&lt;tspan</span>
</span></span><span class="line"><span class="cl">         <span class="na">sodipodi:role=</span><span class="s">&#34;line&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">x=</span><span class="s">&#34;107.43014&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">y=</span><span class="s">&#34;132.08942&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">style=</span><span class="s">&#34;font-size:0.00352781px;line-height:1.25;fill:#ffffff;stroke-width:0.26458332;&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">id=</span><span class="s">&#34;tspan3754&#34;</span><span class="nt">&gt;</span>i <span class="nt">&lt;/tspan&gt;&lt;tspan</span>
</span></span><span class="line"><span class="cl">         <span class="na">sodipodi:role=</span><span class="s">&#34;line&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">x=</span><span class="s">&#34;107.43014&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">y=</span><span class="s">&#34;132.09383&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">style=</span><span class="s">&#34;font-size:0.00352781px;line-height:1.25;fill:#ffffff;stroke-width:0.26458332;&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">id=</span><span class="s">&#34;tspan3756&#34;</span><span class="nt">&gt;</span>c <span class="nt">&lt;/tspan&gt;&lt;tspan</span>
</span></span><span class="line"><span class="cl">         <span class="na">sodipodi:role=</span><span class="s">&#34;line&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">x=</span><span class="s">&#34;107.43014&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">y=</span><span class="s">&#34;132.09824&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">style=</span><span class="s">&#34;font-size:0.00352781px;line-height:1.25;fill:#ffffff;stroke-width:0.26458332;&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">id=</span><span class="s">&#34;tspan3758&#34;</span><span class="nt">&gt;</span>o <span class="nt">&lt;/tspan&gt;&lt;tspan</span>
</span></span><span class="line"><span class="cl">         <span class="na">sodipodi:role=</span><span class="s">&#34;line&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">x=</span><span class="s">&#34;107.43014&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">y=</span><span class="s">&#34;132.10265&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">style=</span><span class="s">&#34;font-size:0.00352781px;line-height:1.25;fill:#ffffff;stroke-width:0.26458332;&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">id=</span><span class="s">&#34;tspan3760&#34;</span><span class="nt">&gt;</span>C <span class="nt">&lt;/tspan&gt;&lt;tspan</span>
</span></span><span class="line"><span class="cl">         <span class="na">sodipodi:role=</span><span class="s">&#34;line&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">x=</span><span class="s">&#34;107.43014&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">y=</span><span class="s">&#34;132.10706&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">style=</span><span class="s">&#34;font-size:0.00352781px;line-height:1.25;fill:#ffffff;stroke-width:0.26458332;&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">id=</span><span class="s">&#34;tspan3762&#34;</span><span class="nt">&gt;</span>T <span class="nt">&lt;/tspan&gt;&lt;tspan</span>
</span></span><span class="line"><span class="cl">         <span class="na">sodipodi:role=</span><span class="s">&#34;line&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">x=</span><span class="s">&#34;107.43014&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">y=</span><span class="s">&#34;132.11147&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">style=</span><span class="s">&#34;font-size:0.00352781px;line-height:1.25;fill:#ffffff;stroke-width:0.26458332;&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">id=</span><span class="s">&#34;tspan3764&#34;</span><span class="nt">&gt;</span>F { 3 n h 4 n <span class="nt">&lt;/tspan&gt;&lt;tspan</span>
</span></span><span class="line"><span class="cl">         <span class="na">sodipodi:role=</span><span class="s">&#34;line&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">x=</span><span class="s">&#34;107.43014&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">y=</span><span class="s">&#34;132.11588&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">style=</span><span class="s">&#34;font-size:0.00352781px;line-height:1.25;fill:#ffffff;stroke-width:0.26458332;&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">id=</span><span class="s">&#34;tspan3752&#34;</span><span class="nt">&gt;</span>c 3 d _ 6 a e 4 2 b b a }<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Flag: picoCTF{3nh4nc3d_6ae42bba}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item></channel></rss>