<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>web-exploitation - Tag - Pascal's Blog</title><link>https://blog.ppeinecke.de/tags/web-exploitation/</link><description>web-exploitation - Tag - Pascal's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Wed, 06 Apr 2022 16:12:40 +0200</lastBuildDate><atom:link href="https://blog.ppeinecke.de/tags/web-exploitation/" rel="self" type="application/rss+xml"/><item><title>picoCTF - Web Exploitation - SQLiLite</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sqlilite/</link><pubDate>Wed, 06 Apr 2022 16:12:40 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sqlilite/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---sqlilite---writeup">Web Exploitation - SQLiLite - writeup</h1>
<h2 id="description">description</h2>
<p>Can you login to this website?</p>
<p>Try to login <!-- raw HTML omitted -->here<!-- raw HTML omitted -->.</p>
<h2 id="writeup">writeup</h2>
<p>Once i visit the website <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:60431/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:60431/</a><!-- raw HTML omitted -->
in firefox I can see a login form with a username and a password field.</p>
<p>My first attempt was to use the username &lsquo;admin&rsquo;
and try a basic sql injection.</p>
<p>So I input in the username field this:</p>
<pre><code>admin'--
</code></pre>
<p>the single quote is here to end the input of the text box.</p>
<p>The double dash (&ndash;) is here to comment out the rest of the sql query
so we can skip the password check.</p>
<p>Once I try to login using this method I get redirected to a page with the following content:</p>
<pre><code>username: admin'--
password: 
SQL query: SELECT * FROM users WHERE name='admin'--' AND password=''

Logged in! But can you see the flag, it is in plainsight.
</code></pre>
<p>But looking at the html code reveals the flag pretty quickly:</p>
<pre><code class="language-html">&lt;p hidden=&quot;&quot;&gt;Your flag is: picoCTF{L00k5_l1k3_y0u_solv3d_it_8dac17f1}&lt;/p&gt;
</code></pre>
<p>So the flag is</p>
<pre><code>picoCTF{L00k5_l1k3_y0u_solv3d_it_8dac17f1}
</code></pre>
]]></description></item><item><title>picoCTF - Web Exploitation - SQL Direct</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sql-direct/</link><pubDate>Wed, 06 Apr 2022 16:10:25 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-sql-direct/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---sql-direct---writeup">Web Exploitation - SQL Direct - writeup</h1>
<h2 id="description">description</h2>
<p>Connect to this PostgreSQL server and find the flag!</p>
<p>psql -h saturn.picoctf.net -p 49248 -U postgres pico</p>
<p>Password is postgres</p>
<h2 id="writeup">writeup</h2>
<p>Ok let&rsquo;s first connect to the database server:</p>
<pre><code class="language-bash">psql -h saturn.picoctf.net -p 49248 -U postgres pico 
</code></pre>
<p>the password is &lsquo;postgres&rsquo;</p>
<p>Let&rsquo;s list all databases first</p>
<pre><code class="language-bash">pico=# \l
                                 List of databases
   Name    |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   
-----------+----------+----------+------------+------------+-----------------------
 pico      | postgres | UTF8     | en_US.utf8 | en_US.utf8 | 
 postgres  | postgres | UTF8     | en_US.utf8 | en_US.utf8 | 
 template0 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
(4 rows)
</code></pre>
<p>Connect to the &lsquo;pico&rsquo; database</p>
<pre><code class="language-bash">pico=# \c pico
</code></pre>
<p>List all tables</p>
<pre><code class="language-bash">pico=# \dt
         List of relations
 Schema | Name  | Type  |  Owner   
--------+-------+-------+----------
 public | flags | table | postgres
(1 row)
</code></pre>
<p>the table &lsquo;flags&rsquo; sounds interesting &hellip;</p>
<p>lets look at the contents:</p>
<pre><code class="language-bash">pico=# select * from flags;
 id | firstname | lastname  |                address                 
----+-----------+-----------+----------------------------------------
  1 | Luke      | Skywalker | picoCTF{L3arN_S0m3_5qL_t0d4Y_a26695df}
  2 | Leia      | Organa    | Alderaan
  3 | Han       | Solo      | Corellia
(3 rows)
</code></pre>
<p>There is our flag.</p>
<pre><code>picoCTF{L3arN_S0m3_5qL_t0d4Y_a26695df}
</code></pre>
]]></description></item><item><title>picoCTF - Web Exploitation - Search source</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-search-source/</link><pubDate>Wed, 06 Apr 2022 16:08:45 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-search-source/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---search-source---writeup">Web Exploitation - Search Source - writeup</h1>
<h2 id="description">description</h2>
<p>The developer of this website mistakenly left an
important artifact in the website source, can you find it?
The website is <!-- raw HTML omitted -->here<!-- raw HTML omitted --></p>
<h2 id="writeup">writeup</h2>
<p>I was not able to find anything interesting on the website
by just looking at the source code in the browser.</p>
<p>So let&rsquo;s clone the website first using HTTrack so we can
take a look at the full source.</p>
<pre><code class="language-bash">httrack http://saturn.picoctf.net:64200/
</code></pre>
<p>Let&rsquo;s use grep recursively to find the flag inside all
of the files of the webroot.</p>
<pre><code class="language-bash">grep -nr 'picoCTF*' .

./css/style.css:328:/** banner_main picoCTF{1nsp3ti0n_0f_w3bpag3s_3003ba70} **/
</code></pre>
<p>We found the flag inside the file css/style.css on line 328.</p>
<p>Flag:</p>
<pre><code>picoCTF{1nsp3ti0n_0f_w3bpag3s_3003ba70}
</code></pre>
]]></description></item><item><title>picoCTF - Web Exploitation - Power Cookie</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-power-cookie/</link><pubDate>Wed, 06 Apr 2022 16:04:26 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-power-cookie/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---power-cookie---writeup">Web Exploitation - Power Cookie - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag? Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted -->
and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Looking at the check.php function I can see that it requests a cookie &lsquo;isAdmin&rsquo;.</p>
<p>That cookie is not present at the first visit of the page.</p>
<p>So lets refresh the webpage.</p>
<p>Now the cookie is present.</p>
<p>The value of this particuluar cookie is &lsquo;0&rsquo; currently.</p>
<p>So lets change it to &lsquo;1&rsquo; and refresh the page once more.</p>
<p>I am immediately presented with the flag:</p>
<pre><code>picoCTF{gr4d3_A_c00k13_1d871e17}
</code></pre>
]]></description></item><item><title>picoCTF - Web Exploitation - Local Authority</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-local-authority/</link><pubDate>Wed, 06 Apr 2022 15:58:43 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-local-authority/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---local-authority---writeup">Web Exploitation - Local Authority - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag?
Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Once I open the link <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:51419/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:51419/</a><!-- raw HTML omitted --> in firefox I get to a page &ldquo;Secure Customer Portal&rdquo;.</p>
<p>I can see a login form with username and password.</p>
<p>On the website I see a hint:</p>
<blockquote>
<p>Only letters and numbers allowed for username and password.</p>
</blockquote>
<p>I tried to do a simple post request to the login.php</p>
<pre><code>username=admin&amp;password=test&amp;login=true
</code></pre>
<p>Using that payload I get the following html response:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;
    &lt;title&gt;Login Page&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;script src=&quot;secure.js&quot;&gt;&lt;/script&gt;
    
    &lt;p id='msg'&gt;&lt;/p&gt;
    
    &lt;form hidden action=&quot;admin.php&quot; method=&quot;post&quot; id=&quot;hiddenAdminForm&quot;&gt;
      &lt;input type=&quot;text&quot; name=&quot;hash&quot; required id=&quot;adminFormHash&quot;&gt;
    &lt;/form&gt;
    
    &lt;script type=&quot;text/javascript&quot;&gt;
      function filter(string) {
        filterPassed = true;
        for (let i =0; i &lt; string.length; i++){
          cc = string.charCodeAt(i);
          
          if ( (cc &gt;= 48 &amp;&amp; cc &lt;= 57) ||
               (cc &gt;= 65 &amp;&amp; cc &lt;= 90) ||
               (cc &gt;= 97 &amp;&amp; cc &lt;= 122) )
          {
            filterPassed = true;     
          }
          else
          {
            return false;
          }
        }
        
        return true;
      }
    
      window.username = &quot;admin&quot;;
      window.password = &quot;test&quot;;
      
      usernameFilterPassed = filter(window.username);
      passwordFilterPassed = filter(window.password);
      
      if ( usernameFilterPassed &amp;&amp; passwordFilterPassed ) {
      
        loggedIn = checkPassword(window.username, window.password);
        
        if(loggedIn)
        {
          document.getElementById('msg').innerHTML = &quot;Log In Successful&quot;;
          document.getElementById('adminFormHash').value = &quot;2196812e91c29df34f5e217cfd639881&quot;;
          document.getElementById('hiddenAdminForm').submit();
        }
        else
        {
          document.getElementById('msg').innerHTML = &quot;Log In Failed&quot;;
        }
      }
      else {
        document.getElementById('msg').innerHTML = &quot;Illegal character in username or password.&quot;
      }
    &lt;/script&gt;
    
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Looking at that html code there are two lines that stick out:</p>
<pre><code class="language-html">window.username = &quot;admin&quot;;
window.password = &quot;test&quot;;
</code></pre>
<p>Lets try the username &lsquo;admin&rsquo; and the password &rsquo;test&rsquo;&hellip;</p>
<p>No luck</p>
<p>The file &lsquo;secure.js&rsquo; seems to be more interesting &hellip;</p>
<p>Let&rsquo;s take a look at it:</p>
<pre><code class="language-js">function checkPassword(username, password)
{
  if( username === 'admin' &amp;&amp; password === 'strongPassword098765' )
  {
    return true;
  }
  else
  {
    return false;
  }
}
</code></pre>
<p>So the username seems to be &lsquo;admin&rsquo; and the password &lsquo;strongPassword098765&rsquo;</p>
<p>Using that combination the login was successful and I can see the flag:</p>
<pre><code>picoCTF{j5_15_7r4n5p4r3n7_d6a44d91} 
</code></pre>
]]></description></item><item><title>picoCTF - Web Exploitation - Inspect HTML</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-inspect-html/</link><pubDate>Wed, 06 Apr 2022 15:51:22 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-inspect-html/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---includes---writeup">Web Exploitation - Includes - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag?
Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Once I opened the website <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:60935/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:60935/</a><!-- raw HTML omitted --> in firefox and looking at the source code I could immediately find the flag inside a comment in the html source code:</p>
<pre><code class="language-html">&lt;!--picoCTF{1n5p3t0r_0f_h7ml_ab1df88d}--&gt;
</code></pre>
<p>So the flag is:</p>
<pre><code>picoCTF{1n5p3t0r_0f_h7ml_ab1df88d}
</code></pre>
]]></description></item><item><title>picoCTF - Web Exploitation - Includes</title><link>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-includes/</link><pubDate>Wed, 06 Apr 2022 15:42:26 +0200</pubDate><guid>https://blog.ppeinecke.de/posts/picoctf-web-exploitation-includes/</guid><description><![CDATA[<div class="featured-image">
                <img src="/featuredImages/picoCTF_logo.png" referrerpolicy="no-referrer">
            </div><h1 id="web-exploitation---includes---writeup">Web Exploitation - Includes - writeup</h1>
<h2 id="description">description</h2>
<p>Can you get the flag? Go to this <!-- raw HTML omitted -->website<!-- raw HTML omitted --> and see what you can discover.</p>
<h2 id="writeup">writeup</h2>
<p>Ok so I went ahead and visited the url <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:52811/" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:52811/</a><!-- raw HTML omitted --> in firefox.</p>
<p>I am presente with a webpage with a bunch of text and a button that says &ldquo;Say hello&rdquo;.</p>
<p>Once I press that button I get a javascript alert() popup that says &ldquo;This code is in a separate file!&rdquo;</p>
<p>If I look at the source code of that button I see this:</p>
<pre><code class="language-html">onclick=&quot;greetings();&quot;
</code></pre>
<p>So the button is calling a javascript function &lsquo;greetings()&rsquo;</p>
<p>Lets take a look at that function.</p>
<p>Since the html code is including the js code from a seperate file:</p>
<pre><code class="language-html">&lt;script src=&quot;script.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p>We need to take a look at that file</p>
<p>So once I point my browser at the address <!-- raw HTML omitted --><a href="http://saturn.picoctf.net:52811/script.js" target="_blank" rel="noopener noreffer">http://saturn.picoctf.net:52811/script.js</a><!-- raw HTML omitted --> I see the following JavaScript Code:</p>
<pre><code class="language-js">function greetings()
{
  alert(&quot;This code is in a separate file!&quot;);
}

//  f7w_2of2_3d50f001}
</code></pre>
<p>The comment looks like a part of our flag!</p>
<p>There is also a CSS stylesheet &lsquo;style.css&rsquo;</p>
<pre><code class="language-css">body {
  background-color: lightblue;
}

/*  picoCTF{1nclu51v17y_1of2_  */
</code></pre>
<p>Great! Here is our first part of the flag.</p>
<p>Lets put it together:</p>
<p>picoCTF{1nclu51v17y_1of2_f7w_2of2_3d50f001}</p>
<p>So the flag is:</p>
<pre><code>picoCTF{1nclu51v17y_1of2_f7w_2of2_3d50f001}
</code></pre>
]]></description></item></channel></rss>